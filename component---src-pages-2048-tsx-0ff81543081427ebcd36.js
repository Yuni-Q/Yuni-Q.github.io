"use strict";(self.webpackChunkyuni_q_blog=self.webpackChunkyuni_q_blog||[]).push([[746],{7883:function(e,r,t){t.r(r);t(7046);var o=t(5785),a=t(7294),n=t(2788);const c=n.default.table.withConfig({displayName:"sc-2048__Table",componentId:"sc-unuaaf-0"})(["td{border:10px solid #bbada0;width:116px;height:128px;font-size:50px;font-weight:bold;text-align:center;}"]),l=n.default.div.withConfig({displayName:"sc-2048__Wrapper",componentId:"sc-unuaaf-1"})(["user-select:none;.color-2{background-color:#eee4da;color:#776e65;}.color-4{background-color:#eee1c9;color:#776e65;}.color-8{background-color:#f3b27a;color:'white';}.color-16{background-color:#f69664;color:'white';}.color-32{background-color:#f77c5f;color:'white';}.color-64{background-color:#f75f3b;color:'white';}.color-128{background-color:#edd073;color:#776e65;}.color-256{background-color:#edcc62;color:#776e65;}.color-512{background-color:#edc950;color:#776e65;}.color-1024{background-color:#edc53f;color:#776e65;}.color-2048{background-color:#edc22e;color:#776e65;}"]);r.default=()=>{const{0:e,1:r}=(0,a.useState)([]),{0:t,1:n}=(0,a.useState)(0),s=(0,a.useRef)(!1),u=(0,a.useRef)(!1),i=(0,a.useRef)([0,0]),f=(0,a.useRef)({data:[[]],score:[0,0]}),h=(0,a.useCallback)((()=>{const t=[];if(e.forEach(((e,r)=>{e.forEach(((e,o)=>{e||t.push([r,o])}))})),!t.length)return;const a=t[Math.floor(Math.random()*t.length)];r((e=>{const r=(0,o.Z)(e);return r[a[0]][a[1]]=2,r}))}),[e]),d=(0,a.useCallback)((e=>{const r=[[],[],[],[]],t=[[],[],[],[]];let o=0;return e.forEach(((e,r)=>{e.forEach((e=>{if(e){const a=t[r];a[a.length-1]===e?(a[a.length-1]*=-2,o+=Math.abs(a[a.length-1])):t[r].push(e)}}))})),Array(4).fill(0).forEach(((e,o)=>{Array(4).fill(0).forEach(((e,a)=>{r[o][a]=Math.abs(t[o][a])||0}))})),{newData:r,score:o}}),[]),b=(0,a.useCallback)((e=>{const r=[[],[],[],[]],t=[[],[],[],[]];let o=0;return e.forEach(((e,r)=>{e.forEach(((a,n)=>{if(e[3-n]){const a=t[r];a[a.length-1]===e[3-n]?(a[a.length-1]*=-2,o+=Math.abs(a[a.length-1])):t[r].push(e[3-n])}}))})),Array(4).fill(0).forEach(((e,o)=>{Array(4).fill(0).forEach(((e,a)=>{r[o][3-a]=Math.abs(t[o][a])||0}))})),{newData:r,score:o}}),[]),g=(0,a.useCallback)((e=>{const r=[[],[],[],[]],t=[[],[],[],[]];let o=0;return e.forEach((e=>{e.forEach(((e,r)=>{if(e){const a=t[r];a[a.length-1]===e?(a[a.length-1]*=-2,o+=Math.abs(a[a.length-1])):t[r].push(e)}}))})),Array(4).fill(0).forEach(((e,o)=>{Array(4).fill(0).forEach(((e,a)=>{r[a][o]=Math.abs(t[o][a])||0}))})),{newData:r,score:o}}),[]),w=(0,a.useCallback)((e=>{const r=[[],[],[],[]],t=[[],[],[],[]];let o=0;return e.forEach(((r,a)=>{r.forEach(((r,n)=>{if(e[3-a][n]){const r=t[n];r[r.length-1]===e[3-a][n]?(r[r.length-1]*=-2,o+=Math.abs(r[r.length-1])):t[n].push(e[3-a][n])}}))})),Array(4).fill(0).forEach(((e,o)=>{Array(4).fill(0).forEach(((e,a)=>{r[3-a][o]=Math.abs(t[o][a])||0}))})),{newData:r,score:o}}),[]),k=(0,a.useCallback)((t=>{if(console.log(2222),null==e||!e[0])return e;let o={newData:e,score:0};switch(t){case"left":o=d(e);break;case"right":o=b(e);break;case"up":o=g(e);break;case"down":o=w(e);break;default:o={newData:e,score:0}}JSON.stringify(e)!==JSON.stringify(o.newData)&&(f.current.data=e,s.current=!0,n((e=>e+o.score))),r(o.newData)}),[e]),y=(0,a.useCallback)((()=>{if(null==e||!e[0])return!1;let r=0;return JSON.stringify(e)===JSON.stringify(d(e).newData)&&(r+=1),JSON.stringify(e)===JSON.stringify(b(e).newData)&&(r+=1),JSON.stringify(e)===JSON.stringify(g(e).newData)&&(r+=1),JSON.stringify(e)===JSON.stringify(w(e).newData)&&(r+=1),r>=4||void 0}),[e]),E=(0,a.useCallback)((()=>{const e=[new Array(4).fill(0),new Array(4).fill(0),new Array(4).fill(0),new Array(4).fill(0)];r(e),s.current=!0}),[]);return(0,a.useEffect)((()=>{E()}),[]),(0,a.useEffect)((()=>{const e=e=>{"ArrowUp"===e.key&&k("up"),"ArrowDown"===e.key&&k("down"),"ArrowLeft"===e.key&&k("left"),"ArrowRight"===e.key&&k("right")},r=e=>{i.current=[e.clientX,e.clientY]},t=e=>{const r=[e.clientX,e.clientY],t=r[0]-i.current[0],o=r[1]-i.current[1];t<0&&Math.abs(t)>Math.abs(o)&&k("left"),t>0&&Math.abs(t)>Math.abs(o)&&k("right"),o>0&&Math.abs(t)<=Math.abs(o)&&k("down"),o<0&&Math.abs(t)<=Math.abs(o)&&k("up")};return window.addEventListener("keydown",e),window.addEventListener("mousedown",r),window.addEventListener("mouseup",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("mousedown",r),window.removeEventListener("mouseup",t)}}),[e]),(0,a.useEffect)((()=>{(null==e?void 0:e.length)>3&&!e.flat().every((e=>0===e))&&y()&&setTimeout((()=>{alert("패배했습니다...")}),500),!u.current&&e.flat().includes(2048)&&(u.current=!0,setTimeout((()=>{alert("축하합니다. 2048을 만들었습니다.")}),500)),e.length>0&&s.current&&(h(),s.current=!1)}),[e]),(0,a.useEffect)((()=>{t===f.current.score[1]&&(f.current.score=[t,t]),f.current.score.unshift(t),f.current.score.length=2}),[t]),a.createElement(l,null,a.createElement(c,null,a.createElement("tbody",null,e.map(((e,r)=>a.createElement("tr",{key:e+"-"+r},e.map(((e,r)=>a.createElement("td",{className:"color-"+e,key:e+"-"+r},!!e&&e)))))))),a.createElement("div",null,a.createElement("span",null,t),a.createElement("button",{onClick:e=>{e.stopPropagation(),r(f.current.data),n(f.current.score[1])}},"되돌리기")))}}}]);
//# sourceMappingURL=component---src-pages-2048-tsx-0ff81543081427ebcd36.js.map