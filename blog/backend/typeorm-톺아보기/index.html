<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" href="https://www.buymeacoffee.com/assets/img/BMC-btn-logo.svg"/><link rel="preload" as="image" href="/images/profile.png"/><link rel="stylesheet" href="/_next/static/css/bc8bb31cb71603b2.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-57fdca2934e5ae0a.js"/><script src="/_next/static/chunks/6217bb07-738e49d824771fea.js" async=""></script><script src="/_next/static/chunks/5647-b33901b11da845dc.js" async=""></script><script src="/_next/static/chunks/main-app-ec1611f00934714e.js" async=""></script><script src="/_next/static/chunks/app/layout-3ad8bb7cb2292578.js" async=""></script><script src="/_next/static/chunks/9243-972bdccd4ceb11ae.js" async=""></script><script src="/_next/static/chunks/5800-4312aed1aa8a4305.js" async=""></script><script src="/_next/static/chunks/549-2babc012700e23ed.js" async=""></script><script src="/_next/static/chunks/4853-73ca7990eb89674b.js" async=""></script><script src="/_next/static/chunks/app/blog/%5B...slug%5D/page-9b274a2e0073d544.js" async=""></script><script id="ads" async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><title>typeorm 톺아보기</title><meta name="description" content="- Node와 RDB의 ORM 서비스는 sequelize, typeorm, prisma 등 많은 라이브러리들이 있습니다. - 가장 먼저 사용한 ORM 서비스는 sequelize 였지만 typeorm이 typescript 지원이나 시장의 흐름에 따라 조금 더 많이 사용된다고 생각되어 공부하게 되었습니다.    - prisma도 고려해 보았으나 아직은 시기상"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><link rel="icon" type="image/png" href="/favicon2.png"/><link rel="shortcut icon" href="/favicon2.png"/><link rel="apple-touch-icon" href="/favicon2.png"/><link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&amp;display=swap" rel="stylesheet"/><link href="https://fonts.googleapis.com/css2?family=Catamaran:wght@800&amp;display=swap" rel="stylesheet"/><script>(adsbygoogle=window.adsbygoogle||[]).requestNonPersonalizedAds=1;</script><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body><noscript>You need to enable JavaScript to run this app.</noscript><div class="top-header"><a class="top-link" href="/">Yuni-Q</a><div class="flex items-center"><button class="outline-0 bg-white mx-[5px] p-0 appearance-none items-center rounded-[5px] border-0 cursor-pointer inline-flex h-10 justify-center opacity-75 overflow-hidden relative scale-75 transition-opacity duration-300 ease-in-out w-10 flex-shrink-0 hover:bg-black max-[800px]:hover:bg-white"><a href="https://github.com/Yuni-Q/blog" class="github" aria-label="GitHub"><svg class="github transition-all duration-300 ease-in-out pt-1 text-[#78757a] w-8 hover:text-white max-[800px]:hover:text-[#78757a]" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></svg></a></button><button class="outline-0 bg-white mx-[5px] p-0 appearance-none items-center rounded-[5px] border-0 cursor-pointer inline-flex h-10 justify-center opacity-75 overflow-hidden relative scale-75 transition-opacity duration-300 ease-in-out w-10 flex-shrink-0 hover:bg-black max-[800px]:hover:bg-white group"><div class="theme1 rounded-full h-6 relative w-6 transition-all duration-[450ms] ease-in-out bg-[#78757a]" style="border:none;overflow:visible;transform:scale(0.55)"><div class="absolute rounded-full h-6 w-6 transition-transform duration-[450ms] ease-in-out" style="border:none;opacity:0;right:-9px;top:-9px;transform:translate(14px, -14px);background:#78757a"></div><div class="absolute rounded-full h-2 w-2 left-1/2 top-1/2 transition-all duration-[350ms] ease-in-out" style="box-shadow:0 -23px 0 #78757a, 0 23px 0 #78757a, 23px 0 0 #78757a, -23px 0 0 #78757a, 15px 15px 0 #78757a, -15px 15px 0 #78757a, 15px -15px 0 #78757a, -15px -15px 0 #78757a;transform:scale(1);margin:-4px 0px 0px -4px"></div></div><div class="theme2 rounded-full border-0 h-6 absolute right-0 top-0 w-6 transition-all duration-[450ms] ease-in-out" style="background:none;opacity:0;transform:translate(14px, -14px)"></div></button><button class="outline-0 bg-white mx-[5px] p-0 appearance-none items-center rounded-[5px] border-0 cursor-pointer inline-flex h-10 justify-center opacity-75 overflow-hidden relative scale-75 transition-opacity duration-300 ease-in-out w-10 flex-shrink-0 hover:bg-black max-[800px]:hover:bg-white group"><svg class="snow transition-all duration-300 ease-in-out w-7 group-hover:fill-white max-[800px]:group-hover:fill-[#78757a]" style="fill:#78757a" version="1.1" id="레이어_1" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 23.9 22.9"><path d="M23.9,10c0-0.3-0.2-0.5-0.4-0.6l-1.1-0.3C22.1,9.1,22,9,21.9,8.8c-0.1-0.2,0-0.4,0.1-0.6l0.8-0.9       c0.2-0.2,0.2-0.5,0-0.7c-1.2-1.4-3.1-2-5-1.4c-0.4,0.1-0.9,0.4-1.4,0.7c0.1-0.6,0.2-1.1,0.2-1.6c0-1.9-1.2-3.6-2.9-4.3       c-0.2-0.1-0.5,0-0.7,0.2l-0.6,1c-0.1,0.2-0.3,0.3-0.5,0.3c-0.2,0-0.4-0.1-0.5-0.3l-0.6-1C10.7,0,10.4-0.1,10.2,0       C8.5,0.7,7.3,2.4,7.3,4.3c0,0.5,0.1,1,0.2,1.6C7,5.6,6.5,5.4,6.1,5.2c-1.8-0.6-3.8,0-5,1.4c-0.2,0.2-0.2,0.5,0,0.7l0.8,0.9       C2,8.4,2.1,8.6,2,8.8c0,0.2-0.2,0.3-0.4,0.4L0.4,9.5C0.2,9.5,0,9.8,0,10c0.1,1.8,1.4,3.5,3.2,4c0.4,0.1,1,0.2,1.5,0.3       c-0.4,0.4-0.8,0.8-1.1,1.1c-1.1,1.6-1.2,3.6-0.2,5.2c0.1,0.2,0.4,0.3,0.7,0.2l1.1-0.4c0.2-0.1,0.4-0.1,0.6,0C6,20.6,6,20.8,6,21.1       l-0.1,1.2c0,0.3,0.2,0.5,0.4,0.6c1.8,0.4,3.7-0.2,4.8-1.8c0.3-0.4,0.5-0.8,0.8-1.4c0.2,0.5,0.5,1,0.8,1.4c1.1,1.6,3.1,2.2,4.8,1.8       c0.3-0.1,0.4-0.3,0.4-0.6l-0.1-1.2c0-0.3,0.1-0.4,0.2-0.5c0.1-0.1,0.3-0.1,0.6,0l1.1,0.4c0.2,0.1,0.5,0,0.7-0.2       c1-1.6,0.9-3.6-0.2-5.2c-0.3-0.4-0.6-0.8-1.1-1.1c0.6-0.1,1.1-0.2,1.5-0.3C22.6,13.5,23.8,11.8,23.9,10z M14.1,12.8       c0.3-0.2,0.7-0.3,1.1-0.1c0.4,0.3,0.6,0.8,0.3,1.3c-0.3,0.4-0.8,0.6-1.3,0.3c-0.3-0.2-0.5-0.6-0.4-1l-1.4-0.8v1.6       c0.4,0.1,0.6,0.5,0.6,0.9c0,0.5-0.4,0.9-0.9,0.9c-0.5,0-0.9-0.4-0.9-0.9c0-0.4,0.3-0.7,0.6-0.9v-1.6l-1.4,0.8c0.1,0.4-0.1,0.8-0.4,1       c-0.4,0.3-1,0.1-1.3-0.3c-0.3-0.4-0.1-1,0.3-1.3c0.3-0.2,0.8-0.1,1.1,0.1l1.4-0.8L10,11.1c-0.3,0.2-0.7,0.3-1.1,0.1       C8.5,11,8.3,10.4,8.6,10c0.3-0.4,0.8-0.6,1.3-0.3c0.3,0.2,0.5,0.6,0.4,1l1.4,0.8V9.8c-0.4-0.1-0.6-0.5-0.6-0.9C11.1,8.4,11.5,8,12,8       c0.5,0,0.9,0.4,0.9,0.9c0,0.4-0.3,0.7-0.6,0.9v1.6l1.4-0.8c-0.1-0.4,0.1-0.8,0.4-1c0.4-0.3,1-0.1,1.3,0.3c0.3,0.4,0.1,1-0.3,1.3       c-0.3,0.2-0.8,0.1-1.1-0.1l-1.4,0.8L14.1,12.8z"></path></svg></button><a class="w-[30px] h-[30px] leading-[30px] mx-[5px] text-black flex-shrink-0 flex items-center justify-center" href="/search/">검색</a></div></div><div class="layout-content" style="margin-right:0;max-width:none"><div class="mb-6 max-w-4xl mx-auto px-4 xl:pr-[220px]"><ins class="adsbygoogle block min-w-[320px] min-h-0 mx-auto bg-gray-300" data-ad-client="ca-pub-2667251850399676" data-ad-slot="9586629994" data-ad-format="auto" data-full-width-responsive="true"></ins></div><div class="relative"><div class="max-w-4xl mx-auto px-4 xl:pr-[220px]"><h1 class="text-4xl md:text-5xl font-extrabold mb-6 leading-tight text-gray-900 dark:text-gray-100">typeorm 톺아보기</h1><div class="flex flex-col gap-4 mb-8"><div class="flex items-center gap-2 text-gray-600 dark:text-gray-400"><span class="text-sm font-medium">yuni-q</span><span class="text-gray-400 dark:text-gray-500">·</span><span class="text-sm">2021년 3월 9일</span></div><div class="flex flex-wrap gap-2"><span class="px-3 py-1.5 text-sm rounded-md bg-green-50 dark:bg-green-900/20 text-gray-700 dark:text-gray-300 hover:bg-green-100 dark:hover:bg-green-900/30 transition-colors cursor-pointer">node</span><span class="px-3 py-1.5 text-sm rounded-md bg-green-50 dark:bg-green-900/20 text-gray-700 dark:text-gray-300 hover:bg-green-100 dark:hover:bg-green-900/30 transition-colors cursor-pointer">sql</span><span class="px-3 py-1.5 text-sm rounded-md bg-green-50 dark:bg-green-900/20 text-gray-700 dark:text-gray-300 hover:bg-green-100 dark:hover:bg-green-900/30 transition-colors cursor-pointer">db</span><span class="px-3 py-1.5 text-sm rounded-md bg-green-50 dark:bg-green-900/20 text-gray-700 dark:text-gray-300 hover:bg-green-100 dark:hover:bg-green-900/30 transition-colors cursor-pointer">rdb</span><span class="px-3 py-1.5 text-sm rounded-md bg-green-50 dark:bg-green-900/20 text-gray-700 dark:text-gray-300 hover:bg-green-100 dark:hover:bg-green-900/30 transition-colors cursor-pointer">typeorm</span><span class="px-3 py-1.5 text-sm rounded-md bg-green-50 dark:bg-green-900/20 text-gray-700 dark:text-gray-300 hover:bg-green-100 dark:hover:bg-green-900/30 transition-colors cursor-pointer">orm</span></div></div><div class="jsx-4115489982 post-content prose prose-lg max-w-none  prose-headings:font-semibold prose-p:leading-relaxed prose-a:text-blue-600 dark:prose-a:text-blue-400 prose-a:no-underline hover:prose-a:underline prose-strong:font-semibold prose-code:font-mono prose-code:text-sm prose-code:px-1 prose-code:py-0.5 prose-code:rounded prose-pre:bg-gray-900 dark:prose-pre:bg-gray-800 prose-blockquote:border-l-4 prose-blockquote:pl-4 prose-blockquote:italic prose-blockquote:my-6 prose-img:rounded-lg prose-img:shadow-md prose-table:w-full prose-ul:list-disc prose-ol:list-decimal prose-li:my-1"><ul>
<li>
<p>Node와 RDB의 ORM 서비스는 sequelize, typeorm, prisma 등 많은 라이브러리들이 있습니다.</p>
</li>
<li>
<p>가장 먼저 사용한 ORM 서비스는 sequelize 였지만 typeorm이 typescript 지원이나 시장의 흐름에 따라 조금 더 많이 사용된다고 생각되어 공부하게 되었습니다.</p>
<ul>
<li>prisma도 고려해 보았으나 아직은 시기상조인 것 같았습니다.</li>
</ul>
</li>
</ul>
<h2 id="typeorm에-대해-알아보기-전에-orm이-무엇인지-알아보겠습니다">typeorm에 대해 알아보기 전에 ORM이 무엇인지 알아보겠습니다.<a aria-hidden="true" tabindex="-1" href="#typeorm에-대해-알아보기-전에-orm이-무엇인지-알아보겠습니다"><span class="anchor"></span></a></h2>
<ul>
<li>ORM(Object-relational mapping)은 객체지향 프로그래밍(Object-Oriented-Programming)과 관계형 데이터베이스(Relational-Database)사이의 호환되지 않는 <code class="inline-code">데이터를 변환하는 시스템</code>입니다.
<ul>
<li>객체와 테이블 시스템(RDBMS)을 변형 및 연결해주는 작업입니다.</li>
</ul>
</li>
<li>ORM을 이용한 개발은 객체와 데이터베이스의 변형에 유연하게 대처할 수 있습니다.</li>
<li>ORM을 객체 지향 프로그래밍 관점에서 생각해보면, 관계형 데이터베이스에 제약을 최대한 받지 않으면서, 객체를 클래스로 표현하는 것과 같이 관계형 데이터베이스를 객체처럼 쉽게 표현합니다.
<ul>
<li>객체지향 프로그래밍은 Class를 사용하고 관계형 데이터베이스는 Table을 사용합니다.</li>
</ul>
</li>
</ul>
<h2 id="바로-본론으로-들어가서-typeorm을-프로젝트에서-어떻게-도입할지-알아보겠습니다">바로 본론으로 들어가서 typeorm을 프로젝트에서 어떻게 도입할지 알아보겠습니다.<a aria-hidden="true" tabindex="-1" href="#바로-본론으로-들어가서-typeorm을-프로젝트에서-어떻게-도입할지-알아보겠습니다"><span class="anchor"></span></a></h2>
<ul>
<li>의존성 설치 및 init</li>
</ul>
<pre class="language-bash optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-bash code-highlight"><span class="code-line"><span class="token function">npm</span> <span class="token function">install</span> typeorm reflect-metadata @types/node mysql
</span><span class="code-line">typeorm init <span class="token parameter variable">--name</span> <span class="token punctuation">[</span>프로젝트이름<span class="token punctuation">]</span> <span class="token parameter variable">--database</span> <span class="token punctuation">[</span>데이터베이스<span class="token punctuation">]</span>
</span></code></pre>
<ul>
<li>global place 의 app.ts에 import 추가합니다.
<ul>
<li>reflect-metadata 패키지를 사용하면 유형에 대한 런타임 반영을 수행 할 수 있습니다. TypeORM은 대부분 데코레이터 (@Entity 또는 @Column)와 함께 작동하므로이 패키지는 이러한 데코레이터를 구문 분석하고 SQL 쿼리를 작성하는 데 사용합니다.</li>
</ul>
</li>
</ul>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token keyword">import</span> <span class="token string">'reflect-metadata'</span><span class="token punctuation">;</span>
</span></code></pre>
<h3 id="노드-모듈typeorm-model-generator-이용해-모델-자동-생성하는-방법도-있습니다">노드 모듈(typeorm-model-generator) 이용해 모델 자동 생성하는 방법도 있습니다.<a aria-hidden="true" tabindex="-1" href="#노드-모듈typeorm-model-generator-이용해-모델-자동-생성하는-방법도-있습니다"><span class="anchor"></span></a></h3>
<ul>
<li>각 옵션을 수동으로 입력</li>
</ul>
<pre class="language-bash optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-bash code-highlight"><span class="code-line">typeorm-model-generator
</span></code></pre>
<ul>
<li>커맨드 한 번에 생성</li>
</ul>
<pre class="language-bash optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-bash code-highlight"><span class="code-line">typeorm-model-generator <span class="token parameter variable">-h</span> localhost <span class="token parameter variable">-u</span> <span class="token variable">$userName</span> <span class="token parameter variable">-x</span> <span class="token variable">$password</span> <span class="token parameter variable">-e</span> mysql <span class="token parameter variable">-o</span> ./entities <span class="token parameter variable">--ssl</span>
</span></code></pre>
<h2 id="typeorm-작성-패턴에-대해-알아보겠습니다">typeorm 작성 패턴에 대해 알아보겠습니다.<a aria-hidden="true" tabindex="-1" href="#typeorm-작성-패턴에-대해-알아보겠습니다"><span class="anchor"></span></a></h2>
<ul>
<li>Active Record 패턴과 Data Mapper 패턴이 있습니다.</li>
</ul>
<h2 id="active-record-패턴에-대해-먼저-알아보겠습니다">Active Record 패턴에 대해 먼저 알아보겠습니다.<a aria-hidden="true" tabindex="-1" href="#active-record-패턴에-대해-먼저-알아보겠습니다"><span class="anchor"></span></a></h2>
<ul>
<li>Active Record 패턴은 <code class="inline-code">모델 그 자체에 쿼리 메소드를 정의</code>하고, <code class="inline-code">모델의 메소드를 사용</code>하여 객체를 저장, 제거, 불러오는 방식입니다.</li>
<li>BaseEntity라는 클래스를 사용하여 새로운 클래스에 상속하게 한 후 사용할 수 있습니다. 이를 통해 BaseEntity가 갖고 있는 메소드와 static으로 만들어 내는 커스텀 메소드를 이용할 수 있습니다.</li>
<li>규모가 작은 애플리케이션에서 적합하고 간단히 사용할 수 있습니다.</li>
</ul>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> BaseEntity<span class="token punctuation">,</span> Entity<span class="token punctuation">,</span> PrimaryGeneratedColumn<span class="token punctuation">,</span> Column <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">extends</span> <span class="token class-name">BaseEntity</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">PrimaryGeneratedColumn</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  firstName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  lastName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  isActive<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">static</span> <span class="token function">findByName</span><span class="token punctuation">(</span>firstName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> lastName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">createQueryBuilder</span><span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">)</span>
</span><span class="code-line">      <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'user.firstName = :firstName'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> firstName <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">      <span class="token punctuation">.</span><span class="token function">andWhere</span><span class="token punctuation">(</span><span class="token string">'user.lastName = :lastName'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> lastName <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">      <span class="token punctuation">.</span><span class="token function">getMany</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token comment">// example how to save AR entity</span>
</span><span class="code-line"><span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">user<span class="token punctuation">.</span>firstName <span class="token operator">=</span> <span class="token string">'Timber'</span><span class="token punctuation">;</span>
</span><span class="code-line">user<span class="token punctuation">.</span>lastName <span class="token operator">=</span> <span class="token string">'Saw'</span><span class="token punctuation">;</span>
</span><span class="code-line">user<span class="token punctuation">.</span>isActive <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">await</span> user<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// example how to remove AR entity</span>
</span><span class="code-line"><span class="token keyword">await</span> user<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// example how to load AR entities</span>
</span><span class="code-line"><span class="token keyword">const</span> users <span class="token operator">=</span> <span class="token keyword">await</span> User<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span> skip<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> take<span class="token operator">:</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> newUsers <span class="token operator">=</span> <span class="token keyword">await</span> User<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span> isActive<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> timber <span class="token operator">=</span> <span class="token keyword">await</span> User<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span> firstName<span class="token operator">:</span> <span class="token string">'Timber'</span><span class="token punctuation">,</span> lastName<span class="token operator">:</span> <span class="token string">'Saw'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> timber <span class="token operator">=</span> <span class="token keyword">await</span> User<span class="token punctuation">.</span><span class="token function">findByName</span><span class="token punctuation">(</span><span class="token string">'Timber'</span><span class="token punctuation">,</span> <span class="token string">'Saw'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<h2 id="data-mapper-패턴에-대해서도-알아보겠습니다">Data Mapper 패턴에 대해서도 알아보겠습니다.<a aria-hidden="true" tabindex="-1" href="#data-mapper-패턴에-대해서도-알아보겠습니다"><span class="anchor"></span></a></h2>
<ul>
<li>Data Mapper 패턴은 <code class="inline-code">분리된 클래스에 쿼리 메소드를 정의</code>하는 방식이며, <code class="inline-code">Repository를 이용</code>하여 객체를 저장, 제거, 불러옵니다.</li>
<li>Active Record 패턴과의 차이점은 모델에 접근하는 방식이 아닌 <code class="inline-code">Repository에서 데이터에 접근</code>한다는 것입니다.</li>
<li>규모가 큰 애플리케이션에 적합하고 유지보수하는데 효과적이다.</li>
</ul>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> Entity<span class="token punctuation">,</span> PrimaryGeneratedColumn<span class="token punctuation">,</span> Column <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">PrimaryGeneratedColumn</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  firstName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  lastName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  isActive<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> EntityRepository<span class="token punctuation">,</span> Repository <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> User <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../entity/User'</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">EntityRepository</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserRepository</span> <span class="token keyword">extends</span> <span class="token class-name">Repository<span class="token operator">&#x3C;</span>User<span class="token operator">></span></span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token function">findByName</span><span class="token punctuation">(</span>firstName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> lastName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">createQueryBuilder</span><span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">)</span>
</span><span class="code-line">      <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'user.firstName = :firstName'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> firstName <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">      <span class="token punctuation">.</span><span class="token function">andWhere</span><span class="token punctuation">(</span><span class="token string">'user.lastName = :lastName'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> lastName <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">      <span class="token punctuation">.</span><span class="token function">getMany</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token keyword">const</span> userRepository <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">getRepository</span><span class="token punctuation">(</span>User<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// example how to save DM entity</span>
</span><span class="code-line"><span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">user<span class="token punctuation">.</span>firstName <span class="token operator">=</span> <span class="token string">'Timber'</span><span class="token punctuation">;</span>
</span><span class="code-line">user<span class="token punctuation">.</span>lastName <span class="token operator">=</span> <span class="token string">'Saw'</span><span class="token punctuation">;</span>
</span><span class="code-line">user<span class="token punctuation">.</span>isActive <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">await</span> userRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// example how to remove DM entity</span>
</span><span class="code-line"><span class="token keyword">await</span> userRepository<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// example how to load DM entities</span>
</span><span class="code-line"><span class="token keyword">const</span> users <span class="token operator">=</span> <span class="token keyword">await</span> userRepository<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span> skip<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> take<span class="token operator">:</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> newUsers <span class="token operator">=</span> <span class="token keyword">await</span> userRepository<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span> isActive<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> timber <span class="token operator">=</span> <span class="token keyword">await</span> userRepository<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="code-line">  firstName<span class="token operator">:</span> <span class="token string">'Timber'</span><span class="token punctuation">,</span>
</span><span class="code-line">  lastName<span class="token operator">:</span> <span class="token string">'Saw'</span><span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<h2 id="entity들을-만들었다면-데이터베이스에-대한-연결-생성하는-법을-알아-보겠습니다">entity들을 만들었다면 데이터베이스에 대한 연결 생성하는 법을 알아 보겠습니다.<a aria-hidden="true" tabindex="-1" href="#entity들을-만들었다면-데이터베이스에-대한-연결-생성하는-법을-알아-보겠습니다"><span class="anchor"></span></a></h2>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token keyword">import</span> <span class="token string">'reflect-metadata'</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> createConnection <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> Photo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./entity/Photo'</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="code-line">  type<span class="token operator">:</span> <span class="token string">'mysql'</span><span class="token punctuation">,</span>
</span><span class="code-line">  host<span class="token operator">:</span> <span class="token string">'localhost'</span><span class="token punctuation">,</span>
</span><span class="code-line">  port<span class="token operator">:</span> <span class="token number">3306</span><span class="token punctuation">,</span>
</span><span class="code-line">  username<span class="token operator">:</span> <span class="token string">'root'</span><span class="token punctuation">,</span>
</span><span class="code-line">  password<span class="token operator">:</span> <span class="token string">'admin'</span><span class="token punctuation">,</span>
</span><span class="code-line">  database<span class="token operator">:</span> <span class="token string">'test'</span><span class="token punctuation">,</span>
</span><span class="code-line">  entities<span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="code-line">    Photo<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token comment">// __dirname + '/entity/*.js'</span>
</span><span class="code-line">  <span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">  synchronize<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
</span><span class="code-line">  logging<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>connection<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token comment">// here you can start to work with your entities</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<h2 id="entity를-만드는-방법에-대해-조금-더-상세히-알아보겠습니다">Entity를 만드는 방법에 대해 조금 더 상세히 알아보겠습니다.<a aria-hidden="true" tabindex="-1" href="#entity를-만드는-방법에-대해-조금-더-상세히-알아보겠습니다"><span class="anchor"></span></a></h2>
<h3 id="entity-데코레이터">Entity 데코레이터<a aria-hidden="true" tabindex="-1" href="#entity-데코레이터"><span class="anchor"></span></a></h3>
<ul>
<li>데이터베이스 테이블을 정의하기 전에 실행해야하는 데코레이터입니다.</li>
<li>테이블명을 따로 지정하지 않아도 클래스명으로 매핑하지만, 옵션으로 테이블명을 지정할 수 있습니다.</li>
</ul>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token string">'users'</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</span></code></pre>
<ul>
<li>name: <code class="inline-code">테이블 이름</code>입니다. 지정하지 않으면 테이블 이름은 엔티티 <code class="inline-code">클래스명</code>으로 생성됩니다.</li>
<li>database: 선택된 DB서버의 데이터베이스 이름입니다.</li>
<li>schema: 스키마 이름입니다.
<ul>
<li>MySQL에서는 schema와 database가 따로 분리되어있지 않습니다. OracleDB에서는 schema를 따로 분리해서 database에 할당된 사용자로 사용합니다.</li>
</ul>
</li>
<li>engine: 테이블 생성 중에 설정할 수 있는 DB엔진 이름입니다.</li>
<li>synchronize: false로 설정할 시 스키마 싱크를 건너뜁니다.</li>
<li>orderBy: QueryBuilder과 find를 실행할 때 엔티티의 기본순서를 지정합니다.</li>
</ul>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="code-line">  name<span class="token operator">:</span> <span class="token string">'users'</span><span class="token punctuation">,</span>
</span><span class="code-line">  engine<span class="token operator">:</span> <span class="token string">'MyISAM'</span><span class="token punctuation">,</span>
</span><span class="code-line">  database<span class="token operator">:</span> <span class="token string">'example_dev'</span><span class="token punctuation">,</span>
</span><span class="code-line">  schema<span class="token operator">:</span> <span class="token string">'schema_with_best_tables'</span><span class="token punctuation">,</span>
</span><span class="code-line">  synchronize<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
</span><span class="code-line">  orderBy<span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">    name<span class="token operator">:</span> <span class="token string">'ASC'</span><span class="token punctuation">,</span>
</span><span class="code-line">    id<span class="token operator">:</span> <span class="token string">'DESC'</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</span></code></pre>
<h3 id="중복되는-entity를-상속를-사용하여-해결할-수-있습니다">중복되는 Entity를 상속를 사용하여 해결할 수 있습니다.<a aria-hidden="true" tabindex="-1" href="#중복되는-entity를-상속를-사용하여-해결할-수-있습니다"><span class="anchor"></span></a></h3>
<ul>
<li>Concrete table inheritance와 Single table inheritance가 있습니다.</li>
</ul>
<h4 id="concrete-table-inheritance">Concrete table inheritance<a aria-hidden="true" tabindex="-1" href="#concrete-table-inheritance"><span class="anchor"></span></a></h4>
<ul>
<li>중복된 칼럼을 베이스가 되는 <code class="inline-code">추상 클래스</code>를 선언한 다음 확장할 수 있습니다.</li>
<li>참고로 active record 패턴을 사용할 예정이라면, <code class="inline-code">BaseEntity</code>라는 이름은 피하는게 좋습니다.
<ul>
<li>typeorm에서 제공하는 클래스인 BaseEntity는 기본 쿼리 메서드 hasId, save, remove 등의 메서드를 담은 클래스입니다.</li>
</ul>
</li>
</ul>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token comment">// 추상 클래스</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Content</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">PrimaryGeneratedColumn</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  title<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  description<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 1</span>
</span><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Photo</span> <span class="token keyword">extends</span> <span class="token class-name">Content</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  size<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 2</span>
</span><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Question</span> <span class="token keyword">extends</span> <span class="token class-name">Content</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  answersCount<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 3</span>
</span><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Post</span> <span class="token keyword">extends</span> <span class="token class-name">Content</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  viewCount<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<h4 id="single-table-inheritance">Single table inheritance<a aria-hidden="true" tabindex="-1" href="#single-table-inheritance"><span class="anchor"></span></a></h4>
<ul>
<li>@TableInheritance(), @ChildEntity()를 사용하는 방법입니다.</li>
<li>이 방법은 데이터베이스에 Content 테이블이 생성됩니다. <code class="inline-code">Content 위에 @Entity()를 선언</code>해줘야 아래와 같은 패턴을 사용할 수 있습니다.</li>
</ul>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">TableInheritance</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> column<span class="token operator">:</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'varchar'</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">'type'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Content</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">PrimaryGeneratedColumn</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  title<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  description<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">ChildEntity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Photo</span> <span class="token keyword">extends</span> <span class="token class-name">Content</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  size<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">ChildEntity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Question</span> <span class="token keyword">extends</span> <span class="token class-name">Content</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  answersCount<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">ChildEntity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Post</span> <span class="token keyword">extends</span> <span class="token class-name">Content</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  viewCount<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<h3 id="embedded-entities">Embedded entities<a aria-hidden="true" tabindex="-1" href="#embedded-entities"><span class="anchor"></span></a></h3>
<ul>
<li>이름이 비슷하고 타입이 같은 칼럼들을 묶는 패턴입니다.</li>
<li>User.name은 User.nameFirst, User.nameLast로 분기합니다. Name은 데코레이터 @Entity()가 붙어있지 않기때문에 위의 패턴처럼 <code class="inline-code">실제 테이블이 생겨나지는 않습니다</code>.</li>
</ul>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Name</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  first<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  last<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">PrimaryGeneratedColumn</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token operator">=></span> Name<span class="token punctuation">)</span>
</span><span class="code-line">  name<span class="token operator">:</span> Name<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  isActive<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<h3 id="viewentity">ViewEntity<a aria-hidden="true" tabindex="-1" href="#viewentity"><span class="anchor"></span></a></h3>
<h4 id="sql-view란-">SQL view란 ?<a aria-hidden="true" tabindex="-1" href="#sql-view란-"><span class="anchor"></span></a></h4>
<ul>
<li>view는 하나의 <code class="inline-code">가상 테이블</code>입니다.</li>
<li>실제 데이터가 저장되는 것은 아니지만, view를 통해 데이터를 가상 테이블로 관리가 가능합니다.</li>
<li>1개의 view로 여러 테이블의 데이터를 조회할 수 있습니다.</li>
<li>복잡한 쿼리를 통해 얻을 수 있는 결과를 간단한 쿼리로 얻을 수 있게 도와줍니다.</li>
<li>특정 기준에 따른 사용자 별로 다른 데이터를 액세스할 수 있도록 도와줄 수도 있습니다.</li>
<li>조회 대상을 줄이고 싶을 때 사용할 수 있습니다.</li>
</ul>
<h4 id="viewentity-데코레이터-인자">ViewEntity 데코레이터 인자<a aria-hidden="true" tabindex="-1" href="#viewentity-데코레이터-인자"><span class="anchor"></span></a></h4>
<ul>
<li>데코레이터에 들어가는 인자가 아래와 같이 @Entity()와는 약간 다릅니다.
<ul>
<li>name: 테이블 이름입니다. 지정하지 않으면 테이블 이름은 엔티티 클래스명으로 생성됩니다.</li>
<li>database: 선택된 DB서버의 데이터베이스 이름입니다.</li>
<li>schema: 스키머 이름입니다.</li>
<li>expression: view를 정의합니다. 꼭 있어야하는 파라미터로 SQL쿼리문이나 queryBuilder 체이닝 메서드가 들어갈 수 있습니다.</li>
</ul>
</li>
<li>expression은 SQL 쿼리문이나 QueryBuilder에 체이닝할 수 있는 메서드가 들어갈 수 있습니다. 특이점으로는 필드명 위에 들어가는 데코레이터를 id까지 전부 @ViewColumn()을 사용해야 한다는 점이 있습니다. 만약 사용을 고려한다면, JOIN을 쳐서 테이블끼리 연결을 시키냐, 아니면 view를 통해 나중에 자주 사용할 가상 테이블을 미리 만들어두냐의 차이로 생각할 수 있습니다.</li>
</ul>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">ViewEntity</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="code-line">  expression<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
</span></span></span><span class="code-line"><span class="token template-string"><span class="token string">        SELECT "post"."id" AS "id", "post"."name" AS "name", "category"."name" AS "categoryName"
</span></span></span><span class="code-line"><span class="token template-string"><span class="token string">        FROM "post" "post"
</span></span></span><span class="code-line"><span class="token template-string"><span class="token string">        LEFT JOIN "category" "category" ON "post"."categoryId" = "category"."id"
</span></span></span><span class="code-line"><span class="token template-string"><span class="token string">    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">PostCategory</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">ViewColumn</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">ViewColumn</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">ViewColumn</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  categoryName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<ul>
<li>구조가 복잡하고, 여러군데서 호출하는 데이터의 경우 미리 ViewEntity로 view 테이블을 만들어두면 유용합니다.</li>
</ul>
<h3 id="column">Column<a aria-hidden="true" tabindex="-1" href="#column"><span class="anchor"></span></a></h3>
<ul>
<li>entity의 속성을 테이블 칼럼으로 표시합니다.</li>
</ul>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">PrimaryGeneratedColumn</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> tpye<span class="token operator">:</span> <span class="token string">'varchar'</span><span class="token punctuation">,</span> length<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span> unique<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">  firstName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> nullable<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">  lastName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token keyword">default</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">  isActive<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<ul>
<li>
<p>@Column()에 들어갈 수 있는 옵션들 중 중요하다고 판단한 것들은 아래와 같습니다.</p>
<ul>
<li>type(ColumnType) : <code class="inline-code">javascript의 원시타입</code>들을 세분화해서 사용할 수 있습니다. 타입을 정의하는 방법은 다음과 같습니다.</li>
<li>length(string | number) : javascript의 원시타입들을 세분화해서 사용하기 위해 type 옵션과 같이 사용할 수 있습니다.</li>
<li>onUpdate(string) : cascading을 하기 위한 옵션으로 ON UPDATE 트리거입니다.</li>
<li>nullable(boolean) : 칼럼을 NULL이나 NOT NULL로 만드는 옵션입니다. 기본값은 false입니다.</li>
<li>default(string) : 칼럼에 DEFAULT 값을 설정합니다.</li>
<li>unique(boolean) : 유니크 칼럼이라고 표시할 수 있습니다. 유니크 constraint를 만듭니다. 기본값은 false 입니다.</li>
<li>enum(string[] | AnyEnum) : 칼럼의 값으로 enum을 사용할 수 있습니다. enum은 db단에서 처리할 수도, orm단에서 처리할 수도 있습니다.</li>
<li>enumName(string) : 다른 테이블에서 같은 enum을 사용하는 경우 필요합니다.</li>
<li>transformer({ from(value: DatabaseType): EntityType, to(value: EntityType): DatabaseType }) : 아래와 같은 코드를 만들어내서 json을 문자열로 만들고 파싱하는 역할을 합니다. 또는 boolean을 integer로 바꿔주는 일도 할 수 있습니다.</li>
</ul>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> ValueTransformer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">class</span> <span class="token class-name">SomeTransformer</span> <span class="token keyword">implements</span> <span class="token class-name">ValueTransformer</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token function">to</span><span class="token punctuation">(</span>value<span class="token operator">:</span> Map<span class="token operator">&#x3C;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">number</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span>value<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line">  <span class="token function">from</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> Map<span class="token operator">&#x3C;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">number</span><span class="token operator">></span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
</li>
</ul>
<h3 id="idcolumn">IdColumn<a aria-hidden="true" tabindex="-1" href="#idcolumn"><span class="anchor"></span></a></h3>
<ul>
<li>PrimaryColumn과 PrimaryGeneratedColum이 있습니다.</li>
</ul>
<h4 id="primarycolumn">PrimaryColumn<a aria-hidden="true" tabindex="-1" href="#primarycolumn"><span class="anchor"></span></a></h4>
<ul>
<li>@Column()의 옵션인 primary를 대체할 수 있습니다. <code class="inline-code">PK</code>를 만드는 역할을 합니다.</li>
</ul>
<h4 id="primarygeneratedcolumn">PrimaryGeneratedColumn<a aria-hidden="true" tabindex="-1" href="#primarygeneratedcolumn"><span class="anchor"></span></a></h4>
<ul>
<li><code class="inline-code">자동생성</code>되는 ID값을 표현하는 방식을 아래와 같이 2가지 옵션을 사용할 수 있도록 도와줍니다.
<ul>
<li>increment: AUTO_INCREMENT를 사용해서 1씩 증가하는 ID를 부여합니다. 기본 옵션입니다.</li>
<li>uuid: 유니크한 uuid를 사용할 수 있습니다.</li>
</ul>
</li>
</ul>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token comment">// using increment</span>
</span><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">PrimaryGeneratedColumn</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// using uuid</span>
</span><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">PrimaryGeneratedColumn</span></span><span class="token punctuation">(</span><span class="token string">'uuid'</span><span class="token punctuation">)</span>
</span><span class="code-line">  id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<h5 id="generated">Generated<a aria-hidden="true" tabindex="-1" href="#generated"><span class="anchor"></span></a></h5>
<ul>
<li>PK로 쓰는 ID 외에 추가로 uuid를 기록하기 위해서 사용할 수 있습니다.</li>
</ul>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Generated</span></span><span class="token punctuation">(</span><span class="token string">'uuid'</span><span class="token punctuation">)</span>
</span><span class="code-line">  uuid<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<h3 id="datecolumn">DateColumn<a aria-hidden="true" tabindex="-1" href="#datecolumn"><span class="anchor"></span></a></h3>
<ul>
<li>CreateDateColumn과 UpdateDateColumn, DeleteDateColumn이 있습니다.</li>
</ul>
<h4 id="createdatecolumn">CreateDateColumn<a aria-hidden="true" tabindex="-1" href="#createdatecolumn"><span class="anchor"></span></a></h4>
<ul>
<li>해당 열이 추가된 시각을 자동으로 기록합니다.</li>
<li>옵션을 적지 않을시 datetime 타입으로 기록됩니다.</li>
</ul>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">CreateDateColumn</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  createdAt<span class="token operator">:</span> Date<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<h4 id="updatedatecolumn">UpdateDateColumn<a aria-hidden="true" tabindex="-1" href="#updatedatecolumn"><span class="anchor"></span></a></h4>
<ul>
<li>해당 열이 수정된 시각을 자동으로 기록합니다.</li>
<li>옵션을 적지 않을시 datetime 타입으로 기록됩니다.</li>
</ul>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">UpdateDateColumn</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  updatedAt<span class="token operator">:</span> Date<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<h4 id="deletedatecolumn">DeleteDateColumn<a aria-hidden="true" tabindex="-1" href="#deletedatecolumn"><span class="anchor"></span></a></h4>
<ul>
<li>해당 열이 삭제된 시각을 자동으로 기록합니다.</li>
<li>옵션을 적지 않을시 datetime 타입으로 기록됩니다.</li>
<li>deletedAt에 시각이 기록되지 않은 열들만 쿼리하기 위해 TypeORM의 soft delete 기능을 활용할 수 있습니다.</li>
</ul>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">DeleteDateColumn</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  deletedAt<span class="token operator">:</span> Date<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<h5 id="soft-delete이란-">soft delete이란 ?<a aria-hidden="true" tabindex="-1" href="#soft-delete이란-"><span class="anchor"></span></a></h5>
<ul>
<li>데이터 열을 실제로 삭제하지 않고, 삭제여부를 나타내는 칼럼인 deletedAt을 사용하는 방식입니다.</li>
<li>일반적인 삭제 대신 삭제된 열을 갱신하는 UPDATE문을 사용하는 방식입니다.</li>
<li>시각이 기록되지 않은 열들만 필터해서 쿼리하도록 도와주는 역할을 합니다.</li>
<li>다른 테이블과 JOIN시 항상 삭제된 열을 검사해서 성능이 떨어집니다.</li>
<li>복구하거나 예전 기록을 확인하고자 할 때 간편합니다.</li>
</ul>
<h3 id="relation-이제-하나의-테이블이-아닌-테이블간의-관계에-대해-알아보겠습니다">Relation. 이제 하나의 테이블이 아닌 테이블간의 관계에 대해 알아보겠습니다.<a aria-hidden="true" tabindex="-1" href="#relation-이제-하나의-테이블이-아닌-테이블간의-관계에-대해-알아보겠습니다"><span class="anchor"></span></a></h3>
<ul>
<li>테이블간의 관계는 1:1, 1:N, M:N 관계가 있습니다.</li>
</ul>
<h4 id="onetoone">OneToOne<a aria-hidden="true" tabindex="-1" href="#onetoone"><span class="anchor"></span></a></h4>
<ul>
<li>@JoinColumn()을 사용한 필드는 FK(외래키)로 타겟 테이블에 등록됩니다. <code class="inline-code">@JoinColumn()은 반드시 한쪽 테이블에서만 사용해야 합니다</code>.</li>
<li>관계는 단방향과 양방향 모두 작성이 가능합니다.
<ul>
<li>uni-directional은 @OneToOne()을 한쪽에만 써주는 것</li>
<li>bi-directional은 양쪽에 모두 써주는 것</li>
</ul>
</li>
</ul>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Profile</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">PrimaryGeneratedColumn</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  gender<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  photo<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">OneToOne</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> User<span class="token punctuation">,</span> <span class="token punctuation">(</span>user<span class="token punctuation">)</span> <span class="token operator">=></span> user<span class="token punctuation">.</span>profile<span class="token punctuation">)</span>
</span><span class="code-line">  user<span class="token operator">:</span> User<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">PrimaryGeneratedColumn</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">OneToOne</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token operator">=></span> Profile<span class="token punctuation">,</span> <span class="token punctuation">(</span>profile<span class="token punctuation">)</span> <span class="token operator">=></span> profile<span class="token punctuation">.</span>user<span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">JoinColumn</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  profile<span class="token operator">:</span> Profile<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// using find* method</span>
</span><span class="code-line"><span class="token keyword">const</span> userRepo <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">getRepository</span><span class="token punctuation">(</span>User<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> users <span class="token operator">=</span> <span class="token keyword">await</span> userRepo<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span> relations<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'profile'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// using query builder</span>
</span><span class="code-line"><span class="token keyword">const</span> users <span class="token operator">=</span> <span class="token keyword">await</span> connection
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token function">getRepository</span><span class="token punctuation">(</span>User<span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token function">createQueryBuilder</span><span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token function">leftJoinAndSelect</span><span class="token punctuation">(</span><span class="token string">'user.profile'</span><span class="token punctuation">,</span> <span class="token string">'profile'</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token function">getMany</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<h4 id="manytooneonetomany">ManyToOne/OneToMany<a aria-hidden="true" tabindex="-1" href="#manytooneonetomany"><span class="anchor"></span></a></h4>
<ul>
<li>@OneToMany()/@ManyToOne()에서는 <code class="inline-code">@JoinColumn()을 생략</code>할 수 있습니다.</li>
<li><code class="inline-code">@OneToMany()는 @ManyToOne()이 없으면 안됩니다</code>.
<ul>
<li>하지만 반대로 @ManyToOne()은 @OneToMany()이 없어도 정의할 수 있습니다.</li>
</ul>
</li>
<li>@ManyToOne()을 설정한 테이블에는 <code class="inline-code">relation id가 외래키</code>를 가지고 있게 됩니다.</li>
</ul>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">PrimaryGeneratedColumn</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">OneToMany</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token operator">=></span> Photo<span class="token punctuation">,</span> <span class="token punctuation">(</span>photo<span class="token punctuation">)</span> <span class="token operator">=></span> photo<span class="token punctuation">.</span>user<span class="token punctuation">)</span>
</span><span class="code-line">  photos<span class="token operator">:</span> Photo<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Photo</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">PrimaryGeneratedColumn</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">ManyToOne</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token operator">=></span> User<span class="token punctuation">,</span> <span class="token punctuation">(</span>user<span class="token punctuation">)</span> <span class="token operator">=></span> user<span class="token punctuation">.</span>photos<span class="token punctuation">)</span>
</span><span class="code-line">  user<span class="token operator">:</span> User<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// using find* method</span>
</span><span class="code-line"><span class="token keyword">const</span> userRepository <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">getRepository</span><span class="token punctuation">(</span>User<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> users <span class="token operator">=</span> <span class="token keyword">await</span> userRepository<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span> relations<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'photos'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token comment">// or from inverse side</span>
</span><span class="code-line"><span class="token keyword">const</span> photoRepository <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">getRepository</span><span class="token punctuation">(</span>Photo<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> photos <span class="token operator">=</span> <span class="token keyword">await</span> photoRepository<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span> relations<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'user'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// using query builder</span>
</span><span class="code-line"><span class="token keyword">const</span> users <span class="token operator">=</span> <span class="token keyword">await</span> connection
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token function">getRepository</span><span class="token punctuation">(</span>User<span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token function">createQueryBuilder</span><span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token function">leftJoinAndSelect</span><span class="token punctuation">(</span><span class="token string">'user.photos'</span><span class="token punctuation">,</span> <span class="token string">'photo'</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token function">getMany</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token comment">// or from inverse side</span>
</span><span class="code-line"><span class="token keyword">const</span> photos <span class="token operator">=</span> <span class="token keyword">await</span> connection
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token function">getRepository</span><span class="token punctuation">(</span>Photo<span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token function">createQueryBuilder</span><span class="token punctuation">(</span><span class="token string">'photo'</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token function">leftJoinAndSelect</span><span class="token punctuation">(</span><span class="token string">'photo.user'</span><span class="token punctuation">,</span> <span class="token string">'user'</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token function">getMany</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<h4 id="manytomany">ManyToMany<a aria-hidden="true" tabindex="-1" href="#manytomany"><span class="anchor"></span></a></h4>
<ul>
<li>@ManyToMany() 관계에서는 <code class="inline-code">@JoinTable()이 반드시 필요합니다</code>. 한쪽 테이블에만 @JoinTable()을 넣어주면 됩니다.</li>
<li>단, @ManyToMany()에서 옵션 cascade가 true인 경우 soft delete를 할 수 있습니다. 필요에 따라 사용할 수 있습니다.</li>
</ul>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Category</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">PrimaryGeneratedColumn</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Question</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">PrimaryGeneratedColumn</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  title<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  text<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">ManyToMany</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> Category<span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">JoinTable</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  categories<span class="token operator">:</span> Category<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// using find* method</span>
</span><span class="code-line"><span class="token keyword">const</span> questionRepository <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">getRepository</span><span class="token punctuation">(</span>Question<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> questions <span class="token operator">=</span> <span class="token keyword">await</span> questionRepository<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span> relations<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'categories'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// using query builder</span>
</span><span class="code-line"><span class="token keyword">const</span> questions <span class="token operator">=</span> <span class="token keyword">await</span> connection
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token function">getRepository</span><span class="token punctuation">(</span>Question<span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token function">createQueryBuilder</span><span class="token punctuation">(</span><span class="token string">'question'</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token function">leftJoinAndSelect</span><span class="token punctuation">(</span><span class="token string">'question.categories'</span><span class="token punctuation">,</span> <span class="token string">'category'</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token function">getMany</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<h3 id="tree-entity">Tree entity<a aria-hidden="true" tabindex="-1" href="#tree-entity"><span class="anchor"></span></a></h3>
<ul>
<li>TypeORM은 트리 구조를 저장하기 위해 인접 목록 및 클로저 테이블 패턴을 지원합니다.</li>
</ul>
<h4 id="먼저-셀프조인에-예시에-대해-알아보겠습니다">먼저 셀프조인에 예시에 대해 알아보겠습니다.<a aria-hidden="true" tabindex="-1" href="#먼저-셀프조인에-예시에-대해-알아보겠습니다"><span class="anchor"></span></a></h4>
<ul>
<li>1개의 테이블에서 부모-자식 관계를 나타낼 수 있는 패턴</li>
<li>상품 카테고리(소,중,대분류)</li>
<li>사원(사원,관리자,상위관리자)</li>
<li>지역(읍/면/동,구/군,시/도)</li>
</ul>
<h4 id="typeorm은-셀프조인을-아래와-같은-4가지-패턴으로-지원합니다">TypeORM은 셀프조인을 아래와 같은 4가지 패턴으로 지원합니다.<a aria-hidden="true" tabindex="-1" href="#typeorm은-셀프조인을-아래와-같은-4가지-패턴으로-지원합니다"><span class="anchor"></span></a></h4>
<h4 id="adjacency-list">Adjacency list<a aria-hidden="true" tabindex="-1" href="#adjacency-list"><span class="anchor"></span></a></h4>
<ul>
<li>자기참조를 @ManyToOne(), @OneToMany() 데코레이터로 표현할 수 있습니다.</li>
<li>이 방식은 간단한 것이 가장 큰 장점이지만, JOIN하는데 제약이 있어 큰 트리를 로드하는데 문제가 있습니다.</li>
</ul>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Category</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">PrimaryGeneratedColumn</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  description<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">ManyToOne</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token operator">=></span> Category<span class="token punctuation">,</span> <span class="token punctuation">(</span>category<span class="token punctuation">)</span> <span class="token operator">=></span> category<span class="token punctuation">.</span>children<span class="token punctuation">)</span>
</span><span class="code-line">  parent<span class="token operator">:</span> Category<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">OneToMany</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token operator">=></span> Category<span class="token punctuation">,</span> <span class="token punctuation">(</span>category<span class="token punctuation">)</span> <span class="token operator">=></span> category<span class="token punctuation">.</span>parent<span class="token punctuation">)</span>
</span><span class="code-line">  children<span class="token operator">:</span> Category<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<h4 id="nested-set">Nested set<a aria-hidden="true" tabindex="-1" href="#nested-set"><span class="anchor"></span></a></h4>
<ul>
<li>@Tree(), @TreeChildren(), @TreeParent()를 사용한 또 다른 패턴입니다.</li>
<li>읽기 작업에는 효과적이지만 쓰기 작업에는 효과적이지 않습니다.</li>
<li>여러 개의 루트를 가질 수 없다는 점도 문제입니다.</li>
<li>@Tree()의 인자로 <code class="inline-code">nested-set</code>이 들어갑니다.</li>
</ul>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Tree</span></span><span class="token punctuation">(</span><span class="token string">'nested-set'</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Category</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">PrimaryGeneratedColumn</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">TreeChildren</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  children<span class="token operator">:</span> Category<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">TreeParent</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  parent<span class="token operator">:</span> Category<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<h4 id="materialized-path">Materialized path<a aria-hidden="true" tabindex="-1" href="#materialized-path"><span class="anchor"></span></a></h4>
<ul>
<li>구체화된 경로 혹은 경로 열거라고 부릅니다.</li>
<li>간단하고 효율적입니다.</li>
<li>nested set과 사용방법은 같습니다.</li>
<li>@Tree()의 인자로 <code class="inline-code">materialized-path</code>이 들어갑니다.</li>
</ul>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token keyword">import</span> <span class="token punctuation">{</span>
</span><span class="code-line">  Entity<span class="token punctuation">,</span>
</span><span class="code-line">  Tree<span class="token punctuation">,</span>
</span><span class="code-line">  Column<span class="token punctuation">,</span>
</span><span class="code-line">  PrimaryGeneratedColumn<span class="token punctuation">,</span>
</span><span class="code-line">  TreeChildren<span class="token punctuation">,</span>
</span><span class="code-line">  TreeParent<span class="token punctuation">,</span>
</span><span class="code-line">  TreeLevelColumn<span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Tree</span></span><span class="token punctuation">(</span><span class="token string">'materialized-path'</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Category</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">PrimaryGeneratedColumn</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">TreeChildren</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  children<span class="token operator">:</span> Category<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">TreeParent</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  parent<span class="token operator">:</span> Category<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<h3 id="closure-table">Closure table<a aria-hidden="true" tabindex="-1" href="#closure-table"><span class="anchor"></span></a></h3>
<ul>
<li>부모와 자식 사이의 관계를 분리된 테이블에 특별한 방법으로 저장합니다.</li>
<li>읽기와 쓰기 모두 효율적으로 할 수 있습니다.</li>
<li>nested set과 사용방법은 같습니다.</li>
<li>@Tree()의 인자로 closure-table이 들어갑니다.</li>
</ul>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token keyword">import</span> <span class="token punctuation">{</span>
</span><span class="code-line">  Entity<span class="token punctuation">,</span>
</span><span class="code-line">  Tree<span class="token punctuation">,</span>
</span><span class="code-line">  Column<span class="token punctuation">,</span>
</span><span class="code-line">  PrimaryGeneratedColumn<span class="token punctuation">,</span>
</span><span class="code-line">  TreeChildren<span class="token punctuation">,</span>
</span><span class="code-line">  TreeParent<span class="token punctuation">,</span>
</span><span class="code-line">  TreeLevelColumn<span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Tree</span></span><span class="token punctuation">(</span><span class="token string">'closure-table'</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Category</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">PrimaryGeneratedColumn</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">TreeChildren</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  children<span class="token operator">:</span> Category<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">TreeParent</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  parent<span class="token operator">:</span> Category<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<ul>
<li>선택적 매개 변수 옵션을 @Tree ( "closure-table", options)로 설정하여 클로저 테이블 이름 또는 클로저 테이블 열 이름을 지정할 수 있습니다.</li>
<li>ancestorColumnName 및 descandantColumnName은 기본 열의 메타 데이터를 수신하고 열의 이름을 반환하는 콜백 함수입니다.</li>
</ul>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Tree</span></span><span class="token punctuation">(</span><span class="token string">"closure-table"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line">    closureTableName<span class="token operator">:</span> <span class="token string">"category_closure"</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token function-variable function">ancestorColumnName</span><span class="token operator">:</span> <span class="token punctuation">(</span>column<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token string">"ancestor_"</span> <span class="token operator">+</span> column<span class="token punctuation">.</span>propertyName<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token function-variable function">descendantColumnName</span><span class="token operator">:</span> <span class="token punctuation">(</span>column<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token string">"descendant_"</span> <span class="token operator">+</span> column<span class="token punctuation">.</span>propertyName<span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></code></pre>
<h3 id="joincolumnjointable에-대해-조금-더-알아보겠습니다">JoinColumn/JoinTable에 대해 조금 더 알아보겠습니다.<a aria-hidden="true" tabindex="-1" href="#joincolumnjointable에-대해-조금-더-알아보겠습니다"><span class="anchor"></span></a></h3>
<ul>
<li>아래는 아래 2개의 데코레이터에 공통으로 사용할 수 있는 옵션입니다.
<ul>
<li>eager 옵션이 있어서 N+1 문제를 제어할 수 있음</li>
<li>cascade, onDelete 옵션이 있어 관계가 연결된 객체를 추가/수정/삭제되도록 할 수 있습니다. 버그를 유발할 수 있으니 주의해서 사용해야 합니다.</li>
</ul>
</li>
</ul>
<h4 id="n1-문제란">N+1 문제란?<a aria-hidden="true" tabindex="-1" href="#n1-문제란"><span class="anchor"></span></a></h4>
<ul>
<li>하위 엔티티들을 첫 쿼리 실행시 한번에 가져오지 않고, Lazy Loading으로 필요한 곳에서 사용되어 쿼리가 실행될때 발생하는 문제가 N+1 쿼리 문제입니다.</li>
</ul>
<h4 id="joincolumn">JoinColumn<a aria-hidden="true" tabindex="-1" href="#joincolumn"><span class="anchor"></span></a></h4>
<ul>
<li>@JoinColumn()을 사용하면 테이블에 자동으로 칼럼명과 참조 칼럼명을 합친 이름의 칼럼을 만들어냅니다.</li>
<li>외래키를 가진 칼럼명과 참조칼럼명을 설정할 수 있는 옵션을 가지고 있습니다.</li>
<li>설정하지 않으면 테이블명을 가지고 자동으로 매핑합니다.</li>
<li>주의할 점으로는 @ManyToOne()에서는 꼭 적지 않아도 칼럼을 자동으로 만들어주지만, <code class="inline-code">@OneToOne()에서는 반드시 적어줘야 합니다</code>.</li>
</ul>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Post</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">ManyToOne</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token operator">=></span> Category<span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">JoinColumn</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="code-line">    name<span class="token operator">:</span> <span class="token string">'category_id'</span><span class="token punctuation">,</span>
</span><span class="code-line">    referencedColumnName<span class="token operator">:</span> <span class="token string">'name'</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">  category<span class="token operator">:</span> Category<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Category</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">PrimaryGeneratedColumn</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<h3 id="jointable">JoinTable<a aria-hidden="true" tabindex="-1" href="#jointable"><span class="anchor"></span></a></h3>
<ul>
<li><code class="inline-code">M:N 관계</code>에서 사용하며 연결 테이블을 설정할 수 있습니다.</li>
<li>@JoinTable()의 옵션을 사용해 연결 테이블의 칼럼명과 참조 칼럼명을 설정할 수 있습니다.</li>
</ul>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Question</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">ManyToMany</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token operator">=></span> Category<span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">JoinTable</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="code-line">    name<span class="token operator">:</span> <span class="token string">'question_categories'</span><span class="token punctuation">,</span>
</span><span class="code-line">    joinColumn<span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">      name<span class="token operator">:</span> <span class="token string">'question'</span><span class="token punctuation">,</span>
</span><span class="code-line">      referencedColumnName<span class="token operator">:</span> <span class="token string">'id'</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">    inverseJoinColumn<span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">      name<span class="token operator">:</span> <span class="token string">'category'</span><span class="token punctuation">,</span>
</span><span class="code-line">      referencedColumnName<span class="token operator">:</span> <span class="token string">'id'</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">  categories<span class="token operator">:</span> Category<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Category</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">PrimaryGeneratedColumn</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<h3 id="relationid">RelationId<a aria-hidden="true" tabindex="-1" href="#relationid"><span class="anchor"></span></a></h3>
<ul>
<li>1:N/M:N 관계에서 entity에 명시적으로 관계가 있는 테이블의 칼럼 id를 적고싶은 경우, @RelationId()를 사용하면 됩니다.</li>
<li>@RelationId()가 꼭 필요하지는 않지만 entity를 보면서 칼럼을 한 눈에 볼 수 있다는 장점이 있습니다.</li>
<li>@RelationId()로 테이블을 조회하면 새로운 칼럼명도 결과에 같이 들고올 수 있습니다.</li>
<li>하지만 relationId 칼럼에 삽입하여 사용할 수 없습니다.
<ul>
<li>inset or update 시 payload에 relationId가 아닌 relation으로 사용해야 합니다.</li>
<li>관련 이슈 : <a href="https://github.com/typeorm/typeorm/issues/3867">https://github.com/typeorm/typeorm/issues/3867</a></li>
<li>@RelationId를 사용하는 대신 @Column으로 relationId를 장식 할 수 있습니다. JoinColumn의 이름이 숫자열 이름과 같을 때 TypeORM이 둘 다 일치하고 userId를 설정하거나 사용자를 설정하면 TypeORM이 처리합니다.</li>
</ul>
</li>
</ul>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token comment">// using many to one</span>
</span><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Post</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">ManyToOne</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token operator">=></span> Category<span class="token punctuation">)</span>
</span><span class="code-line">  category<span class="token operator">:</span> Category<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">RelationId</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>post<span class="token operator">:</span> Post<span class="token punctuation">)</span> <span class="token operator">=></span> post<span class="token punctuation">.</span>category<span class="token punctuation">)</span>
</span><span class="code-line">  categoryId<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// using many to many</span>
</span><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Post</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">ManyToMany</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token operator">=></span> Category<span class="token punctuation">)</span>
</span><span class="code-line">  categories<span class="token operator">:</span> Category<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">RelationId</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>post<span class="token operator">:</span> Post<span class="token punctuation">)</span> <span class="token operator">=></span> post<span class="token punctuation">.</span>categories<span class="token punctuation">)</span>
</span><span class="code-line">  categoryIds<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<h3 id="subscriber">Subscriber<a aria-hidden="true" tabindex="-1" href="#subscriber"><span class="anchor"></span></a></h3>
<ul>
<li>데이터베이스에 특화된 리스너로 CRUD 이벤트 발생을 리슨합니다.</li>
<li>다음과 같은 데코레이터들을 가지고 있습니다.
<ul>
<li>@AfterLoad, @AfterInsert, @BeforeInsert, @AfterUpdate, @BeforeUpdate, @AfterRemove, @BeforeRemove</li>
</ul>
</li>
<li>logging 옵션이 있긴 하지만 쿼리만을 보여주기 때문에 한 줄씩 분석하기 위해 로그를 남기는 경우에는 지양하는 것이 좋습니다.</li>
</ul>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token keyword">import</span> <span class="token punctuation">{</span>
</span><span class="code-line">  Connection<span class="token punctuation">,</span>
</span><span class="code-line">  EntitySubscriberInterface<span class="token punctuation">,</span>
</span><span class="code-line">  EventSubscriber<span class="token punctuation">,</span>
</span><span class="code-line">  InsertEvent<span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm/index'</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> User <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./User'</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">EventSubscriber</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserSubscriber</span> <span class="token keyword">implements</span> <span class="token class-name">EntitySubscriberInterface<span class="token operator">&#x3C;</span>User<span class="token operator">></span></span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token function">constructor</span><span class="token punctuation">(</span>connection<span class="token operator">:</span> Connection<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    connection<span class="token punctuation">.</span>subscribers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line">  <span class="token function">listenTo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">return</span> User<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line">  <span class="token function">beforeInsert</span><span class="token punctuation">(</span>event<span class="token operator">:</span> InsertEvent<span class="token operator">&#x3C;</span>User<span class="token operator">></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&#x3C;</span><span class="token builtin">any</span><span class="token operator">></span> <span class="token operator">|</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'User 테이블에 입력 전 : '</span><span class="token punctuation">,</span> event<span class="token punctuation">.</span>entity<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line">  <span class="token function">afterInsert</span><span class="token punctuation">(</span>event<span class="token operator">:</span> InsertEvent<span class="token operator">&#x3C;</span>User<span class="token operator">></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&#x3C;</span><span class="token builtin">any</span><span class="token operator">></span> <span class="token operator">|</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'User 테이블에 입력 후 : '</span><span class="token punctuation">,</span> event<span class="token punctuation">.</span>entity<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<h3 id="index">Index<a aria-hidden="true" tabindex="-1" href="#index"><span class="anchor"></span></a></h3>
<ul>
<li>테이블 <code class="inline-code">쿼리 속도</code>를 올려주는 자료구조입니다.</li>
<li>테이블 내 1개 혹은 그 이상의 칼럼을 이용해 생성할 수 있습니다.</li>
<li>인덱스는 보통 키-필드만 갖고있고, 테이블의 다른 세부항목을 갖지 않기때문에 보통 테이블을 저장하는 공간보다 더 <code class="inline-code">적은 공간</code>을 차지합니다.</li>
<li>특정 칼럼 값을 가지고 있는 열이나 값을 <code class="inline-code">빠르게 찾기</code> 위해 사용합니다.
<ul>
<li>인덱싱하지 않은 경우는 첫번째 열부터 전체 테이블을 걸쳐 연관된 열을 검색하기때문에 테이블이 클수록 쿼리비용이 커집니다.</li>
<li>인덱싱을 한 경우는 모든 데이터를 조회하지 않고 데이터 파일의 중간에서 검색위치를 빠르게 잡을 수 있습니다.</li>
</ul>
</li>
<li><code class="inline-code">WHERE</code>절과 일치하는 열을 빨리 찾기 위해서 사용합니다.</li>
<li><code class="inline-code">JOIN</code>을 실행할 때 다른 테이블에서 열을 추출하기 위해서 사용합니다.</li>
<li>데이터 양이 많고 변경보다 <code class="inline-code">검색이 빈번한 경우</code> 인덱싱을 하면 좋습니다.</li>
</ul>
<blockquote>
<p>쉽게 말해 책에서 transaction이란 주제가 어딨는지 목차 없이 찾으려면 눈물날지도 모릅니다. 책의 주요내용을 가나다순으로 정리한 목록이 있으면 찾기 쉬울텐데 인덱스가 바로 그 역할을 합니다.
특정 칼럼에 인덱스를 걸 수 있습니다. 옵션으로 고유키를 부여할 수도 있습니다. 단일 칼럼에 인덱스를 걸고 싶으면 칼럼마다 추가할 수도 있지만, 테이블 전체에 인덱스를 걸고싶은 경우 @Entity()아래 @Index()를 추가할 수도 있습니다.</p>
</blockquote>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token comment">// using with single column</span>
</span><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Index</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  firstName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Index</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> unique<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  lastName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// using with entity</span>
</span><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Index</span></span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'firstName'</span><span class="token punctuation">,</span> <span class="token string">'lastName'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> unique<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  firstName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  lastName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<h3 id="unique">Unique<a aria-hidden="true" tabindex="-1" href="#unique"><span class="anchor"></span></a></h3>
<ul>
<li>특정 칼럼에 고유키 제약조건을 생성할 수 있습니다.</li>
<li>@Unique()는 테이블 자체에만 적용하는 것이 가능합니다.</li>
</ul>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Unique</span></span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'firstName'</span><span class="token punctuation">,</span> <span class="token string">'lastName'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  firstName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  lastName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<h3 id="check">Check<a aria-hidden="true" tabindex="-1" href="#check"><span class="anchor"></span></a></h3>
<ul>
<li>테이블에서 데이터 추가 쿼리가 날아오면 값을 체크하는 역할을 합니다.</li>
</ul>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Entity</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Check</span></span><span class="token punctuation">(</span><span class="token string">'"age" > 18'</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  firstName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  firstName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Column</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<h3 id="transaction">Transaction<a aria-hidden="true" tabindex="-1" href="#transaction"><span class="anchor"></span></a></h3>
<ul>
<li>데이터베이스 내에서 하나의 <code class="inline-code">그룹으로 처리해야하는 명령문</code>을 모아서 처리하는 작업의 단위를 말합니다.
<ul>
<li>여러 단계의 처리를 <code class="inline-code">하나의 처리처럼</code> 다루는 기능입니다.</li>
<li>여러 개의 명령어의 집합이 정상적으로 처리되면 정상종료됩니다.</li>
<li>하나의 명령어라도 <code class="inline-code">잘못되면 전체 취소</code>됩니다.</li>
</ul>
</li>
<li>트랜잭션을 쓰는 이유는 <code class="inline-code">데이터의 일관성</code>을 유지하면서 <code class="inline-code">안정적으로 데이터를 복구</code>하기 위함입니다.</li>
<li>격리성 수준 설정을 통해 트랜잭션이 열려있는 동안 외부에서 해당 데이터에 접근하지 못하도록 락을 걸 수 있습니다.</li>
</ul>
<h4 id="격리성-수준">격리성 수준<a aria-hidden="true" tabindex="-1" href="#격리성-수준"><span class="anchor"></span></a></h4>
<ul>
<li>READ UNCOMMITTED</li>
<li>READ COMMITTED</li>
<li>REPEATABLE READ</li>
<li>SERIALIZABLE</li>
</ul>
<h4 id="global-connection을-열어서-트랜젝션을-사용하는-경우는-아래와-같이-사용합니다">global connection을 열어서 트랜젝션을 사용하는 경우는 아래와 같이 사용합니다.<a aria-hidden="true" tabindex="-1" href="#global-connection을-열어서-트랜젝션을-사용하는-경우는-아래와-같이-사용합니다"><span class="anchor"></span></a></h4>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token keyword">await</span> <span class="token function">getManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">transaction</span><span class="token punctuation">(</span>
</span><span class="code-line">  <span class="token string">'SERIALIZABLE'</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token punctuation">(</span>transactionalEntityManager<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<h4 id="하지만-global-connection은-사이드이펙트가-많은-방법이기때문에-데코레이터나-queryrunner를-사용한-방법을-추천합니다">하지만 global connection은 사이드이펙트가 많은 방법이기때문에 데코레이터나 queryRunner를 사용한 방법을 추천합니다.<a aria-hidden="true" tabindex="-1" href="#하지만-global-connection은-사이드이펙트가-많은-방법이기때문에-데코레이터나-queryrunner를-사용한-방법을-추천합니다"><span class="anchor"></span></a></h4>
<ul>
<li>아래는 데코레이터 @Transaction(), @TransactionManager(), @TransactionRepository()를 사용한 패턴입니다.</li>
</ul>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token comment">// using transaction manager</span>
</span><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Transaction</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> isolation<span class="token operator">:</span> <span class="token string">'SERIALIZABLE'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token function">save</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">TransactionManager</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> manager<span class="token operator">:</span> EntityManager<span class="token punctuation">,</span> user<span class="token operator">:</span> User<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">return</span> manager<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// using transaction repository</span>
</span><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Transaction</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> isolation<span class="token operator">:</span> <span class="token string">'SERIALIZABLE'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token function">save</span><span class="token punctuation">(</span>user<span class="token operator">:</span> User<span class="token punctuation">,</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">TransactionRepository</span></span><span class="token punctuation">(</span>User<span class="token punctuation">)</span> userRepository<span class="token operator">:</span> Repository<span class="token operator">&#x3C;</span>User<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">return</span> userRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<h4 id="아래는-queryrunner를-사용한-방법입니다-다만-이-방법에서는-격리성-수준-설정이-불가능합니다">아래는 queryRunner를 사용한 방법입니다. 다만 이 방법에서는 격리성 수준 설정이 불가능합니다.<a aria-hidden="true" tabindex="-1" href="#아래는-queryrunner를-사용한-방법입니다-다만-이-방법에서는-격리성-수준-설정이-불가능합니다"><span class="anchor"></span></a></h4>
<ul>
<li>startTransaction은 트랜잭션을 시작하는 메서드</li>
<li>commitTransaction는 모든 변경사항을 커밋하는 메서드</li>
<li>rollbackTransaction는 모든 변경사항을 되돌리는 메서드</li>
</ul>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token keyword">await</span> queryRunner<span class="token punctuation">.</span><span class="token function">startTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">try</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">await</span> queryRunner<span class="token punctuation">.</span>manager<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">await</span> queryRunner<span class="token punctuation">.</span>manager<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>photos<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">await</span> queryRunner<span class="token punctuation">.</span><span class="token function">commitTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">await</span> queryRunner<span class="token punctuation">.</span><span class="token function">rollbackTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">await</span> queryRunner<span class="token punctuation">.</span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<h3 id="eager-and-lazy-relations">Eager and Lazy Relations<a aria-hidden="true" tabindex="-1" href="#eager-and-lazy-relations"><span class="anchor"></span></a></h3>
<h4 id="eager">eager<a aria-hidden="true" tabindex="-1" href="#eager"><span class="anchor"></span></a></h4>
<ul>
<li>relationship을 설정하지 않아도 eager를 설정하면 자동으로 relationship을 불러옵니다.
<ul>
<li>find* (즉, find, findAll, findOne...)에서 자동으로 relationship을 불러옵니다.</li>
</ul>
</li>
</ul>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">ManyToMany</span></span><span class="token punctuation">(</span>type <span class="token operator">=></span> Category<span class="token punctuation">,</span> category <span class="token operator">=></span> category<span class="token punctuation">.</span>questions<span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line">  eager<span class="token operator">:</span> <span class="token boolean">true</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></code></pre>
<h4 id="lazy">lazy<a aria-hidden="true" tabindex="-1" href="#lazy"><span class="anchor"></span></a></h4>
<ul>
<li>Promise로 반환하면, 자동으로 lazy relationship이 됩니다.
<ul>
<li>lazy를 불러올 때는 Promise.resolve를 하던가, await로 불러오면 됩니다.</li>
</ul>
</li>
</ul>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">ManyToMany</span></span><span class="token punctuation">(</span>type <span class="token operator">=></span> Question<span class="token punctuation">,</span> question <span class="token operator">=></span> question<span class="token punctuation">.</span>categories<span class="token punctuation">)</span>
</span><span class="code-line">questions<span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&#x3C;</span>Question<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">;</span>
</span></code></pre>
<pre class="language-ts optimized-code-block" style="max-height: 600px; overflow-y: auto;"><code class="language-ts code-highlight"><span class="code-line"><span class="token keyword">const</span> question <span class="token operator">=</span> <span class="token keyword">await</span> connection<span class="token punctuation">.</span><span class="token function">getRepository</span><span class="token punctuation">(</span>Question<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> categories <span class="token operator">=</span> <span class="token keyword">await</span> question<span class="token punctuation">.</span>categories<span class="token punctuation">;</span>
</span></code></pre>
<ul>
<li>참고 : 다른 언어 (자바, PHP 등)에서 왔고 모든 곳에서 게으른 관계를 사용하는 데 익숙하다면 조심하세요. 이러한 언어는 비동기식이 아니며 지연로드는 다른 방식으로 이루어집니다. 그렇기 때문에 거기에서 promise를 사용하지 않습니다. 자바 스크립트와 Node.JS에서 지연로드 된 관계를 원하면 promise를 사용해야합니다. 이것은 비표준 기술이며 TypeORM에서 실험적인 것으로 간주됩니다.</li>
</ul>
<h2 id="typeorm의-bigint">typeorm의 bigint<a aria-hidden="true" tabindex="-1" href="#typeorm의-bigint"><span class="anchor"></span></a></h2>
<ul>
<li>typeorm bigint는 number로 바꿔주지 않습니다. string입니다.
<ul>
<li><a href="https://typeorm.io/entities#column-types">Note about bigint type: bigint column type, used in SQL databases, doesn’t fit into the regular number type and maps property to a string instead.</a></li>
</ul>
</li>
</ul>
<hr>
<h2 id="참고">참고<a aria-hidden="true" tabindex="-1" href="#참고"><span class="anchor"></span></a></h2>
<ul>
<li><a href="https://velog.io/@josworks27/typeORM-%EC%8B%9C%EC%9E%91%ED%95%98%EA%B8%B0">TypeORM 시작하기</a></li>
<li><a href="https://yangeok.github.io/orm/2020/12/14/typeorm-decorators.html">TypeORM 데코레이터 씹어먹기</a></li>
<li><a href="https://gkqlgkql.tistory.com/85">개발자 마르코</a></li>
</ul></div></div></div><div class="flex flex-col gap-5 my-10 max-w-4xl mx-auto px-4 xl:pr-[220px]"><div class="sponsor-button"><a class="flex items-center justify-center gap-3 px-6 py-3.5 bg-gradient-to-r from-amber-400 via-amber-500 to-amber-600 hover:from-amber-500 hover:via-amber-600 hover:to-amber-700 active:from-amber-600 active:via-amber-700 active:to-amber-800 text-white rounded-2xl transition-all duration-300 cursor-pointer border-0 shadow-lg hover:shadow-xl hover:scale-[1.02] active:scale-[0.98] font-semibold text-base no-underline" target="_blank" rel="noopener noreferrer" href="https://www.buymeacoffee.com/yuniq"><img src="https://www.buymeacoffee.com/assets/img/BMC-btn-logo.svg" alt="Buy me a coffee" class="w-7 h-7 flex-shrink-0"/><span>Buy me a coffee</span></a></div></div><div class="max-w-4xl mx-auto px-4 xl:pr-[220px]"><ins class="kakao_ad_area block" data-ad-unit="DAN-kkYIHzVbuDz3kYsq" data-ad-width="320" data-ad-height="50" style="width:320px;height:50px"></ins></div><div class="max-w-4xl mx-auto px-4 xl:pr-[220px]"><hr class="custom-hr"/></div><div class="my-8 max-w-4xl mx-auto px-4 xl:pr-[220px]"><div class="bio-container"><div class="author-description flex"><img class="bio-author-image" src="/images/profile.png" alt="yuni-q" width="72"/><div><span class="author-name-prefix text-[90%] mr-1">Written by</span><a class="author-name-content" href="/about/"><span>@<!-- -->yuni-q</span></a><div class="author-introduction mt-1 text-[80%] leading-[1.4]">yuni-q&#x27;s graffiti.</div><p class="author-socials mt-[-4px]"><a href="https://github.com/Yuni-Q" class="mr-2 text-[80%]">GitHub</a></p></div></div></div></div><div class="max-w-4xl mx-auto px-4 xl:pr-[220px]"><nav class="navigator my-8"><ul class="flex flex-col gap-4"><li><a rel="prev" class="block p-4 rounded-xl border border-gray-200 dark:border-gray-700 hover:border-blue-400 dark:hover:border-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-all duration-200 group" href="/design-pattern/builder-pattern/"><div class="text-xs text-gray-500 dark:text-gray-400 mb-1 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors">이전 글</div><div class="text-sm font-medium text-gray-900 dark:text-gray-100 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors">← <!-- -->builder pattern</div></a></li><li><a rel="next" class="block p-4 rounded-xl border border-gray-200 dark:border-gray-700 hover:border-blue-400 dark:hover:border-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-all duration-200 group text-right" href="/design-pattern/visitor-pattern/"><div class="text-xs text-gray-500 dark:text-gray-400 mb-1 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors">다음 글</div><div class="text-sm font-medium text-gray-900 dark:text-gray-100 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors">visitor pattern<!-- --> →</div></a></li></ul></nav></div><div class="max-w-4xl mx-auto px-4 xl:pr-[220px]"><div class="utterences"></div></div><footer class="pt-[52px] text-center text-xs">©<a href="https://github.com/Yuni-Q" class="no-underline">yuni-q</a>, Built with<!-- --> <a href="https://nextjs.org" class="no-underline">Next.js</a></footer></div><script src="/_next/static/chunks/webpack-57fdca2934e5ae0a.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/bc8bb31cb71603b2.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"2:I[1633,[],\"\"]\n5:I[808,[],\"\"]\n7:I[6217,[],\"\"]\n8:I[5217,[\"3185\",\"static/chunks/app/layout-3ad8bb7cb2292578.js\"],\"ServiceWorkerCleanup\"]\n9:I[6484,[\"3185\",\"static/chunks/app/layout-3ad8bb7cb2292578.js\"],\"ThemeProvider\"]\nb:I[7768,[],\"\"]\n6:[\"slug\",\"backend/typeorm-%ED%86%BA%EC%95%84%EB%B3%B4%EA%B8%B0\",\"c\"]\nc:[]\n"])</script><script>self.__next_f.push([1,"0:[\"$\",\"$L2\",null,{\"buildId\":\"static-build-id\",\"assetPrefix\":\"\",\"urlParts\":[\"\",\"blog\",\"backend\",\"typeorm-%ED%86%BA%EC%95%84%EB%B3%B4%EA%B8%B0\",\"\"],\"initialTree\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"backend/typeorm-%ED%86%BA%EC%95%84%EB%B3%B4%EA%B8%B0\",\"c\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":[\\\"backend\\\",\\\"typeorm-톺아보기\\\"]}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"backend/typeorm-%ED%86%BA%EC%95%84%EB%B3%B4%EA%B8%B0\",\"c\"],{\"children\":[\"__PAGE__\",{},[[\"$L3\",\"$L4\",null],null],null]},[null,[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",\"$6\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L7\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]],null]},[null,[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L7\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]],null]},[[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/bc8bb31cb71603b2.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"ko\",\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"rel\":\"preconnect\",\"href\":\"https://fonts.googleapis.com\"}],[\"$\",\"link\",null,{\"rel\":\"preconnect\",\"href\":\"https://fonts.gstatic.com\",\"crossOrigin\":\"anonymous\"}],[\"$\",\"link\",null,{\"href\":\"https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700\u0026display=swap\",\"rel\":\"stylesheet\"}],[\"$\",\"link\",null,{\"href\":\"https://fonts.googleapis.com/css2?family=Catamaran:wght@800\u0026display=swap\",\"rel\":\"stylesheet\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"type\":\"image/png\",\"href\":\"/favicon2.png\"}],[\"$\",\"link\",null,{\"rel\":\"shortcut icon\",\"href\":\"/favicon2.png\"}],[\"$\",\"link\",null,{\"rel\":\"apple-touch-icon\",\"href\":\"/favicon2.png\"}],[\"$\",\"script\",null,{\"id\":\"ads\",\"async\":true,\"src\":\"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js\"}],[\"$\",\"script\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"(adsbygoogle=window.adsbygoogle||[]).requestNonPersonalizedAds=1;\"}}]]}],[\"$\",\"body\",null,{\"children\":[[\"$\",\"noscript\",null,{\"children\":\"You need to enable JavaScript to run this app.\"}],[\"$\",\"$L8\",null,{}],[\"$\",\"$L9\",null,{\"children\":[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L7\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[]}]}]]}]]}]],null],null],\"couldBeIntercepted\":false,\"initialHead\":[null,\"$La\"],\"globalErrorComponent\":\"$b\",\"missingSlots\":\"$Wc\"}]\n"])</script><script>self.__next_f.push([1,"d:I[5553,[\"9243\",\"static/chunks/9243-972bdccd4ceb11ae.js\",\"5800\",\"static/chunks/5800-4312aed1aa8a4305.js\",\"549\",\"static/chunks/549-2babc012700e23ed.js\",\"4853\",\"static/chunks/4853-73ca7990eb89674b.js\",\"6797\",\"static/chunks/app/blog/%5B...slug%5D/page-9b274a2e0073d544.js\"],\"BlogPostPageClient\"]\ne:T8785,"])</script><script>self.__next_f.push([1,"\n- Node와 RDB의 ORM 서비스는 sequelize, typeorm, prisma 등 많은 라이브러리들이 있습니다.\n- 가장 먼저 사용한 ORM 서비스는 sequelize 였지만 typeorm이 typescript 지원이나 시장의 흐름에 따라 조금 더 많이 사용된다고 생각되어 공부하게 되었습니다.\n\n  - prisma도 고려해 보았으나 아직은 시기상조인 것 같았습니다.\n\n## typeorm에 대해 알아보기 전에 ORM이 무엇인지 알아보겠습니다.\n\n- ORM(Object-relational mapping)은 객체지향 프로그래밍(Object-Oriented-Programming)과 관계형 데이터베이스(Relational-Database)사이의 호환되지 않는 `데이터를 변환하는 시스템`입니다.\n  - 객체와 테이블 시스템(RDBMS)을 변형 및 연결해주는 작업입니다.\n- ORM을 이용한 개발은 객체와 데이터베이스의 변형에 유연하게 대처할 수 있습니다.\n- ORM을 객체 지향 프로그래밍 관점에서 생각해보면, 관계형 데이터베이스에 제약을 최대한 받지 않으면서, 객체를 클래스로 표현하는 것과 같이 관계형 데이터베이스를 객체처럼 쉽게 표현합니다.\n  - 객체지향 프로그래밍은 Class를 사용하고 관계형 데이터베이스는 Table을 사용합니다.\n\n## 바로 본론으로 들어가서 typeorm을 프로젝트에서 어떻게 도입할지 알아보겠습니다.\n\n- 의존성 설치 및 init\n\n```zsh\nnpm install typeorm reflect-metadata @types/node mysql\ntypeorm init --name [프로젝트이름] --database [데이터베이스]\n```\n\n- global place 의 app.ts에 import 추가합니다.\n  - reflect-metadata 패키지를 사용하면 유형에 대한 런타임 반영을 수행 할 수 있습니다. TypeORM은 대부분 데코레이터 (@Entity 또는 @Column)와 함께 작동하므로이 패키지는 이러한 데코레이터를 구문 분석하고 SQL 쿼리를 작성하는 데 사용합니다.\n\n```ts\nimport 'reflect-metadata';\n```\n\n### 노드 모듈(typeorm-model-generator) 이용해 모델 자동 생성하는 방법도 있습니다.\n\n- 각 옵션을 수동으로 입력\n\n```zsh\ntypeorm-model-generator\n```\n\n- 커맨드 한 번에 생성\n\n```zsh\ntypeorm-model-generator -h localhost -u $userName -x $password -e mysql -o ./entities --ssl\n```\n\n## typeorm 작성 패턴에 대해 알아보겠습니다.\n\n- Active Record 패턴과 Data Mapper 패턴이 있습니다.\n\n## Active Record 패턴에 대해 먼저 알아보겠습니다.\n\n- Active Record 패턴은 `모델 그 자체에 쿼리 메소드를 정의`하고, `모델의 메소드를 사용`하여 객체를 저장, 제거, 불러오는 방식입니다.\n- BaseEntity라는 클래스를 사용하여 새로운 클래스에 상속하게 한 후 사용할 수 있습니다. 이를 통해 BaseEntity가 갖고 있는 메소드와 static으로 만들어 내는 커스텀 메소드를 이용할 수 있습니다.\n- 규모가 작은 애플리케이션에서 적합하고 간단히 사용할 수 있습니다.\n\n```ts\nimport { BaseEntity, Entity, PrimaryGeneratedColumn, Column } from 'typeorm';\n\n@Entity()\nexport class User extends BaseEntity {\n  @PrimaryGeneratedColumn()\n  id: number;\n\n  @Column()\n  firstName: string;\n\n  @Column()\n  lastName: string;\n\n  @Column()\n  isActive: boolean;\n\n  static findByName(firstName: string, lastName: string) {\n    return this.createQueryBuilder('user')\n      .where('user.firstName = :firstName', { firstName })\n      .andWhere('user.lastName = :lastName', { lastName })\n      .getMany();\n  }\n}\n```\n\n```ts\n// example how to save AR entity\nconst user = new User();\nuser.firstName = 'Timber';\nuser.lastName = 'Saw';\nuser.isActive = true;\nawait user.save();\n\n// example how to remove AR entity\nawait user.remove();\n\n// example how to load AR entities\nconst users = await User.find({ skip: 2, take: 5 });\nconst newUsers = await User.find({ isActive: true });\nconst timber = await User.findOne({ firstName: 'Timber', lastName: 'Saw' });\nconst timber = await User.findByName('Timber', 'Saw');\n```\n\n## Data Mapper 패턴에 대해서도 알아보겠습니다.\n\n- Data Mapper 패턴은 `분리된 클래스에 쿼리 메소드를 정의`하는 방식이며, `Repository를 이용`하여 객체를 저장, 제거, 불러옵니다.\n- Active Record 패턴과의 차이점은 모델에 접근하는 방식이 아닌 `Repository에서 데이터에 접근`한다는 것입니다.\n- 규모가 큰 애플리케이션에 적합하고 유지보수하는데 효과적이다.\n\n```ts\nimport { Entity, PrimaryGeneratedColumn, Column } from 'typeorm';\n\n@Entity()\nexport class User {\n  @PrimaryGeneratedColumn()\n  id: number;\n\n  @Column()\n  firstName: string;\n\n  @Column()\n  lastName: string;\n\n  @Column()\n  isActive: boolean;\n}\n```\n\n```ts\nimport { EntityRepository, Repository } from 'typeorm';\nimport { User } from '../entity/User';\n\n@EntityRepository()\nexport class UserRepository extends Repository\u003cUser\u003e {\n  findByName(firstName: string, lastName: string) {\n    return this.createQueryBuilder('user')\n      .where('user.firstName = :firstName', { firstName })\n      .andWhere('user.lastName = :lastName', { lastName })\n      .getMany();\n  }\n}\n```\n\n```ts\nconst userRepository = connection.getRepository(User);\n\n// example how to save DM entity\nconst user = new User();\nuser.firstName = 'Timber';\nuser.lastName = 'Saw';\nuser.isActive = true;\nawait userRepository.save(user);\n\n// example how to remove DM entity\nawait userRepository.remove(user);\n\n// example how to load DM entities\nconst users = await userRepository.find({ skip: 2, take: 5 });\nconst newUsers = await userRepository.find({ isActive: true });\nconst timber = await userRepository.findOne({\n  firstName: 'Timber',\n  lastName: 'Saw',\n});\n```\n\n## entity들을 만들었다면 데이터베이스에 대한 연결 생성하는 법을 알아 보겠습니다.\n\n```ts\nimport 'reflect-metadata';\nimport { createConnection } from 'typeorm';\nimport { Photo } from './entity/Photo';\n\ncreateConnection({\n  type: 'mysql',\n  host: 'localhost',\n  port: 3306,\n  username: 'root',\n  password: 'admin',\n  database: 'test',\n  entities: [\n    Photo,\n    // __dirname + '/entity/*.js'\n  ],\n  synchronize: true,\n  logging: false,\n})\n  .then((connection) =\u003e {\n    // here you can start to work with your entities\n  })\n  .catch((error) =\u003e console.log(error));\n```\n\n## Entity를 만드는 방법에 대해 조금 더 상세히 알아보겠습니다.\n\n### Entity 데코레이터\n\n- 데이터베이스 테이블을 정의하기 전에 실행해야하는 데코레이터입니다.\n- 테이블명을 따로 지정하지 않아도 클래스명으로 매핑하지만, 옵션으로 테이블명을 지정할 수 있습니다.\n\n```ts\n@Entity('users')\nexport class User {}\n```\n\n- name: `테이블 이름`입니다. 지정하지 않으면 테이블 이름은 엔티티 `클래스명`으로 생성됩니다.\n- database: 선택된 DB서버의 데이터베이스 이름입니다.\n- schema: 스키마 이름입니다.\n  - MySQL에서는 schema와 database가 따로 분리되어있지 않습니다. OracleDB에서는 schema를 따로 분리해서 database에 할당된 사용자로 사용합니다.\n- engine: 테이블 생성 중에 설정할 수 있는 DB엔진 이름입니다.\n- synchronize: false로 설정할 시 스키마 싱크를 건너뜁니다.\n- orderBy: QueryBuilder과 find를 실행할 때 엔티티의 기본순서를 지정합니다.\n\n```ts\n@Entity({\n  name: 'users',\n  engine: 'MyISAM',\n  database: 'example_dev',\n  schema: 'schema_with_best_tables',\n  synchronize: false,\n  orderBy: {\n    name: 'ASC',\n    id: 'DESC',\n  },\n})\nexport class User {}\n```\n\n### 중복되는 Entity를 상속를 사용하여 해결할 수 있습니다.\n\n- Concrete table inheritance와 Single table inheritance가 있습니다.\n\n#### Concrete table inheritance\n\n- 중복된 칼럼을 베이스가 되는 `추상 클래스`를 선언한 다음 확장할 수 있습니다.\n- 참고로 active record 패턴을 사용할 예정이라면, `BaseEntity`라는 이름은 피하는게 좋습니다.\n  - typeorm에서 제공하는 클래스인 BaseEntity는 기본 쿼리 메서드 hasId, save, remove 등의 메서드를 담은 클래스입니다.\n\n```ts\n// 추상 클래스\nexport abstract class Content {\n  @PrimaryGeneratedColumn()\n  id: number;\n\n  @Column()\n  title: string;\n\n  @Column()\n  description: string;\n}\n\n// 1\n@Entity()\nexport class Photo extends Content {\n  @Column()\n  size: string;\n}\n\n// 2\n@Entity()\nexport class Question extends Content {\n  @Column()\n  answersCount: number;\n}\n\n// 3\n@Entity()\nexport class Post extends Content {\n  @Column()\n  viewCount: number;\n}\n```\n\n#### Single table inheritance\n\n- @TableInheritance(), @ChildEntity()를 사용하는 방법입니다.\n- 이 방법은 데이터베이스에 Content 테이블이 생성됩니다. `Content 위에 @Entity()를 선언`해줘야 아래와 같은 패턴을 사용할 수 있습니다.\n\n```ts\n@Entity()\n@TableInheritance({ column: { type: 'varchar', name: 'type' } })\nexport class Content {\n  @PrimaryGeneratedColumn()\n  id: number;\n\n  @Column()\n  title: string;\n\n  @Column()\n  description: string;\n}\n\n@ChildEntity()\nexport class Photo extends Content {\n  @Column()\n  size: string;\n}\n\n@ChildEntity()\nexport class Question extends Content {\n  @Column()\n  answersCount: number;\n}\n\n@ChildEntity()\nexport class Post extends Content {\n  @Column()\n  viewCount: number;\n}\n```\n\n### Embedded entities\n\n- 이름이 비슷하고 타입이 같은 칼럼들을 묶는 패턴입니다.\n- User.name은 User.nameFirst, User.nameLast로 분기합니다. Name은 데코레이터 @Entity()가 붙어있지 않기때문에 위의 패턴처럼 `실제 테이블이 생겨나지는 않습니다`.\n\n```ts\nexport class Name {\n  @Column()\n  first: string;\n\n  @Column()\n  last: string;\n}\n\n@Entity()\nexport class User {\n  @PrimaryGeneratedColumn()\n  id: string;\n\n  @Column((type) =\u003e Name)\n  name: Name;\n\n  @Column()\n  isActive: boolean;\n}\n```\n\n### ViewEntity\n\n#### SQL view란 ?\n\n- view는 하나의 `가상 테이블`입니다.\n- 실제 데이터가 저장되는 것은 아니지만, view를 통해 데이터를 가상 테이블로 관리가 가능합니다.\n- 1개의 view로 여러 테이블의 데이터를 조회할 수 있습니다.\n- 복잡한 쿼리를 통해 얻을 수 있는 결과를 간단한 쿼리로 얻을 수 있게 도와줍니다.\n- 특정 기준에 따른 사용자 별로 다른 데이터를 액세스할 수 있도록 도와줄 수도 있습니다.\n- 조회 대상을 줄이고 싶을 때 사용할 수 있습니다.\n\n#### ViewEntity 데코레이터 인자\n\n- 데코레이터에 들어가는 인자가 아래와 같이 @Entity()와는 약간 다릅니다.\n  - name: 테이블 이름입니다. 지정하지 않으면 테이블 이름은 엔티티 클래스명으로 생성됩니다.\n  - database: 선택된 DB서버의 데이터베이스 이름입니다.\n  - schema: 스키머 이름입니다.\n  - expression: view를 정의합니다. 꼭 있어야하는 파라미터로 SQL쿼리문이나 queryBuilder 체이닝 메서드가 들어갈 수 있습니다.\n- expression은 SQL 쿼리문이나 QueryBuilder에 체이닝할 수 있는 메서드가 들어갈 수 있습니다. 특이점으로는 필드명 위에 들어가는 데코레이터를 id까지 전부 @ViewColumn()을 사용해야 한다는 점이 있습니다. 만약 사용을 고려한다면, JOIN을 쳐서 테이블끼리 연결을 시키냐, 아니면 view를 통해 나중에 자주 사용할 가상 테이블을 미리 만들어두냐의 차이로 생각할 수 있습니다.\n\n```ts\n@ViewEntity({\n  expression: `\n        SELECT \"post\".\"id\" AS \"id\", \"post\".\"name\" AS \"name\", \"category\".\"name\" AS \"categoryName\"\n        FROM \"post\" \"post\"\n        LEFT JOIN \"category\" \"category\" ON \"post\".\"categoryId\" = \"category\".\"id\"\n    `,\n})\nexport class PostCategory {\n  @ViewColumn()\n  id: number;\n\n  @ViewColumn()\n  name: string;\n\n  @ViewColumn()\n  categoryName: string;\n}\n```\n\n- 구조가 복잡하고, 여러군데서 호출하는 데이터의 경우 미리 ViewEntity로 view 테이블을 만들어두면 유용합니다.\n\n### Column\n\n- entity의 속성을 테이블 칼럼으로 표시합니다.\n\n```ts\n@Entity()\nexport class User {\n  @PrimaryGeneratedColumn()\n  id: number;\n\n  @Column({ tpye: 'varchar', length: 200, unique: true })\n  firstName: string;\n\n  @Column({ nullable: true })\n  lastName: string;\n\n  @Column({ default: false })\n  isActive: boolean;\n}\n```\n\n- @Column()에 들어갈 수 있는 옵션들 중 중요하다고 판단한 것들은 아래와 같습니다.\n\n  - type(ColumnType) : `javascript의 원시타입`들을 세분화해서 사용할 수 있습니다. 타입을 정의하는 방법은 다음과 같습니다.\n  - length(string | number) : javascript의 원시타입들을 세분화해서 사용하기 위해 type 옵션과 같이 사용할 수 있습니다.\n  - onUpdate(string) : cascading을 하기 위한 옵션으로 ON UPDATE 트리거입니다.\n  - nullable(boolean) : 칼럼을 NULL이나 NOT NULL로 만드는 옵션입니다. 기본값은 false입니다.\n  - default(string) : 칼럼에 DEFAULT 값을 설정합니다.\n  - unique(boolean) : 유니크 칼럼이라고 표시할 수 있습니다. 유니크 constraint를 만듭니다. 기본값은 false 입니다.\n  - enum(string[] | AnyEnum) : 칼럼의 값으로 enum을 사용할 수 있습니다. enum은 db단에서 처리할 수도, orm단에서 처리할 수도 있습니다.\n  - enumName(string) : 다른 테이블에서 같은 enum을 사용하는 경우 필요합니다.\n  - transformer({ from(value: DatabaseType): EntityType, to(value: EntityType): DatabaseType }) : 아래와 같은 코드를 만들어내서 json을 문자열로 만들고 파싱하는 역할을 합니다. 또는 boolean을 integer로 바꿔주는 일도 할 수 있습니다.\n\n  ```ts\n  import { ValueTransformer } from 'typeorm';\n\n  class SomeTransformer implements ValueTransformer {\n    to(value: Map\u003cstring, number\u003e): string {\n      return JSON.stringify([...value]);\n    }\n    from(value: string): Map\u003cstring, number\u003e {\n      return new Map(JSON.parse(value));\n    }\n  }\n  ```\n\n### IdColumn\n\n- PrimaryColumn과 PrimaryGeneratedColum이 있습니다.\n\n#### PrimaryColumn\n\n- @Column()의 옵션인 primary를 대체할 수 있습니다. `PK`를 만드는 역할을 합니다.\n\n#### PrimaryGeneratedColumn\n\n- `자동생성`되는 ID값을 표현하는 방식을 아래와 같이 2가지 옵션을 사용할 수 있도록 도와줍니다.\n  - increment: AUTO_INCREMENT를 사용해서 1씩 증가하는 ID를 부여합니다. 기본 옵션입니다.\n  - uuid: 유니크한 uuid를 사용할 수 있습니다.\n\n```ts\n// using increment\n@Entity()\nexport class User {\n  @PrimaryGeneratedColumn()\n  id: number;\n}\n\n// using uuid\n@Entity()\nexport class User {\n  @PrimaryGeneratedColumn('uuid')\n  id: string;\n}\n```\n\n##### Generated\n\n- PK로 쓰는 ID 외에 추가로 uuid를 기록하기 위해서 사용할 수 있습니다.\n\n```ts\n@Entity()\nexport class User {\n  @Column()\n  @Generated('uuid')\n  uuid: string;\n}\n```\n\n### DateColumn\n\n- CreateDateColumn과 UpdateDateColumn, DeleteDateColumn이 있습니다.\n\n#### CreateDateColumn\n\n- 해당 열이 추가된 시각을 자동으로 기록합니다.\n- 옵션을 적지 않을시 datetime 타입으로 기록됩니다.\n\n```ts\n@Entity()\nexport class User {\n  @CreateDateColumn()\n  createdAt: Date;\n}\n```\n\n#### UpdateDateColumn\n\n- 해당 열이 수정된 시각을 자동으로 기록합니다.\n- 옵션을 적지 않을시 datetime 타입으로 기록됩니다.\n\n```ts\n@Entity()\nexport class User {\n  @UpdateDateColumn()\n  updatedAt: Date;\n}\n```\n\n#### DeleteDateColumn\n\n- 해당 열이 삭제된 시각을 자동으로 기록합니다.\n- 옵션을 적지 않을시 datetime 타입으로 기록됩니다.\n- deletedAt에 시각이 기록되지 않은 열들만 쿼리하기 위해 TypeORM의 soft delete 기능을 활용할 수 있습니다.\n\n```ts\n@Entity()\nexport class User {\n  @DeleteDateColumn()\n  deletedAt: Date;\n}\n```\n\n##### soft delete이란 ?\n\n- 데이터 열을 실제로 삭제하지 않고, 삭제여부를 나타내는 칼럼인 deletedAt을 사용하는 방식입니다.\n- 일반적인 삭제 대신 삭제된 열을 갱신하는 UPDATE문을 사용하는 방식입니다.\n- 시각이 기록되지 않은 열들만 필터해서 쿼리하도록 도와주는 역할을 합니다.\n- 다른 테이블과 JOIN시 항상 삭제된 열을 검사해서 성능이 떨어집니다.\n- 복구하거나 예전 기록을 확인하고자 할 때 간편합니다.\n\n### Relation. 이제 하나의 테이블이 아닌 테이블간의 관계에 대해 알아보겠습니다.\n\n- 테이블간의 관계는 1:1, 1:N, M:N 관계가 있습니다.\n\n#### OneToOne\n\n- @JoinColumn()을 사용한 필드는 FK(외래키)로 타겟 테이블에 등록됩니다. `@JoinColumn()은 반드시 한쪽 테이블에서만 사용해야 합니다`.\n- 관계는 단방향과 양방향 모두 작성이 가능합니다.\n  - uni-directional은 @OneToOne()을 한쪽에만 써주는 것\n  - bi-directional은 양쪽에 모두 써주는 것\n\n```ts\n@Entity()\nexport class Profile {\n  @PrimaryGeneratedColumn()\n  id: number;\n\n  @Column()\n  gender: string;\n\n  @Column()\n  photo: string;\n\n  @OneToOne(() =\u003e User, (user) =\u003e user.profile)\n  user: User;\n}\n\n@Entity()\nexport class User {\n  @PrimaryGeneratedColumn()\n  id: number;\n\n  @Column()\n  name: string;\n\n  @OneToOne((type) =\u003e Profile, (profile) =\u003e profile.user)\n  @JoinColumn()\n  profile: Profile;\n}\n\n// using find* method\nconst userRepo = connection.getRepository(User);\nconst users = await userRepo.find({ relations: ['profile'] });\n\n// using query builder\nconst users = await connection\n  .getRepository(User)\n  .createQueryBuilder('user')\n  .leftJoinAndSelect('user.profile', 'profile')\n  .getMany();\n```\n\n#### ManyToOne/OneToMany\n\n- @OneToMany()/@ManyToOne()에서는 `@JoinColumn()을 생략`할 수 있습니다.\n- `@OneToMany()는 @ManyToOne()이 없으면 안됩니다`.\n  - 하지만 반대로 @ManyToOne()은 @OneToMany()이 없어도 정의할 수 있습니다.\n- @ManyToOne()을 설정한 테이블에는 `relation id가 외래키`를 가지고 있게 됩니다.\n\n```ts\n@Entity()\nexport class User {\n  @PrimaryGeneratedColumn()\n  id: number;\n\n  @Column()\n  name: string;\n\n  @OneToMany((type) =\u003e Photo, (photo) =\u003e photo.user)\n  photos: Photo[];\n}\n\n@Entity()\nexport class Photo {\n  @PrimaryGeneratedColumn()\n  id: number;\n\n  @Column()\n  url: string;\n\n  @ManyToOne((type) =\u003e User, (user) =\u003e user.photos)\n  user: User;\n}\n\n// using find* method\nconst userRepository = connection.getRepository(User);\nconst users = await userRepository.find({ relations: ['photos'] });\n// or from inverse side\nconst photoRepository = connection.getRepository(Photo);\nconst photos = await photoRepository.find({ relations: ['user'] });\n\n// using query builder\nconst users = await connection\n  .getRepository(User)\n  .createQueryBuilder('user')\n  .leftJoinAndSelect('user.photos', 'photo')\n  .getMany();\n// or from inverse side\nconst photos = await connection\n  .getRepository(Photo)\n  .createQueryBuilder('photo')\n  .leftJoinAndSelect('photo.user', 'user')\n  .getMany();\n```\n\n#### ManyToMany\n\n- @ManyToMany() 관계에서는 `@JoinTable()이 반드시 필요합니다`. 한쪽 테이블에만 @JoinTable()을 넣어주면 됩니다.\n- 단, @ManyToMany()에서 옵션 cascade가 true인 경우 soft delete를 할 수 있습니다. 필요에 따라 사용할 수 있습니다.\n\n```ts\n@Entity()\nexport class Category {\n  @PrimaryGeneratedColumn()\n  id: number;\n\n  @Column()\n  name: string;\n}\n\n@Entity()\nexport class Question {\n  @PrimaryGeneratedColumn()\n  id: number;\n\n  @Column()\n  title: string;\n\n  @Column()\n  text: string;\n\n  @ManyToMany(() =\u003e Category)\n  @JoinTable()\n  categories: Category[];\n}\n\n// using find* method\nconst questionRepository = connection.getRepository(Question);\nconst questions = await questionRepository.find({ relations: ['categories'] });\n\n// using query builder\nconst questions = await connection\n  .getRepository(Question)\n  .createQueryBuilder('question')\n  .leftJoinAndSelect('question.categories', 'category')\n  .getMany();\n```\n\n### Tree entity\n\n- TypeORM은 트리 구조를 저장하기 위해 인접 목록 및 클로저 테이블 패턴을 지원합니다.\n\n#### 먼저 셀프조인에 예시에 대해 알아보겠습니다.\n\n- 1개의 테이블에서 부모-자식 관계를 나타낼 수 있는 패턴\n- 상품 카테고리(소,중,대분류)\n- 사원(사원,관리자,상위관리자)\n- 지역(읍/면/동,구/군,시/도)\n\n#### TypeORM은 셀프조인을 아래와 같은 4가지 패턴으로 지원합니다.\n\n#### Adjacency list\n\n- 자기참조를 @ManyToOne(), @OneToMany() 데코레이터로 표현할 수 있습니다.\n- 이 방식은 간단한 것이 가장 큰 장점이지만, JOIN하는데 제약이 있어 큰 트리를 로드하는데 문제가 있습니다.\n\n```ts\n@Entity()\nexport class Category {\n  @PrimaryGeneratedColumn()\n  id: number;\n\n  @Column()\n  name: string;\n\n  @Column()\n  description: string;\n\n  @ManyToOne((type) =\u003e Category, (category) =\u003e category.children)\n  parent: Category;\n\n  @OneToMany((type) =\u003e Category, (category) =\u003e category.parent)\n  children: Category[];\n}\n```\n\n#### Nested set\n\n- @Tree(), @TreeChildren(), @TreeParent()를 사용한 또 다른 패턴입니다.\n- 읽기 작업에는 효과적이지만 쓰기 작업에는 효과적이지 않습니다.\n- 여러 개의 루트를 가질 수 없다는 점도 문제입니다.\n- @Tree()의 인자로 `nested-set`이 들어갑니다.\n\n```ts\n@Entity()\n@Tree('nested-set')\nexport class Category {\n  @PrimaryGeneratedColumn()\n  id: number;\n\n  @Column()\n  name: string;\n\n  @TreeChildren()\n  children: Category[];\n\n  @TreeParent()\n  parent: Category;\n}\n```\n\n#### Materialized path\n\n- 구체화된 경로 혹은 경로 열거라고 부릅니다.\n- 간단하고 효율적입니다.\n- nested set과 사용방법은 같습니다.\n- @Tree()의 인자로 `materialized-path`이 들어갑니다.\n\n```ts\nimport {\n  Entity,\n  Tree,\n  Column,\n  PrimaryGeneratedColumn,\n  TreeChildren,\n  TreeParent,\n  TreeLevelColumn,\n} from 'typeorm';\n\n@Entity()\n@Tree('materialized-path')\nexport class Category {\n  @PrimaryGeneratedColumn()\n  id: number;\n\n  @Column()\n  name: string;\n\n  @TreeChildren()\n  children: Category[];\n\n  @TreeParent()\n  parent: Category;\n}\n```\n\n### Closure table\n\n- 부모와 자식 사이의 관계를 분리된 테이블에 특별한 방법으로 저장합니다.\n- 읽기와 쓰기 모두 효율적으로 할 수 있습니다.\n- nested set과 사용방법은 같습니다.\n- @Tree()의 인자로 closure-table이 들어갑니다.\n\n```ts\nimport {\n  Entity,\n  Tree,\n  Column,\n  PrimaryGeneratedColumn,\n  TreeChildren,\n  TreeParent,\n  TreeLevelColumn,\n} from 'typeorm';\n\n@Entity()\n@Tree('closure-table')\nexport class Category {\n  @PrimaryGeneratedColumn()\n  id: number;\n\n  @Column()\n  name: string;\n\n  @TreeChildren()\n  children: Category[];\n\n  @TreeParent()\n  parent: Category;\n}\n```\n\n- 선택적 매개 변수 옵션을 @Tree ( \"closure-table\", options)로 설정하여 클로저 테이블 이름 또는 클로저 테이블 열 이름을 지정할 수 있습니다.\n- ancestorColumnName 및 descandantColumnName은 기본 열의 메타 데이터를 수신하고 열의 이름을 반환하는 콜백 함수입니다.\n\n```ts\n@Tree(\"closure-table\", {\n    closureTableName: \"category_closure\",\n    ancestorColumnName: (column) =\u003e \"ancestor_\" + column.propertyName,\n    descendantColumnName: (column) =\u003e \"descendant_\" + column.propertyName,\n})\n```\n\n### JoinColumn/JoinTable에 대해 조금 더 알아보겠습니다.\n\n- 아래는 아래 2개의 데코레이터에 공통으로 사용할 수 있는 옵션입니다.\n  - eager 옵션이 있어서 N+1 문제를 제어할 수 있음\n  - cascade, onDelete 옵션이 있어 관계가 연결된 객체를 추가/수정/삭제되도록 할 수 있습니다. 버그를 유발할 수 있으니 주의해서 사용해야 합니다.\n\n#### N+1 문제란?\n\n- 하위 엔티티들을 첫 쿼리 실행시 한번에 가져오지 않고, Lazy Loading으로 필요한 곳에서 사용되어 쿼리가 실행될때 발생하는 문제가 N+1 쿼리 문제입니다.\n\n#### JoinColumn\n\n- @JoinColumn()을 사용하면 테이블에 자동으로 칼럼명과 참조 칼럼명을 합친 이름의 칼럼을 만들어냅니다.\n- 외래키를 가진 칼럼명과 참조칼럼명을 설정할 수 있는 옵션을 가지고 있습니다.\n- 설정하지 않으면 테이블명을 가지고 자동으로 매핑합니다.\n- 주의할 점으로는 @ManyToOne()에서는 꼭 적지 않아도 칼럼을 자동으로 만들어주지만, `@OneToOne()에서는 반드시 적어줘야 합니다`.\n\n```ts\n@Entity()\nexport class Post {\n  @ManyToOne((type) =\u003e Category)\n  @JoinColumn({\n    name: 'category_id',\n    referencedColumnName: 'name',\n  })\n  category: Category;\n}\n\n@Entity()\nexport class Category {\n  @PrimaryGeneratedColumn()\n  id: number;\n\n  @Column()\n  name: string;\n}\n```\n\n### JoinTable\n\n- `M:N 관계`에서 사용하며 연결 테이블을 설정할 수 있습니다.\n- @JoinTable()의 옵션을 사용해 연결 테이블의 칼럼명과 참조 칼럼명을 설정할 수 있습니다.\n\n```ts\n@Entity()\nexport class Question {\n  @ManyToMany((type) =\u003e Category)\n  @JoinTable({\n    name: 'question_categories',\n    joinColumn: {\n      name: 'question',\n      referencedColumnName: 'id',\n    },\n    inverseJoinColumn: {\n      name: 'category',\n      referencedColumnName: 'id',\n    },\n  })\n  categories: Category[];\n}\n\n@Entity()\nexport class Category {\n  @PrimaryGeneratedColumn()\n  id: number;\n\n  @Column()\n  name: string;\n}\n```\n\n### RelationId\n\n- 1:N/M:N 관계에서 entity에 명시적으로 관계가 있는 테이블의 칼럼 id를 적고싶은 경우, @RelationId()를 사용하면 됩니다.\n- @RelationId()가 꼭 필요하지는 않지만 entity를 보면서 칼럼을 한 눈에 볼 수 있다는 장점이 있습니다.\n- @RelationId()로 테이블을 조회하면 새로운 칼럼명도 결과에 같이 들고올 수 있습니다.\n- 하지만 relationId 칼럼에 삽입하여 사용할 수 없습니다.\n  - inset or update 시 payload에 relationId가 아닌 relation으로 사용해야 합니다.\n  - 관련 이슈 : https://github.com/typeorm/typeorm/issues/3867\n  - @RelationId를 사용하는 대신 @Column으로 relationId를 장식 할 수 있습니다. JoinColumn의 이름이 숫자열 이름과 같을 때 TypeORM이 둘 다 일치하고 userId를 설정하거나 사용자를 설정하면 TypeORM이 처리합니다.\n\n```ts\n// using many to one\n@Entity()\nexport class Post {\n  @ManyToOne((type) =\u003e Category)\n  category: Category;\n\n  @RelationId((post: Post) =\u003e post.category)\n  categoryId: number;\n}\n\n// using many to many\n@Entity()\nexport class Post {\n  @ManyToMany((type) =\u003e Category)\n  categories: Category[];\n\n  @RelationId((post: Post) =\u003e post.categories)\n  categoryIds: number[];\n}\n```\n\n### Subscriber\n\n- 데이터베이스에 특화된 리스너로 CRUD 이벤트 발생을 리슨합니다.\n- 다음과 같은 데코레이터들을 가지고 있습니다.\n  - @AfterLoad, @AfterInsert, @BeforeInsert, @AfterUpdate, @BeforeUpdate, @AfterRemove, @BeforeRemove\n- logging 옵션이 있긴 하지만 쿼리만을 보여주기 때문에 한 줄씩 분석하기 위해 로그를 남기는 경우에는 지양하는 것이 좋습니다.\n\n```ts\nimport {\n  Connection,\n  EntitySubscriberInterface,\n  EventSubscriber,\n  InsertEvent,\n} from 'typeorm/index';\nimport { User } from './User';\n\n@EventSubscriber()\nexport class UserSubscriber implements EntitySubscriberInterface\u003cUser\u003e {\n  constructor(connection: Connection) {\n    connection.subscribers.push(this);\n  }\n  listenTo() {\n    return User;\n  }\n  beforeInsert(event: InsertEvent\u003cUser\u003e): Promise\u003cany\u003e | void {\n    console.log('User 테이블에 입력 전 : ', event.entity);\n  }\n  afterInsert(event: InsertEvent\u003cUser\u003e): Promise\u003cany\u003e | void {\n    console.log('User 테이블에 입력 후 : ', event.entity);\n  }\n}\n```\n\n### Index\n\n- 테이블 `쿼리 속도`를 올려주는 자료구조입니다.\n- 테이블 내 1개 혹은 그 이상의 칼럼을 이용해 생성할 수 있습니다.\n- 인덱스는 보통 키-필드만 갖고있고, 테이블의 다른 세부항목을 갖지 않기때문에 보통 테이블을 저장하는 공간보다 더 `적은 공간`을 차지합니다.\n- 특정 칼럼 값을 가지고 있는 열이나 값을 `빠르게 찾기` 위해 사용합니다.\n  - 인덱싱하지 않은 경우는 첫번째 열부터 전체 테이블을 걸쳐 연관된 열을 검색하기때문에 테이블이 클수록 쿼리비용이 커집니다.\n  - 인덱싱을 한 경우는 모든 데이터를 조회하지 않고 데이터 파일의 중간에서 검색위치를 빠르게 잡을 수 있습니다.\n- `WHERE`절과 일치하는 열을 빨리 찾기 위해서 사용합니다.\n- `JOIN`을 실행할 때 다른 테이블에서 열을 추출하기 위해서 사용합니다.\n- 데이터 양이 많고 변경보다 `검색이 빈번한 경우` 인덱싱을 하면 좋습니다.\n\n\u003e 쉽게 말해 책에서 transaction이란 주제가 어딨는지 목차 없이 찾으려면 눈물날지도 모릅니다. 책의 주요내용을 가나다순으로 정리한 목록이 있으면 찾기 쉬울텐데 인덱스가 바로 그 역할을 합니다.\n\u003e 특정 칼럼에 인덱스를 걸 수 있습니다. 옵션으로 고유키를 부여할 수도 있습니다. 단일 칼럼에 인덱스를 걸고 싶으면 칼럼마다 추가할 수도 있지만, 테이블 전체에 인덱스를 걸고싶은 경우 @Entity()아래 @Index()를 추가할 수도 있습니다.\n\n```ts\n// using with single column\n@Entity()\nexport class User {\n  @Index()\n  @Column()\n  firstName: string;\n\n  @Index({ unique: true })\n  @Column()\n  lastName: string;\n}\n\n// using with entity\n@Entity()\n@Index(['firstName', 'lastName'], { unique: true })\nexport class User {\n  @Column()\n  firstName: string;\n\n  @Column()\n  lastName: string;\n}\n```\n\n### Unique\n\n- 특정 칼럼에 고유키 제약조건을 생성할 수 있습니다.\n- @Unique()는 테이블 자체에만 적용하는 것이 가능합니다.\n\n```ts\n@Entity()\n@Unique(['firstName', 'lastName'])\nexport class User {\n  @Column()\n  firstName: string;\n\n  @Column()\n  lastName: string;\n}\n```\n\n### Check\n\n- 테이블에서 데이터 추가 쿼리가 날아오면 값을 체크하는 역할을 합니다.\n\n```ts\n@Entity()\n@Check('\"age\" \u003e 18')\nexport class User {\n  @Column()\n  firstName: string;\n\n  @Column()\n  firstName: string;\n\n  @Column()\n  age: number;\n}\n```\n\n### Transaction\n\n- 데이터베이스 내에서 하나의 `그룹으로 처리해야하는 명령문`을 모아서 처리하는 작업의 단위를 말합니다.\n  - 여러 단계의 처리를 `하나의 처리처럼` 다루는 기능입니다.\n  - 여러 개의 명령어의 집합이 정상적으로 처리되면 정상종료됩니다.\n  - 하나의 명령어라도 `잘못되면 전체 취소`됩니다.\n- 트랜잭션을 쓰는 이유는 `데이터의 일관성`을 유지하면서 `안정적으로 데이터를 복구`하기 위함입니다.\n- 격리성 수준 설정을 통해 트랜잭션이 열려있는 동안 외부에서 해당 데이터에 접근하지 못하도록 락을 걸 수 있습니다.\n\n#### 격리성 수준\n\n- READ UNCOMMITTED\n- READ COMMITTED\n- REPEATABLE READ\n- SERIALIZABLE\n\n#### global connection을 열어서 트랜젝션을 사용하는 경우는 아래와 같이 사용합니다.\n\n```ts\nawait getManager().transaction(\n  'SERIALIZABLE',\n  (transactionalEntityManager) =\u003e {},\n);\n```\n\n#### 하지만 global connection은 사이드이펙트가 많은 방법이기때문에 데코레이터나 queryRunner를 사용한 방법을 추천합니다.\n\n- 아래는 데코레이터 @Transaction(), @TransactionManager(), @TransactionRepository()를 사용한 패턴입니다.\n\n```ts\n// using transaction manager\n@Transaction({ isolation: 'SERIALIZABLE' })\nsave(@TransactionManager() manager: EntityManager, user: User) {\n    return manager.save(user)\n}\n\n// using transaction repository\n@Transaction({ isolation: 'SERIALIZABLE' })\nsave(user: User, @TransactionRepository(User) userRepository: Repository\u003cUser\u003e) {\n    return userRepository.save(user)\n}\n```\n\n#### 아래는 queryRunner를 사용한 방법입니다. 다만 이 방법에서는 격리성 수준 설정이 불가능합니다.\n\n- startTransaction은 트랜잭션을 시작하는 메서드\n- commitTransaction는 모든 변경사항을 커밋하는 메서드\n- rollbackTransaction는 모든 변경사항을 되돌리는 메서드\n\n```ts\nawait queryRunner.startTransaction();\n\ntry {\n  await queryRunner.manager.save(user);\n  await queryRunner.manager.save(photos);\n\n  await queryRunner.commitTransaction();\n} catch (err) {\n  await queryRunner.rollbackTransaction();\n} finally {\n  await queryRunner.release();\n}\n```\n\n### Eager and Lazy Relations\n\n#### eager\n\n- relationship을 설정하지 않아도 eager를 설정하면 자동으로 relationship을 불러옵니다.\n  - find\\* (즉, find, findAll, findOne...)에서 자동으로 relationship을 불러옵니다.\n\n```ts\n@ManyToMany(type =\u003e Category, category =\u003e category.questions, {\n  eager: true\n})\n```\n\n#### lazy\n\n- Promise로 반환하면, 자동으로 lazy relationship이 됩니다.\n  - lazy를 불러올 때는 Promise.resolve를 하던가, await로 불러오면 됩니다.\n\n```ts\n@ManyToMany(type =\u003e Question, question =\u003e question.categories)\nquestions: Promise\u003cQuestion[]\u003e;\n```\n\n```ts\nconst question = await connection.getRepository(Question).findOne(1);\nconst categories = await question.categories;\n```\n\n- 참고 : 다른 언어 (자바, PHP 등)에서 왔고 모든 곳에서 게으른 관계를 사용하는 데 익숙하다면 조심하세요. 이러한 언어는 비동기식이 아니며 지연로드는 다른 방식으로 이루어집니다. 그렇기 때문에 거기에서 promise를 사용하지 않습니다. 자바 스크립트와 Node.JS에서 지연로드 된 관계를 원하면 promise를 사용해야합니다. 이것은 비표준 기술이며 TypeORM에서 실험적인 것으로 간주됩니다.\n\n## typeorm의 bigint\n\n- typeorm bigint는 number로 바꿔주지 않습니다. string입니다.\n  - [Note about bigint type: bigint column type, used in SQL databases, doesn’t fit into the regular number type and maps property to a string instead.](https://typeorm.io/entities#column-types)\n\n---\n\n## 참고\n\n- [TypeORM 시작하기](https://velog.io/@josworks27/typeORM-%EC%8B%9C%EC%9E%91%ED%95%98%EA%B8%B0)\n- [TypeORM 데코레이터 씹어먹기](https://yangeok.github.io/orm/2020/12/14/typeorm-decorators.html)\n- [개발자 마르코](https://gkqlgkql.tistory.com/85)\n"])</script><script>self.__next_f.push([1,"f:T27d0c,"])</script><script>self.__next_f.push([1,"\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eNode와 RDB의 ORM 서비스는 sequelize, typeorm, prisma 등 많은 라이브러리들이 있습니다.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e가장 먼저 사용한 ORM 서비스는 sequelize 였지만 typeorm이 typescript 지원이나 시장의 흐름에 따라 조금 더 많이 사용된다고 생각되어 공부하게 되었습니다.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eprisma도 고려해 보았으나 아직은 시기상조인 것 같았습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"typeorm에-대해-알아보기-전에-orm이-무엇인지-알아보겠습니다\"\u003etypeorm에 대해 알아보기 전에 ORM이 무엇인지 알아보겠습니다.\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#typeorm에-대해-알아보기-전에-orm이-무엇인지-알아보겠습니다\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eORM(Object-relational mapping)은 객체지향 프로그래밍(Object-Oriented-Programming)과 관계형 데이터베이스(Relational-Database)사이의 호환되지 않는 \u003ccode class=\"inline-code\"\u003e데이터를 변환하는 시스템\u003c/code\u003e입니다.\n\u003cul\u003e\n\u003cli\u003e객체와 테이블 시스템(RDBMS)을 변형 및 연결해주는 작업입니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eORM을 이용한 개발은 객체와 데이터베이스의 변형에 유연하게 대처할 수 있습니다.\u003c/li\u003e\n\u003cli\u003eORM을 객체 지향 프로그래밍 관점에서 생각해보면, 관계형 데이터베이스에 제약을 최대한 받지 않으면서, 객체를 클래스로 표현하는 것과 같이 관계형 데이터베이스를 객체처럼 쉽게 표현합니다.\n\u003cul\u003e\n\u003cli\u003e객체지향 프로그래밍은 Class를 사용하고 관계형 데이터베이스는 Table을 사용합니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"바로-본론으로-들어가서-typeorm을-프로젝트에서-어떻게-도입할지-알아보겠습니다\"\u003e바로 본론으로 들어가서 typeorm을 프로젝트에서 어떻게 도입할지 알아보겠습니다.\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#바로-본론으로-들어가서-typeorm을-프로젝트에서-어떻게-도입할지-알아보겠습니다\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e의존성 설치 및 init\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-bash optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-bash code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token function\"\u003enpm\u003c/span\u003e \u003cspan class=\"token function\"\u003einstall\u003c/span\u003e typeorm reflect-metadata @types/node mysql\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003etypeorm init \u003cspan class=\"token parameter variable\"\u003e--name\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e프로젝트이름\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token parameter variable\"\u003e--database\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e데이터베이스\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003eglobal place 의 app.ts에 import 추가합니다.\n\u003cul\u003e\n\u003cli\u003ereflect-metadata 패키지를 사용하면 유형에 대한 런타임 반영을 수행 할 수 있습니다. TypeORM은 대부분 데코레이터 (@Entity 또는 @Column)와 함께 작동하므로이 패키지는 이러한 데코레이터를 구문 분석하고 SQL 쿼리를 작성하는 데 사용합니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token string\"\u003e'reflect-metadata'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"노드-모듈typeorm-model-generator-이용해-모델-자동-생성하는-방법도-있습니다\"\u003e노드 모듈(typeorm-model-generator) 이용해 모델 자동 생성하는 방법도 있습니다.\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#노드-모듈typeorm-model-generator-이용해-모델-자동-생성하는-방법도-있습니다\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e각 옵션을 수동으로 입력\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-bash optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-bash code-highlight\"\u003e\u003cspan class=\"code-line\"\u003etypeorm-model-generator\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e커맨드 한 번에 생성\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-bash optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-bash code-highlight\"\u003e\u003cspan class=\"code-line\"\u003etypeorm-model-generator \u003cspan class=\"token parameter variable\"\u003e-h\u003c/span\u003e localhost \u003cspan class=\"token parameter variable\"\u003e-u\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$userName\u003c/span\u003e \u003cspan class=\"token parameter variable\"\u003e-x\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$password\u003c/span\u003e \u003cspan class=\"token parameter variable\"\u003e-e\u003c/span\u003e mysql \u003cspan class=\"token parameter variable\"\u003e-o\u003c/span\u003e ./entities \u003cspan class=\"token parameter variable\"\u003e--ssl\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"typeorm-작성-패턴에-대해-알아보겠습니다\"\u003etypeorm 작성 패턴에 대해 알아보겠습니다.\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#typeorm-작성-패턴에-대해-알아보겠습니다\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eActive Record 패턴과 Data Mapper 패턴이 있습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"active-record-패턴에-대해-먼저-알아보겠습니다\"\u003eActive Record 패턴에 대해 먼저 알아보겠습니다.\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#active-record-패턴에-대해-먼저-알아보겠습니다\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eActive Record 패턴은 \u003ccode class=\"inline-code\"\u003e모델 그 자체에 쿼리 메소드를 정의\u003c/code\u003e하고, \u003ccode class=\"inline-code\"\u003e모델의 메소드를 사용\u003c/code\u003e하여 객체를 저장, 제거, 불러오는 방식입니다.\u003c/li\u003e\n\u003cli\u003eBaseEntity라는 클래스를 사용하여 새로운 클래스에 상속하게 한 후 사용할 수 있습니다. 이를 통해 BaseEntity가 갖고 있는 메소드와 static으로 만들어 내는 커스텀 메소드를 이용할 수 있습니다.\u003c/li\u003e\n\u003cli\u003e규모가 작은 애플리케이션에서 적합하고 간단히 사용할 수 있습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e BaseEntity\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e Entity\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e PrimaryGeneratedColumn\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e Column \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'typeorm'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eUser\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eextends\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eBaseEntity\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003ePrimaryGeneratedColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  id\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003enumber\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  firstName\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  lastName\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  isActive\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eboolean\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"token function\"\u003efindByName\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003efirstName\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e lastName\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ecreateQueryBuilder\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'user'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ewhere\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'user.firstName = :firstName'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e firstName \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eandWhere\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'user.lastName = :lastName'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e lastName \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egetMany\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token comment\"\u003e// example how to save AR entity\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e user \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eUser\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003euser\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003efirstName \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'Timber'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003euser\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003elastName \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'Saw'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003euser\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eisActive \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e user\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003esave\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token comment\"\u003e// example how to remove AR entity\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e user\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eremove\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token comment\"\u003e// example how to load AR entities\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e users \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e User\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003efind\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e skip\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e take\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e5\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e newUsers \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e User\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003efind\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e isActive\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e timber \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e User\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003efindOne\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e firstName\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'Timber'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e lastName\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'Saw'\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e timber \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e User\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003efindByName\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'Timber'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'Saw'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"data-mapper-패턴에-대해서도-알아보겠습니다\"\u003eData Mapper 패턴에 대해서도 알아보겠습니다.\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#data-mapper-패턴에-대해서도-알아보겠습니다\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eData Mapper 패턴은 \u003ccode class=\"inline-code\"\u003e분리된 클래스에 쿼리 메소드를 정의\u003c/code\u003e하는 방식이며, \u003ccode class=\"inline-code\"\u003eRepository를 이용\u003c/code\u003e하여 객체를 저장, 제거, 불러옵니다.\u003c/li\u003e\n\u003cli\u003eActive Record 패턴과의 차이점은 모델에 접근하는 방식이 아닌 \u003ccode class=\"inline-code\"\u003eRepository에서 데이터에 접근\u003c/code\u003e한다는 것입니다.\u003c/li\u003e\n\u003cli\u003e규모가 큰 애플리케이션에 적합하고 유지보수하는데 효과적이다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e Entity\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e PrimaryGeneratedColumn\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e Column \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'typeorm'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eUser\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003ePrimaryGeneratedColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  id\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003enumber\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  firstName\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  lastName\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  isActive\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eboolean\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e EntityRepository\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e Repository \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'typeorm'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e User \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'../entity/User'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntityRepository\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eUserRepository\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eextends\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eRepository\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003eUser\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token function\"\u003efindByName\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003efirstName\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e lastName\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ecreateQueryBuilder\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'user'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ewhere\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'user.firstName = :firstName'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e firstName \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eandWhere\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'user.lastName = :lastName'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e lastName \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egetMany\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e userRepository \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e connection\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egetRepository\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eUser\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token comment\"\u003e// example how to save DM entity\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e user \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eUser\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003euser\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003efirstName \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'Timber'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003euser\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003elastName \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'Saw'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003euser\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eisActive \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e userRepository\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003esave\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003euser\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token comment\"\u003e// example how to remove DM entity\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e userRepository\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eremove\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003euser\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token comment\"\u003e// example how to load DM entities\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e users \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e userRepository\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003efind\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e skip\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e take\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e5\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e newUsers \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e userRepository\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003efind\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e isActive\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e timber \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e userRepository\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003efindOne\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  firstName\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'Timber'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  lastName\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'Saw'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"entity들을-만들었다면-데이터베이스에-대한-연결-생성하는-법을-알아-보겠습니다\"\u003eentity들을 만들었다면 데이터베이스에 대한 연결 생성하는 법을 알아 보겠습니다.\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#entity들을-만들었다면-데이터베이스에-대한-연결-생성하는-법을-알아-보겠습니다\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token string\"\u003e'reflect-metadata'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e createConnection \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'typeorm'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e Photo \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'./entity/Photo'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token function\"\u003ecreateConnection\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  type\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'mysql'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  host\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'localhost'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  port\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e3306\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  username\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'root'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  password\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'admin'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  database\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'test'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  entities\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    Photo\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"token comment\"\u003e// __dirname + '/entity/*.js'\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  synchronize\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  logging\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003efalse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ethen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003econnection\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"token comment\"\u003e// here you can start to work with your entities\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ecatch\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eerror\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token builtin\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eerror\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"entity를-만드는-방법에-대해-조금-더-상세히-알아보겠습니다\"\u003eEntity를 만드는 방법에 대해 조금 더 상세히 알아보겠습니다.\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#entity를-만드는-방법에-대해-조금-더-상세히-알아보겠습니다\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003ch3 id=\"entity-데코레이터\"\u003eEntity 데코레이터\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#entity-데코레이터\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e데이터베이스 테이블을 정의하기 전에 실행해야하는 데코레이터입니다.\u003c/li\u003e\n\u003cli\u003e테이블명을 따로 지정하지 않아도 클래스명으로 매핑하지만, 옵션으로 테이블명을 지정할 수 있습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'users'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eUser\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003ename: \u003ccode class=\"inline-code\"\u003e테이블 이름\u003c/code\u003e입니다. 지정하지 않으면 테이블 이름은 엔티티 \u003ccode class=\"inline-code\"\u003e클래스명\u003c/code\u003e으로 생성됩니다.\u003c/li\u003e\n\u003cli\u003edatabase: 선택된 DB서버의 데이터베이스 이름입니다.\u003c/li\u003e\n\u003cli\u003eschema: 스키마 이름입니다.\n\u003cul\u003e\n\u003cli\u003eMySQL에서는 schema와 database가 따로 분리되어있지 않습니다. OracleDB에서는 schema를 따로 분리해서 database에 할당된 사용자로 사용합니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eengine: 테이블 생성 중에 설정할 수 있는 DB엔진 이름입니다.\u003c/li\u003e\n\u003cli\u003esynchronize: false로 설정할 시 스키마 싱크를 건너뜁니다.\u003c/li\u003e\n\u003cli\u003eorderBy: QueryBuilder과 find를 실행할 때 엔티티의 기본순서를 지정합니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  name\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'users'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  engine\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'MyISAM'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  database\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'example_dev'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  schema\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'schema_with_best_tables'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  synchronize\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003efalse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  orderBy\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    name\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'ASC'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    id\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'DESC'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eUser\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"중복되는-entity를-상속를-사용하여-해결할-수-있습니다\"\u003e중복되는 Entity를 상속를 사용하여 해결할 수 있습니다.\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#중복되는-entity를-상속를-사용하여-해결할-수-있습니다\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eConcrete table inheritance와 Single table inheritance가 있습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"concrete-table-inheritance\"\u003eConcrete table inheritance\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#concrete-table-inheritance\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e중복된 칼럼을 베이스가 되는 \u003ccode class=\"inline-code\"\u003e추상 클래스\u003c/code\u003e를 선언한 다음 확장할 수 있습니다.\u003c/li\u003e\n\u003cli\u003e참고로 active record 패턴을 사용할 예정이라면, \u003ccode class=\"inline-code\"\u003eBaseEntity\u003c/code\u003e라는 이름은 피하는게 좋습니다.\n\u003cul\u003e\n\u003cli\u003etypeorm에서 제공하는 클래스인 BaseEntity는 기본 쿼리 메서드 hasId, save, remove 등의 메서드를 담은 클래스입니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token comment\"\u003e// 추상 클래스\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eabstract\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eContent\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003ePrimaryGeneratedColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  id\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003enumber\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  title\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  description\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token comment\"\u003e// 1\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003ePhoto\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eextends\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eContent\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  size\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token comment\"\u003e// 2\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eQuestion\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eextends\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eContent\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  answersCount\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003enumber\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token comment\"\u003e// 3\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003ePost\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eextends\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eContent\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  viewCount\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003enumber\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"single-table-inheritance\"\u003eSingle table inheritance\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#single-table-inheritance\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e@TableInheritance(), @ChildEntity()를 사용하는 방법입니다.\u003c/li\u003e\n\u003cli\u003e이 방법은 데이터베이스에 Content 테이블이 생성됩니다. \u003ccode class=\"inline-code\"\u003eContent 위에 @Entity()를 선언\u003c/code\u003e해줘야 아래와 같은 패턴을 사용할 수 있습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eTableInheritance\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e column\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e type\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'varchar'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e name\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'type'\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eContent\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003ePrimaryGeneratedColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  id\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003enumber\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  title\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  description\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eChildEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003ePhoto\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eextends\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eContent\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  size\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eChildEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eQuestion\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eextends\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eContent\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  answersCount\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003enumber\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eChildEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003ePost\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eextends\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eContent\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  viewCount\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003enumber\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"embedded-entities\"\u003eEmbedded entities\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#embedded-entities\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e이름이 비슷하고 타입이 같은 칼럼들을 묶는 패턴입니다.\u003c/li\u003e\n\u003cli\u003eUser.name은 User.nameFirst, User.nameLast로 분기합니다. Name은 데코레이터 @Entity()가 붙어있지 않기때문에 위의 패턴처럼 \u003ccode class=\"inline-code\"\u003e실제 테이블이 생겨나지는 않습니다\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eName\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  first\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  last\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eUser\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003ePrimaryGeneratedColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  id\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003etype\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e Name\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  name\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Name\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  isActive\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eboolean\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"viewentity\"\u003eViewEntity\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#viewentity\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003ch4 id=\"sql-view란-\"\u003eSQL view란 ?\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#sql-view란-\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eview는 하나의 \u003ccode class=\"inline-code\"\u003e가상 테이블\u003c/code\u003e입니다.\u003c/li\u003e\n\u003cli\u003e실제 데이터가 저장되는 것은 아니지만, view를 통해 데이터를 가상 테이블로 관리가 가능합니다.\u003c/li\u003e\n\u003cli\u003e1개의 view로 여러 테이블의 데이터를 조회할 수 있습니다.\u003c/li\u003e\n\u003cli\u003e복잡한 쿼리를 통해 얻을 수 있는 결과를 간단한 쿼리로 얻을 수 있게 도와줍니다.\u003c/li\u003e\n\u003cli\u003e특정 기준에 따른 사용자 별로 다른 데이터를 액세스할 수 있도록 도와줄 수도 있습니다.\u003c/li\u003e\n\u003cli\u003e조회 대상을 줄이고 싶을 때 사용할 수 있습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"viewentity-데코레이터-인자\"\u003eViewEntity 데코레이터 인자\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#viewentity-데코레이터-인자\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e데코레이터에 들어가는 인자가 아래와 같이 @Entity()와는 약간 다릅니다.\n\u003cul\u003e\n\u003cli\u003ename: 테이블 이름입니다. 지정하지 않으면 테이블 이름은 엔티티 클래스명으로 생성됩니다.\u003c/li\u003e\n\u003cli\u003edatabase: 선택된 DB서버의 데이터베이스 이름입니다.\u003c/li\u003e\n\u003cli\u003eschema: 스키머 이름입니다.\u003c/li\u003e\n\u003cli\u003eexpression: view를 정의합니다. 꼭 있어야하는 파라미터로 SQL쿼리문이나 queryBuilder 체이닝 메서드가 들어갈 수 있습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eexpression은 SQL 쿼리문이나 QueryBuilder에 체이닝할 수 있는 메서드가 들어갈 수 있습니다. 특이점으로는 필드명 위에 들어가는 데코레이터를 id까지 전부 @ViewColumn()을 사용해야 한다는 점이 있습니다. 만약 사용을 고려한다면, JOIN을 쳐서 테이블끼리 연결을 시키냐, 아니면 view를 통해 나중에 자주 사용할 가상 테이블을 미리 만들어두냐의 차이로 생각할 수 있습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eViewEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  expression\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token string\"\u003e        SELECT \"post\".\"id\" AS \"id\", \"post\".\"name\" AS \"name\", \"category\".\"name\" AS \"categoryName\"\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token string\"\u003e        FROM \"post\" \"post\"\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token string\"\u003e        LEFT JOIN \"category\" \"category\" ON \"post\".\"categoryId\" = \"category\".\"id\"\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token string\"\u003e    \u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003ePostCategory\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eViewColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  id\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003enumber\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eViewColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  name\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eViewColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  categoryName\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e구조가 복잡하고, 여러군데서 호출하는 데이터의 경우 미리 ViewEntity로 view 테이블을 만들어두면 유용합니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"column\"\u003eColumn\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#column\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eentity의 속성을 테이블 칼럼으로 표시합니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eUser\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003ePrimaryGeneratedColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  id\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003enumber\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e tpye\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'varchar'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e length\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e200\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e unique\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  firstName\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e nullable\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  lastName\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token keyword\"\u003edefault\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003efalse\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  isActive\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eboolean\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e@Column()에 들어갈 수 있는 옵션들 중 중요하다고 판단한 것들은 아래와 같습니다.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003etype(ColumnType) : \u003ccode class=\"inline-code\"\u003ejavascript의 원시타입\u003c/code\u003e들을 세분화해서 사용할 수 있습니다. 타입을 정의하는 방법은 다음과 같습니다.\u003c/li\u003e\n\u003cli\u003elength(string | number) : javascript의 원시타입들을 세분화해서 사용하기 위해 type 옵션과 같이 사용할 수 있습니다.\u003c/li\u003e\n\u003cli\u003eonUpdate(string) : cascading을 하기 위한 옵션으로 ON UPDATE 트리거입니다.\u003c/li\u003e\n\u003cli\u003enullable(boolean) : 칼럼을 NULL이나 NOT NULL로 만드는 옵션입니다. 기본값은 false입니다.\u003c/li\u003e\n\u003cli\u003edefault(string) : 칼럼에 DEFAULT 값을 설정합니다.\u003c/li\u003e\n\u003cli\u003eunique(boolean) : 유니크 칼럼이라고 표시할 수 있습니다. 유니크 constraint를 만듭니다. 기본값은 false 입니다.\u003c/li\u003e\n\u003cli\u003eenum(string[] | AnyEnum) : 칼럼의 값으로 enum을 사용할 수 있습니다. enum은 db단에서 처리할 수도, orm단에서 처리할 수도 있습니다.\u003c/li\u003e\n\u003cli\u003eenumName(string) : 다른 테이블에서 같은 enum을 사용하는 경우 필요합니다.\u003c/li\u003e\n\u003cli\u003etransformer({ from(value: DatabaseType): EntityType, to(value: EntityType): DatabaseType }) : 아래와 같은 코드를 만들어내서 json을 문자열로 만들고 파싱하는 역할을 합니다. 또는 boolean을 integer로 바꿔주는 일도 할 수 있습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e ValueTransformer \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'typeorm'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eSomeTransformer\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eimplements\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eValueTransformer\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token function\"\u003eto\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003evalue\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Map\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token builtin\"\u003enumber\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token constant\"\u003eJSON\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003estringify\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token operator\"\u003e...\u003c/span\u003evalue\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token function\"\u003efrom\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003evalue\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Map\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token builtin\"\u003enumber\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eMap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token constant\"\u003eJSON\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eparse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003evalue\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"idcolumn\"\u003eIdColumn\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#idcolumn\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003ePrimaryColumn과 PrimaryGeneratedColum이 있습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"primarycolumn\"\u003ePrimaryColumn\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#primarycolumn\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e@Column()의 옵션인 primary를 대체할 수 있습니다. \u003ccode class=\"inline-code\"\u003ePK\u003c/code\u003e를 만드는 역할을 합니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"primarygeneratedcolumn\"\u003ePrimaryGeneratedColumn\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#primarygeneratedcolumn\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode class=\"inline-code\"\u003e자동생성\u003c/code\u003e되는 ID값을 표현하는 방식을 아래와 같이 2가지 옵션을 사용할 수 있도록 도와줍니다.\n\u003cul\u003e\n\u003cli\u003eincrement: AUTO_INCREMENT를 사용해서 1씩 증가하는 ID를 부여합니다. 기본 옵션입니다.\u003c/li\u003e\n\u003cli\u003euuid: 유니크한 uuid를 사용할 수 있습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token comment\"\u003e// using increment\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eUser\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003ePrimaryGeneratedColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  id\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003enumber\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token comment\"\u003e// using uuid\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eUser\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003ePrimaryGeneratedColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'uuid'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  id\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch5 id=\"generated\"\u003eGenerated\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#generated\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003ePK로 쓰는 ID 외에 추가로 uuid를 기록하기 위해서 사용할 수 있습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eUser\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eGenerated\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'uuid'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  uuid\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"datecolumn\"\u003eDateColumn\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#datecolumn\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eCreateDateColumn과 UpdateDateColumn, DeleteDateColumn이 있습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"createdatecolumn\"\u003eCreateDateColumn\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#createdatecolumn\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e해당 열이 추가된 시각을 자동으로 기록합니다.\u003c/li\u003e\n\u003cli\u003e옵션을 적지 않을시 datetime 타입으로 기록됩니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eUser\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eCreateDateColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  createdAt\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Date\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"updatedatecolumn\"\u003eUpdateDateColumn\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#updatedatecolumn\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e해당 열이 수정된 시각을 자동으로 기록합니다.\u003c/li\u003e\n\u003cli\u003e옵션을 적지 않을시 datetime 타입으로 기록됩니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eUser\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eUpdateDateColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  updatedAt\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Date\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"deletedatecolumn\"\u003eDeleteDateColumn\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#deletedatecolumn\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e해당 열이 삭제된 시각을 자동으로 기록합니다.\u003c/li\u003e\n\u003cli\u003e옵션을 적지 않을시 datetime 타입으로 기록됩니다.\u003c/li\u003e\n\u003cli\u003edeletedAt에 시각이 기록되지 않은 열들만 쿼리하기 위해 TypeORM의 soft delete 기능을 활용할 수 있습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eUser\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eDeleteDateColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  deletedAt\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Date\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch5 id=\"soft-delete이란-\"\u003esoft delete이란 ?\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#soft-delete이란-\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e데이터 열을 실제로 삭제하지 않고, 삭제여부를 나타내는 칼럼인 deletedAt을 사용하는 방식입니다.\u003c/li\u003e\n\u003cli\u003e일반적인 삭제 대신 삭제된 열을 갱신하는 UPDATE문을 사용하는 방식입니다.\u003c/li\u003e\n\u003cli\u003e시각이 기록되지 않은 열들만 필터해서 쿼리하도록 도와주는 역할을 합니다.\u003c/li\u003e\n\u003cli\u003e다른 테이블과 JOIN시 항상 삭제된 열을 검사해서 성능이 떨어집니다.\u003c/li\u003e\n\u003cli\u003e복구하거나 예전 기록을 확인하고자 할 때 간편합니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"relation-이제-하나의-테이블이-아닌-테이블간의-관계에-대해-알아보겠습니다\"\u003eRelation. 이제 하나의 테이블이 아닌 테이블간의 관계에 대해 알아보겠습니다.\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#relation-이제-하나의-테이블이-아닌-테이블간의-관계에-대해-알아보겠습니다\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e테이블간의 관계는 1:1, 1:N, M:N 관계가 있습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"onetoone\"\u003eOneToOne\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#onetoone\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e@JoinColumn()을 사용한 필드는 FK(외래키)로 타겟 테이블에 등록됩니다. \u003ccode class=\"inline-code\"\u003e@JoinColumn()은 반드시 한쪽 테이블에서만 사용해야 합니다\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003e관계는 단방향과 양방향 모두 작성이 가능합니다.\n\u003cul\u003e\n\u003cli\u003euni-directional은 @OneToOne()을 한쪽에만 써주는 것\u003c/li\u003e\n\u003cli\u003ebi-directional은 양쪽에 모두 써주는 것\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eProfile\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003ePrimaryGeneratedColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  id\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003enumber\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  gender\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  photo\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eOneToOne\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e User\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003euser\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e user\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eprofile\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  user\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e User\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eUser\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003ePrimaryGeneratedColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  id\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003enumber\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  name\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eOneToOne\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003etype\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e Profile\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eprofile\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e profile\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003euser\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eJoinColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  profile\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Profile\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token comment\"\u003e// using find* method\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e userRepo \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e connection\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egetRepository\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eUser\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e users \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e userRepo\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003efind\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e relations\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'profile'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token comment\"\u003e// using query builder\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e users \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e connection\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egetRepository\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eUser\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ecreateQueryBuilder\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'user'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eleftJoinAndSelect\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'user.profile'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'profile'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egetMany\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"manytooneonetomany\"\u003eManyToOne/OneToMany\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#manytooneonetomany\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e@OneToMany()/@ManyToOne()에서는 \u003ccode class=\"inline-code\"\u003e@JoinColumn()을 생략\u003c/code\u003e할 수 있습니다.\u003c/li\u003e\n\u003cli\u003e\u003ccode class=\"inline-code\"\u003e@OneToMany()는 @ManyToOne()이 없으면 안됩니다\u003c/code\u003e.\n\u003cul\u003e\n\u003cli\u003e하지만 반대로 @ManyToOne()은 @OneToMany()이 없어도 정의할 수 있습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e@ManyToOne()을 설정한 테이블에는 \u003ccode class=\"inline-code\"\u003erelation id가 외래키\u003c/code\u003e를 가지고 있게 됩니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eUser\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003ePrimaryGeneratedColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  id\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003enumber\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  name\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eOneToMany\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003etype\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e Photo\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ephoto\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e photo\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003euser\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  photos\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Photo\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003ePhoto\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003ePrimaryGeneratedColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  id\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003enumber\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  url\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eManyToOne\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003etype\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e User\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003euser\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e user\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ephotos\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  user\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e User\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token comment\"\u003e// using find* method\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e userRepository \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e connection\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egetRepository\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eUser\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e users \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e userRepository\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003efind\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e relations\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'photos'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token comment\"\u003e// or from inverse side\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e photoRepository \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e connection\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egetRepository\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ePhoto\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e photos \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e photoRepository\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003efind\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e relations\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'user'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token comment\"\u003e// using query builder\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e users \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e connection\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egetRepository\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eUser\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ecreateQueryBuilder\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'user'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eleftJoinAndSelect\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'user.photos'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'photo'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egetMany\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token comment\"\u003e// or from inverse side\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e photos \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e connection\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egetRepository\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ePhoto\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ecreateQueryBuilder\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'photo'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eleftJoinAndSelect\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'photo.user'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'user'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egetMany\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"manytomany\"\u003eManyToMany\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#manytomany\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e@ManyToMany() 관계에서는 \u003ccode class=\"inline-code\"\u003e@JoinTable()이 반드시 필요합니다\u003c/code\u003e. 한쪽 테이블에만 @JoinTable()을 넣어주면 됩니다.\u003c/li\u003e\n\u003cli\u003e단, @ManyToMany()에서 옵션 cascade가 true인 경우 soft delete를 할 수 있습니다. 필요에 따라 사용할 수 있습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eCategory\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003ePrimaryGeneratedColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  id\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003enumber\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  name\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eQuestion\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003ePrimaryGeneratedColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  id\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003enumber\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  title\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  text\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eManyToMany\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e Category\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eJoinTable\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  categories\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Category\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token comment\"\u003e// using find* method\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e questionRepository \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e connection\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egetRepository\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eQuestion\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e questions \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e questionRepository\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003efind\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e relations\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'categories'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token comment\"\u003e// using query builder\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e questions \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e connection\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egetRepository\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eQuestion\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ecreateQueryBuilder\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'question'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eleftJoinAndSelect\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'question.categories'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'category'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egetMany\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"tree-entity\"\u003eTree entity\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#tree-entity\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eTypeORM은 트리 구조를 저장하기 위해 인접 목록 및 클로저 테이블 패턴을 지원합니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"먼저-셀프조인에-예시에-대해-알아보겠습니다\"\u003e먼저 셀프조인에 예시에 대해 알아보겠습니다.\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#먼저-셀프조인에-예시에-대해-알아보겠습니다\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e1개의 테이블에서 부모-자식 관계를 나타낼 수 있는 패턴\u003c/li\u003e\n\u003cli\u003e상품 카테고리(소,중,대분류)\u003c/li\u003e\n\u003cli\u003e사원(사원,관리자,상위관리자)\u003c/li\u003e\n\u003cli\u003e지역(읍/면/동,구/군,시/도)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"typeorm은-셀프조인을-아래와-같은-4가지-패턴으로-지원합니다\"\u003eTypeORM은 셀프조인을 아래와 같은 4가지 패턴으로 지원합니다.\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#typeorm은-셀프조인을-아래와-같은-4가지-패턴으로-지원합니다\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003ch4 id=\"adjacency-list\"\u003eAdjacency list\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#adjacency-list\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e자기참조를 @ManyToOne(), @OneToMany() 데코레이터로 표현할 수 있습니다.\u003c/li\u003e\n\u003cli\u003e이 방식은 간단한 것이 가장 큰 장점이지만, JOIN하는데 제약이 있어 큰 트리를 로드하는데 문제가 있습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eCategory\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003ePrimaryGeneratedColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  id\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003enumber\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  name\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  description\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eManyToOne\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003etype\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e Category\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecategory\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e category\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003echildren\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  parent\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Category\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eOneToMany\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003etype\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e Category\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecategory\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e category\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eparent\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  children\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Category\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"nested-set\"\u003eNested set\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#nested-set\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e@Tree(), @TreeChildren(), @TreeParent()를 사용한 또 다른 패턴입니다.\u003c/li\u003e\n\u003cli\u003e읽기 작업에는 효과적이지만 쓰기 작업에는 효과적이지 않습니다.\u003c/li\u003e\n\u003cli\u003e여러 개의 루트를 가질 수 없다는 점도 문제입니다.\u003c/li\u003e\n\u003cli\u003e@Tree()의 인자로 \u003ccode class=\"inline-code\"\u003enested-set\u003c/code\u003e이 들어갑니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eTree\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'nested-set'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eCategory\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003ePrimaryGeneratedColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  id\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003enumber\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  name\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eTreeChildren\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  children\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Category\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eTreeParent\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  parent\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Category\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"materialized-path\"\u003eMaterialized path\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#materialized-path\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e구체화된 경로 혹은 경로 열거라고 부릅니다.\u003c/li\u003e\n\u003cli\u003e간단하고 효율적입니다.\u003c/li\u003e\n\u003cli\u003enested set과 사용방법은 같습니다.\u003c/li\u003e\n\u003cli\u003e@Tree()의 인자로 \u003ccode class=\"inline-code\"\u003ematerialized-path\u003c/code\u003e이 들어갑니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  Entity\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  Tree\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  Column\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  PrimaryGeneratedColumn\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  TreeChildren\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  TreeParent\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  TreeLevelColumn\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'typeorm'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eTree\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'materialized-path'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eCategory\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003ePrimaryGeneratedColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  id\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003enumber\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  name\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eTreeChildren\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  children\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Category\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eTreeParent\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  parent\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Category\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"closure-table\"\u003eClosure table\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#closure-table\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e부모와 자식 사이의 관계를 분리된 테이블에 특별한 방법으로 저장합니다.\u003c/li\u003e\n\u003cli\u003e읽기와 쓰기 모두 효율적으로 할 수 있습니다.\u003c/li\u003e\n\u003cli\u003enested set과 사용방법은 같습니다.\u003c/li\u003e\n\u003cli\u003e@Tree()의 인자로 closure-table이 들어갑니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  Entity\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  Tree\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  Column\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  PrimaryGeneratedColumn\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  TreeChildren\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  TreeParent\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  TreeLevelColumn\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'typeorm'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eTree\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'closure-table'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eCategory\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003ePrimaryGeneratedColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  id\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003enumber\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  name\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eTreeChildren\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  children\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Category\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eTreeParent\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  parent\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Category\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e선택적 매개 변수 옵션을 @Tree ( \"closure-table\", options)로 설정하여 클로저 테이블 이름 또는 클로저 테이블 열 이름을 지정할 수 있습니다.\u003c/li\u003e\n\u003cli\u003eancestorColumnName 및 descandantColumnName은 기본 열의 메타 데이터를 수신하고 열의 이름을 반환하는 콜백 함수입니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eTree\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"closure-table\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    closureTableName\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"category_closure\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"token function-variable function\"\u003eancestorColumnName\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecolumn\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"ancestor_\"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e column\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003epropertyName\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"token function-variable function\"\u003edescendantColumnName\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecolumn\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"descendant_\"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e column\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003epropertyName\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"joincolumnjointable에-대해-조금-더-알아보겠습니다\"\u003eJoinColumn/JoinTable에 대해 조금 더 알아보겠습니다.\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#joincolumnjointable에-대해-조금-더-알아보겠습니다\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e아래는 아래 2개의 데코레이터에 공통으로 사용할 수 있는 옵션입니다.\n\u003cul\u003e\n\u003cli\u003eeager 옵션이 있어서 N+1 문제를 제어할 수 있음\u003c/li\u003e\n\u003cli\u003ecascade, onDelete 옵션이 있어 관계가 연결된 객체를 추가/수정/삭제되도록 할 수 있습니다. 버그를 유발할 수 있으니 주의해서 사용해야 합니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"n1-문제란\"\u003eN+1 문제란?\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#n1-문제란\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e하위 엔티티들을 첫 쿼리 실행시 한번에 가져오지 않고, Lazy Loading으로 필요한 곳에서 사용되어 쿼리가 실행될때 발생하는 문제가 N+1 쿼리 문제입니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"joincolumn\"\u003eJoinColumn\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#joincolumn\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e@JoinColumn()을 사용하면 테이블에 자동으로 칼럼명과 참조 칼럼명을 합친 이름의 칼럼을 만들어냅니다.\u003c/li\u003e\n\u003cli\u003e외래키를 가진 칼럼명과 참조칼럼명을 설정할 수 있는 옵션을 가지고 있습니다.\u003c/li\u003e\n\u003cli\u003e설정하지 않으면 테이블명을 가지고 자동으로 매핑합니다.\u003c/li\u003e\n\u003cli\u003e주의할 점으로는 @ManyToOne()에서는 꼭 적지 않아도 칼럼을 자동으로 만들어주지만, \u003ccode class=\"inline-code\"\u003e@OneToOne()에서는 반드시 적어줘야 합니다\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003ePost\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eManyToOne\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003etype\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e Category\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eJoinColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    name\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'category_id'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    referencedColumnName\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'name'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  category\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Category\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eCategory\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003ePrimaryGeneratedColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  id\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003enumber\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  name\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"jointable\"\u003eJoinTable\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#jointable\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode class=\"inline-code\"\u003eM:N 관계\u003c/code\u003e에서 사용하며 연결 테이블을 설정할 수 있습니다.\u003c/li\u003e\n\u003cli\u003e@JoinTable()의 옵션을 사용해 연결 테이블의 칼럼명과 참조 칼럼명을 설정할 수 있습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eQuestion\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eManyToMany\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003etype\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e Category\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eJoinTable\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    name\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'question_categories'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    joinColumn\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      name\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'question'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      referencedColumnName\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'id'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    inverseJoinColumn\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      name\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'category'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      referencedColumnName\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'id'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  categories\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Category\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eCategory\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003ePrimaryGeneratedColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  id\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003enumber\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  name\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"relationid\"\u003eRelationId\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#relationid\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e1:N/M:N 관계에서 entity에 명시적으로 관계가 있는 테이블의 칼럼 id를 적고싶은 경우, @RelationId()를 사용하면 됩니다.\u003c/li\u003e\n\u003cli\u003e@RelationId()가 꼭 필요하지는 않지만 entity를 보면서 칼럼을 한 눈에 볼 수 있다는 장점이 있습니다.\u003c/li\u003e\n\u003cli\u003e@RelationId()로 테이블을 조회하면 새로운 칼럼명도 결과에 같이 들고올 수 있습니다.\u003c/li\u003e\n\u003cli\u003e하지만 relationId 칼럼에 삽입하여 사용할 수 없습니다.\n\u003cul\u003e\n\u003cli\u003einset or update 시 payload에 relationId가 아닌 relation으로 사용해야 합니다.\u003c/li\u003e\n\u003cli\u003e관련 이슈 : \u003ca href=\"https://github.com/typeorm/typeorm/issues/3867\"\u003ehttps://github.com/typeorm/typeorm/issues/3867\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e@RelationId를 사용하는 대신 @Column으로 relationId를 장식 할 수 있습니다. JoinColumn의 이름이 숫자열 이름과 같을 때 TypeORM이 둘 다 일치하고 userId를 설정하거나 사용자를 설정하면 TypeORM이 처리합니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token comment\"\u003e// using many to one\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003ePost\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eManyToOne\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003etype\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e Category\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  category\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Category\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eRelationId\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epost\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Post\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e post\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ecategory\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  categoryId\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003enumber\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token comment\"\u003e// using many to many\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003ePost\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eManyToMany\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003etype\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e Category\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  categories\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Category\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eRelationId\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epost\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Post\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e post\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ecategories\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  categoryIds\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003enumber\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"subscriber\"\u003eSubscriber\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#subscriber\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e데이터베이스에 특화된 리스너로 CRUD 이벤트 발생을 리슨합니다.\u003c/li\u003e\n\u003cli\u003e다음과 같은 데코레이터들을 가지고 있습니다.\n\u003cul\u003e\n\u003cli\u003e@AfterLoad, @AfterInsert, @BeforeInsert, @AfterUpdate, @BeforeUpdate, @AfterRemove, @BeforeRemove\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003elogging 옵션이 있긴 하지만 쿼리만을 보여주기 때문에 한 줄씩 분석하기 위해 로그를 남기는 경우에는 지양하는 것이 좋습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  Connection\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  EntitySubscriberInterface\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  EventSubscriber\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  InsertEvent\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'typeorm/index'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e User \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'./User'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEventSubscriber\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eUserSubscriber\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eimplements\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eEntitySubscriberInterface\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003eUser\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token function\"\u003econstructor\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003econnection\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Connection\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    connection\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003esubscribers\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003epush\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token function\"\u003elistenTo\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e User\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token function\"\u003ebeforeInsert\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e InsertEvent\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003eUser\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003ePromise\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"token builtin\"\u003eany\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token operator\"\u003e|\u003c/span\u003e \u003cspan class=\"token keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"token builtin\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'User 테이블에 입력 전 : '\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e event\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eentity\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token function\"\u003eafterInsert\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eevent\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e InsertEvent\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003eUser\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003ePromise\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"token builtin\"\u003eany\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token operator\"\u003e|\u003c/span\u003e \u003cspan class=\"token keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"token builtin\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'User 테이블에 입력 후 : '\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e event\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eentity\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"index\"\u003eIndex\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#index\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e테이블 \u003ccode class=\"inline-code\"\u003e쿼리 속도\u003c/code\u003e를 올려주는 자료구조입니다.\u003c/li\u003e\n\u003cli\u003e테이블 내 1개 혹은 그 이상의 칼럼을 이용해 생성할 수 있습니다.\u003c/li\u003e\n\u003cli\u003e인덱스는 보통 키-필드만 갖고있고, 테이블의 다른 세부항목을 갖지 않기때문에 보통 테이블을 저장하는 공간보다 더 \u003ccode class=\"inline-code\"\u003e적은 공간\u003c/code\u003e을 차지합니다.\u003c/li\u003e\n\u003cli\u003e특정 칼럼 값을 가지고 있는 열이나 값을 \u003ccode class=\"inline-code\"\u003e빠르게 찾기\u003c/code\u003e 위해 사용합니다.\n\u003cul\u003e\n\u003cli\u003e인덱싱하지 않은 경우는 첫번째 열부터 전체 테이블을 걸쳐 연관된 열을 검색하기때문에 테이블이 클수록 쿼리비용이 커집니다.\u003c/li\u003e\n\u003cli\u003e인덱싱을 한 경우는 모든 데이터를 조회하지 않고 데이터 파일의 중간에서 검색위치를 빠르게 잡을 수 있습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode class=\"inline-code\"\u003eWHERE\u003c/code\u003e절과 일치하는 열을 빨리 찾기 위해서 사용합니다.\u003c/li\u003e\n\u003cli\u003e\u003ccode class=\"inline-code\"\u003eJOIN\u003c/code\u003e을 실행할 때 다른 테이블에서 열을 추출하기 위해서 사용합니다.\u003c/li\u003e\n\u003cli\u003e데이터 양이 많고 변경보다 \u003ccode class=\"inline-code\"\u003e검색이 빈번한 경우\u003c/code\u003e 인덱싱을 하면 좋습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003e쉽게 말해 책에서 transaction이란 주제가 어딨는지 목차 없이 찾으려면 눈물날지도 모릅니다. 책의 주요내용을 가나다순으로 정리한 목록이 있으면 찾기 쉬울텐데 인덱스가 바로 그 역할을 합니다.\n특정 칼럼에 인덱스를 걸 수 있습니다. 옵션으로 고유키를 부여할 수도 있습니다. 단일 칼럼에 인덱스를 걸고 싶으면 칼럼마다 추가할 수도 있지만, 테이블 전체에 인덱스를 걸고싶은 경우 @Entity()아래 @Index()를 추가할 수도 있습니다.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token comment\"\u003e// using with single column\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eUser\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eIndex\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  firstName\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eIndex\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e unique\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  lastName\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token comment\"\u003e// using with entity\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eIndex\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'firstName'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'lastName'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e unique\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eUser\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  firstName\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  lastName\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"unique\"\u003eUnique\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#unique\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e특정 칼럼에 고유키 제약조건을 생성할 수 있습니다.\u003c/li\u003e\n\u003cli\u003e@Unique()는 테이블 자체에만 적용하는 것이 가능합니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eUnique\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'firstName'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'lastName'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eUser\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  firstName\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  lastName\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"check\"\u003eCheck\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#check\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e테이블에서 데이터 추가 쿼리가 날아오면 값을 체크하는 역할을 합니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eEntity\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eCheck\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'\"age\" \u003e 18'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eUser\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  firstName\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  firstName\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eColumn\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  age\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003enumber\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"transaction\"\u003eTransaction\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#transaction\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e데이터베이스 내에서 하나의 \u003ccode class=\"inline-code\"\u003e그룹으로 처리해야하는 명령문\u003c/code\u003e을 모아서 처리하는 작업의 단위를 말합니다.\n\u003cul\u003e\n\u003cli\u003e여러 단계의 처리를 \u003ccode class=\"inline-code\"\u003e하나의 처리처럼\u003c/code\u003e 다루는 기능입니다.\u003c/li\u003e\n\u003cli\u003e여러 개의 명령어의 집합이 정상적으로 처리되면 정상종료됩니다.\u003c/li\u003e\n\u003cli\u003e하나의 명령어라도 \u003ccode class=\"inline-code\"\u003e잘못되면 전체 취소\u003c/code\u003e됩니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e트랜잭션을 쓰는 이유는 \u003ccode class=\"inline-code\"\u003e데이터의 일관성\u003c/code\u003e을 유지하면서 \u003ccode class=\"inline-code\"\u003e안정적으로 데이터를 복구\u003c/code\u003e하기 위함입니다.\u003c/li\u003e\n\u003cli\u003e격리성 수준 설정을 통해 트랜잭션이 열려있는 동안 외부에서 해당 데이터에 접근하지 못하도록 락을 걸 수 있습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"격리성-수준\"\u003e격리성 수준\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#격리성-수준\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eREAD UNCOMMITTED\u003c/li\u003e\n\u003cli\u003eREAD COMMITTED\u003c/li\u003e\n\u003cli\u003eREPEATABLE READ\u003c/li\u003e\n\u003cli\u003eSERIALIZABLE\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"global-connection을-열어서-트랜젝션을-사용하는-경우는-아래와-같이-사용합니다\"\u003eglobal connection을 열어서 트랜젝션을 사용하는 경우는 아래와 같이 사용합니다.\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#global-connection을-열어서-트랜젝션을-사용하는-경우는-아래와-같이-사용합니다\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e \u003cspan class=\"token function\"\u003egetManager\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003etransaction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token string\"\u003e'SERIALIZABLE'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003etransactionalEntityManager\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"하지만-global-connection은-사이드이펙트가-많은-방법이기때문에-데코레이터나-queryrunner를-사용한-방법을-추천합니다\"\u003e하지만 global connection은 사이드이펙트가 많은 방법이기때문에 데코레이터나 queryRunner를 사용한 방법을 추천합니다.\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#하지만-global-connection은-사이드이펙트가-많은-방법이기때문에-데코레이터나-queryrunner를-사용한-방법을-추천합니다\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e아래는 데코레이터 @Transaction(), @TransactionManager(), @TransactionRepository()를 사용한 패턴입니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token comment\"\u003e// using transaction manager\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eTransaction\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e isolation\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'SERIALIZABLE'\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token function\"\u003esave\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eTransactionManager\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e manager\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e EntityManager\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e user\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e User\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e manager\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003esave\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003euser\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token comment\"\u003e// using transaction repository\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eTransaction\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e isolation\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'SERIALIZABLE'\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token function\"\u003esave\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003euser\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e User\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eTransactionRepository\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eUser\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e userRepository\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Repository\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003eUser\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e userRepository\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003esave\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003euser\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"아래는-queryrunner를-사용한-방법입니다-다만-이-방법에서는-격리성-수준-설정이-불가능합니다\"\u003e아래는 queryRunner를 사용한 방법입니다. 다만 이 방법에서는 격리성 수준 설정이 불가능합니다.\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#아래는-queryrunner를-사용한-방법입니다-다만-이-방법에서는-격리성-수준-설정이-불가능합니다\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003estartTransaction은 트랜잭션을 시작하는 메서드\u003c/li\u003e\n\u003cli\u003ecommitTransaction는 모든 변경사항을 커밋하는 메서드\u003c/li\u003e\n\u003cli\u003erollbackTransaction는 모든 변경사항을 되돌리는 메서드\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e queryRunner\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003estartTransaction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003etry\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e queryRunner\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003emanager\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003esave\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003euser\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e queryRunner\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003emanager\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003esave\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ephotos\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e queryRunner\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ecommitTransaction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ecatch\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eerr\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e queryRunner\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003erollbackTransaction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efinally\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e queryRunner\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003erelease\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"eager-and-lazy-relations\"\u003eEager and Lazy Relations\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#eager-and-lazy-relations\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003ch4 id=\"eager\"\u003eeager\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#eager\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003erelationship을 설정하지 않아도 eager를 설정하면 자동으로 relationship을 불러옵니다.\n\u003cul\u003e\n\u003cli\u003efind* (즉, find, findAll, findOne...)에서 자동으로 relationship을 불러옵니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eManyToMany\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003etype \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e Category\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e category \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e category\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003equestions\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  eager\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"lazy\"\u003elazy\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#lazy\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003ePromise로 반환하면, 자동으로 lazy relationship이 됩니다.\n\u003cul\u003e\n\u003cli\u003elazy를 불러올 때는 Promise.resolve를 하던가, await로 불러오면 됩니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eManyToMany\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003etype \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e Question\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e question \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e question\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ecategories\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003equestions\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003ePromise\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003eQuestion\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cpre class=\"language-ts optimized-code-block\" style=\"max-height: 600px; overflow-y: auto;\"\u003e\u003ccode class=\"language-ts code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e question \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e connection\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egetRepository\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eQuestion\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003efindOne\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e categories \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e question\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ecategories\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e참고 : 다른 언어 (자바, PHP 등)에서 왔고 모든 곳에서 게으른 관계를 사용하는 데 익숙하다면 조심하세요. 이러한 언어는 비동기식이 아니며 지연로드는 다른 방식으로 이루어집니다. 그렇기 때문에 거기에서 promise를 사용하지 않습니다. 자바 스크립트와 Node.JS에서 지연로드 된 관계를 원하면 promise를 사용해야합니다. 이것은 비표준 기술이며 TypeORM에서 실험적인 것으로 간주됩니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"typeorm의-bigint\"\u003etypeorm의 bigint\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#typeorm의-bigint\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003etypeorm bigint는 number로 바꿔주지 않습니다. string입니다.\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://typeorm.io/entities#column-types\"\u003eNote about bigint type: bigint column type, used in SQL databases, doesn’t fit into the regular number type and maps property to a string instead.\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"참고\"\u003e참고\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#참고\"\u003e\u003cspan class=\"anchor\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://velog.io/@josworks27/typeORM-%EC%8B%9C%EC%9E%91%ED%95%98%EA%B8%B0\"\u003eTypeORM 시작하기\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://yangeok.github.io/orm/2020/12/14/typeorm-decorators.html\"\u003eTypeORM 데코레이터 씹어먹기\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://gkqlgkql.tistory.com/85\"\u003e개발자 마르코\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e"])</script><script>self.__next_f.push([1,"4:[\"$\",\"$Ld\",null,{\"post\":{\"slug\":\"/backend/typeorm-톺아보기\",\"frontmatter\":{\"title\":\"typeorm 톺아보기\",\"date\":\"2021-03-09T09:03:06.000Z\",\"category\":\"backend\",\"tags\":[\"node\",\"sql\",\"db\",\"rdb\",\"typeorm\",\"orm\"],\"draft\":false},\"content\":\"$e\",\"html\":\"$f\",\"excerpt\":\"- Node와 RDB의 ORM 서비스는 sequelize, typeorm, prisma 등 많은 라이브러리들이 있습니다. - 가장 먼저 사용한 ORM 서비스는 sequelize 였지만 typeorm이 typescript 지원이나 시장의 흐름에 따라 조금 더 많이 사용된다고 생각되어 공부하게 되었습니다.    - prisma도 고려해 보았으나 아직은 시기상\"},\"previousPost\":{\"slug\":\"/design-pattern/builder-pattern\",\"frontmatter\":{\"title\":\"builder pattern\",\"date\":\"2021-03-07T12:03:46.000Z\",\"category\":\"design pattern\",\"tags\":[\"design pattern\"],\"draft\":false}},\"nextPost\":{\"slug\":\"/design-pattern/visitor-pattern\",\"frontmatter\":{\"title\":\"visitor pattern\",\"date\":\"2021-03-13T11:03:33.000Z\",\"category\":\"design pattern\",\"tags\":[],\"draft\":false}}}]\na:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"typeorm 톺아보기\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"- Node와 RDB의 ORM 서비스는 sequelize, typeorm, prisma 등 많은 라이브러리들이 있습니다. - 가장 먼저 사용한 ORM 서비스는 sequelize 였지만 typeorm이 typescript 지원이나 시장의 흐름에 따라 조금 더 많이 사용된다고 생각되어 공부하게 되었습니다.    - prisma도 고려해 보았으나 아직은 시기상\"}]]\n3:null\n"])</script></body></html>