(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{O3T9:function(e,t,a){"use strict";a.r(t),a.d(t,"CODE",(function(){return l})),a.d(t,"TableContext",(function(){return u})),a.d(t,"START_GAME",(function(){return E})),a.d(t,"OPEN_CELL",(function(){return s})),a.d(t,"CLICK_MINE",(function(){return d})),a.d(t,"FLAG_CELL",(function(){return N})),a.d(t,"QUESTION_CELL",(function(){return O})),a.d(t,"NORMALIZE_CELL",(function(){return b})),a.d(t,"INCREMENT_TIMER",(function(){return I}));var n=a("KQm4"),r=a("q1tI"),c=a.n(r),l={MINE:-7,NORMAL:-1,QUESTION:-2,FLAG:-3,QUESTION_MINE:-4,FLAG_MINE:-5,CLICKED_MINE:-6,OPEN_MINE:-8,OPENED:0},u=Object(r.createContext)({tableData:[],halted:!0,dispatch:null,openedCount:0}),o={tableData:[],data:{row:0,cell:0,mine:0},timer:0,result:"",halted:!0,openedCount:0},i=function(e,t,a){for(var n=Array(e*t).fill(0).map((function(e,t){return t})),r=[];n.length>e*t-a;){var c=n.splice(Math.floor(Math.random()*n.length),1)[0];r.push(c)}for(var u=[],o=0;o<e;o++){var i=[];u.push(i);for(var E=0;E<t;E++)i.push(l.NORMAL)}for(var s=0;s<r.length;s++){var d=Math.floor(r[s]/t),N=r[s]%t;u[d][N]=l.MINE}return u},E="START_GAME",s="OPEN_CELL",d="CLICK_MINE",N="FLAG_CELL",O="QUESTION_CELL",b="NORMALIZE_CELL",I="INCREMENT_TIMER",f=function(e,t){switch(t.type){case E:return Object.assign({},e,{data:{row:t.row,cell:t.cell,mine:t.mine},openedCount:0,tableData:i(t.row,t.cell,t.mine),halted:!1,timer:0});case s:var a=Object(n.a)(e.tableData);if(a.forEach((function(e,t){a[t]=Object(n.a)(e)})),!e.openedCount&&l.MINE===a[t.row][t.cell]){for(var r=[],c=0;c<e.data.row;c++){var u=[];r.push(u);for(var o=0;o<e.data.cell;o++)u.push(!1)}var f=!1;!function t(n,c){var u;if(!f&&!(n<0||n>=e.data.row||c<0||c>=e.data.cell||r[n][c])){if(r[n][c]=!0,l.NORMAL===(null===(u=a[n])||void 0===u?void 0:u[c]))return a[n][c]=l.MINE,void(f=!0);t(n-1,c-1),t(n-1,c),t(n-1,c+1),t(n,c-1),t(n,c+1),t(n+1,c-1),t(n+1,c),t(n+1,c+1)}}(t.row,t.cell),a[t.row][t.cell]=l.NORMAL}var M=[],h=0;!function t(n,r){if(n<0||n>=a.length||r<0||r>=a[0].length)return Object.assign({},e);if(![l.OPENED,l.FLAG,l.FLAG_MINE,l.QUESTION_MINE,l.QUESTION].includes(a[n][r])&&!M.includes(n+"/"+r)){M.push(n+"/"+r);var c=[a[n][r-1],a[n][r+1]];a[n-1]&&(c=c.concat([a[n-1][r-1],a[n-1][r],a[n-1][r+1]])),a[n+1]&&(c=c.concat([a[n+1][r-1],a[n+1][r],a[n+1][r+1]]));var u=c.filter((function(e){return[l.MINE,l.FLAG_MINE,l.QUESTION_MINE].includes(e)})).length;if(0===u&&n>-1){var o=[];n-1>-1&&(o.push([n-1,r-1]),o.push([n-1,r]),o.push([n-1,r+1])),o.push([n,r-1]),o.push([n,r+1]),n+1<a.length&&(o.push([n+1,r-1]),o.push([n+1,r]),o.push([n+1,r+1])),o.forEach((function(e){a[e[0]][e[1]]!==l.OPENED&&t(e[0],e[1])}))}a[n][r]===l.NORMAL&&(h+=1),a[n][r]=u}}(t.row,t.cell);var p=!1,C="";return e.data.row*e.data.cell-e.data.mine===e.openedCount+h&&(p=!0,C=e.timer+"초만에 승리하셨습니다"),Object.assign({},e,{tableData:a,openedCount:e.openedCount+h,halted:p,result:C});case d:var v=Object(n.a)(e.tableData);return v.forEach((function(e,t){v[t]=Object(n.a)(e)})),v.forEach((function(e,t){e.forEach((function(e,a){v[t][a]!==l.MINE&&v[t][a]!==l.FLAG_MINE&&v[t][a]!==l.QUESTION_MINE||(v[t][a]=l.OPEN_MINE)}))})),v[t.row][t.cell]=l.CLICKED_MINE,Object.assign({},e,{tableData:v,halted:!0});case N:var w=Object(n.a)(e.tableData);return w[t.row]=Object(n.a)(e.tableData[t.row]),w[t.row][t.cell]===l.MINE?w[t.row][t.cell]=l.FLAG_MINE:w[t.row][t.cell]=l.FLAG,Object.assign({},e,{tableData:w});case O:var L=Object(n.a)(e.tableData);return L[t.row]=Object(n.a)(e.tableData[t.row]),L[t.row][t.cell]===l.FLAG_MINE?L[t.row][t.cell]=l.QUESTION_MINE:L[t.row][t.cell]=l.QUESTION,Object.assign({},e,{tableData:L});case b:var m=Object(n.a)(e.tableData);return m[t.row]=Object(n.a)(e.tableData[t.row]),m[t.row][t.cell]===l.QUESTION_MINE?m[t.row][t.cell]=l.MINE:m[t.row][t.cell]=l.NORMAL,Object.assign({},e,{tableData:m});case I:return Object.assign({},e,{timer:e.timer+1});default:return e}};t.default=function(){var e=Object(r.useReducer)(f,o),t=e[0],a=e[1],n=t.tableData,l=t.halted,i=t.timer,E=t.result,s=t.openedCount,d=Object(r.useMemo)((function(){return{tableData:n,halted:l,dispatch:a,openedCount:s}}),[n,l,s]);return Object(r.useEffect)((function(){var e;return!1===l&&(e=setInterval((function(){a({type:I})}),1e3)),function(){clearInterval(e)}}),[l]),c.a.createElement(u.Provider,{value:d},c.a.createElement(M,null),c.a.createElement("div",null,i),c.a.createElement(h,null),c.a.createElement("div",null,E))};var M=Object(r.memo)((function(){var e=Object(r.useState)(10),t=e[0],a=e[1],n=Object(r.useState)(10),l=n[0],o=n[1],i=Object(r.useState)(20),s=i[0],d=i[1],N=Object(r.useContext)(u).dispatch,O=Object(r.useCallback)((function(e){a(e.target.value)}),[]),b=Object(r.useCallback)((function(e){o(e.target.value)}),[]),I=Object(r.useCallback)((function(e){d(e.target.value)}),[]),f=Object(r.useCallback)((function(){N({type:E,row:t,cell:l,mine:s})}),[t,l,s]);return c.a.createElement("div",null,c.a.createElement("input",{type:"number",placeholder:"세로",value:t,onChange:O}),c.a.createElement("input",{type:"number",placeholder:"가로",value:l,onChange:b}),c.a.createElement("input",{type:"number",placeholder:"지뢰",value:s,onChange:I}),c.a.createElement("button",{onClick:f},"시작"))})),h=Object(r.memo)((function(){var e=Object(r.useContext)(u).tableData;return c.a.createElement("table",{style:{width:"unset"}},c.a.createElement("tbody",null,Array(e.length).fill(0).map((function(e,t){return c.a.createElement(p,{key:"tr-"+t,rowIndex:t})}))))})),p=Object(r.memo)((function(e){var t,a=e.rowIndex,n=Object(r.useContext)(u).tableData;if(null!==(t=n[0])&&void 0!==t&&t.length)return c.a.createElement("tr",null,Array(n[0].length).fill(0).map((function(e,t){return c.a.createElement(v,{key:"td-"+t,rowIndex:a,cellIndex:t})})))})),C=function(e){switch(e){case l.NORMAL:case l.MINE:return{background:"#444"};case l.CLICKED_MINE:return{background:"red"};case l.OPEN_MINE:case l.OPENED:return{background:"white"};case l.QUESTION_MINE:case l.QUESTION:return{background:"yellow"};case l.FLAG_MINE:case l.FLAG:return{background:"red"};default:return{background:"white"}}},v=Object(r.memo)((function(e){var t=e.rowIndex,a=e.cellIndex,n=Object(r.useContext)(u),o=n.tableData,i=n.dispatch,E=n.halted,I=n.openedCount,f=Object(r.useCallback)((function(){if(!E)if(I)switch(o[t][a]){case l.OPENED:case l.FLAG_MINE:case l.FLAG:case l.QUESTION_MINE:case l.QUESTION:return;case l.NORMAL:return void i({type:s,row:t,cell:a});case l.MINE:return void i({type:d,row:t,cell:a});default:return}else i({type:s,row:t,cell:a})}),[o[t][a],E,I]),M=Object(r.useCallback)((function(e){if(e.preventDefault(),!E)switch(o[t][a]){case l.NORMAL:case l.MINE:return void i({type:N,row:t,cell:a});case l.FLAG_MINE:case l.FLAG:return void i({type:O,row:t,cell:a});case l.QUESTION_MINE:case l.QUESTION:return void i({type:b,row:t,cell:a});default:return}}),[o[t][a],E]);return c.a.createElement(w,{onClickTd:f,onRightClickTd:M,data:o[t][a]})})),w=Object(r.memo)((function(e){var t=e.onClickTd,a=e.onRightClickTd,n=e.data;return c.a.createElement("td",{style:Object.assign({},C(n),{width:60,height:60,padding:0,textAlign:"center"}),onClick:t,onContextMenu:a},function(e){switch(e){case l.NORMAL:return"";case l.MINE:return"X";case l.CLICKED_MINE:case l.OPEN_MINE:return"펑";case l.FLAG_MINE:case l.FLAG:return"!";case l.QUESTION_MINE:case l.QUESTION:return"?";default:return e||""}}(n))}))}}]);
//# sourceMappingURL=component---src-pages-mine-search-tsx-20692acec4ad52cf446d.js.map