{"version":3,"sources":["webpack:///./src/pages/mine-search.tsx"],"names":["CODE","MINE","NORMAL","QUESTION","FLAG","QUESTION_MINE","FLAG_MINE","CLICKED_MINE","OPENED","TableContext","createContext","tableData","halted","dispatch","initialState","data","row","cell","mine","timer","result","openedCount","plantMine","candidate","Array","fill","map","_","i","shuffle","length","chosen","splice","Math","floor","random","push","rowData","j","k","ver","hor","START_GAME","OPEN_CELL","CLICK_MINE","FLAG_CELL","QUESTION_CELL","NORMALIZE_CELL","INCREMENT_TIMER","reducer","state","action","type","forEach","checked","checkAround","includes","around","concat","count","filter","v","near","n","MineSearch","useReducer","value","useMemo","useEffect","setInterval","clearInterval","Provider","Form","Table","memo","useState","setRow","setCell","setMine","useContext","onChangeRow","useCallback","e","target","onChangeCell","onChangeMine","onClickBtn","placeholder","onChange","onClick","style","width","Tr","key","rowIndex","Td","cellIndex","getTdStyle","code","background","onClickTd","onRightClickTd","preventDefault","RealTd","height","padding","textAlign","onContextMenu","getTdText"],"mappings":"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","file":"component---src-pages-mine-search-tsx-b0062d0bd7d7597bee78.js","sourcesContent":["import React, {\n  useEffect,\n  useReducer,\n  createContext,\n  useMemo,\n  useCallback,\n  memo,\n  useState,\n  useContext,\n} from 'react';\n\n// 상태값 저장\nexport const CODE = {\n  MINE: -7,\n  NORMAL: -1,\n  QUESTION: -2,\n  FLAG: -3,\n  QUESTION_MINE: -4,\n  FLAG_MINE: -5,\n  CLICKED_MINE: -6,\n  OPENED: 0, // 0 이상이면 다 opened\n};\n\n// 공동 Store\nexport const TableContext = createContext({\n  tableData: [],\n  halted: true,\n  dispatch: null,\n});\n\n// 초기값\nconst initialState = {\n  tableData: [],\n  data: {\n    row: 0,\n    cell: 0,\n    mine: 0,\n  },\n  timer: 0,\n  result: '',\n  halted: true,\n  openedCount: 0,\n};\n\n// 지뢰 세팅\nconst plantMine = (row: number, cell: number, mine: number) => {\n  const candidate = Array(row * cell)\n    .fill(0)\n    .map((_, i) => {\n      return i;\n    });\n  const shuffle = [];\n  while (candidate.length > row * cell - mine) {\n    const chosen = candidate.splice(\n      Math.floor(Math.random() * candidate.length),\n      1,\n    )[0];\n    shuffle.push(chosen);\n  }\n  const data = [];\n  for (let i = 0; i < row; i++) {\n    const rowData = [];\n    data.push(rowData);\n    for (let j = 0; j < cell; j++) {\n      rowData.push(CODE.NORMAL);\n    }\n  }\n\n  for (let k = 0; k < shuffle.length; k++) {\n    const ver = Math.floor(shuffle[k] / cell);\n    const hor = shuffle[k] % cell;\n    data[ver][hor] = CODE.MINE;\n  }\n\n  return data;\n};\n\n// action\nexport const START_GAME = 'START_GAME';\nexport const OPEN_CELL = 'OPEN_CELL';\nexport const CLICK_MINE = 'CLICK_MINE';\nexport const FLAG_CELL = 'FLAG_CELL';\nexport const QUESTION_CELL = 'QUESTION_CELL';\nexport const NORMALIZE_CELL = 'NORMALIZE_CELL';\nexport const INCREMENT_TIMER = 'INCREMENT_TIMER';\n\nconst reducer = (state, action) => {\n  switch (action.type) {\n    case START_GAME:\n      return {\n        ...state,\n        data: {\n          row: action.row,\n          cell: action.cell,\n          mine: action.mine,\n        },\n        openedCount: 0,\n        tableData: plantMine(action.row, action.cell, action.mine),\n        halted: false,\n        timer: 0,\n      };\n    case OPEN_CELL: {\n      // 메모리 연결 끊기\n      const tableData = [...state.tableData];\n      tableData.forEach((row, i) => {\n        tableData[i] = [...row];\n      });\n\n      const checked = [];\n      let openedCount = 0;\n      const checkAround = (row: number, cell: number) => {\n        // 지뢰 찾기 범위 밖이라면 수행하지 않음\n        if (\n          row < 0 ||\n          row >= tableData.length ||\n          cell < 0 ||\n          cell >= tableData[0].length\n        ) {\n          return;\n        }\n        // 닫힌 칸만 수행\n        if (\n          [\n            CODE.OPENED,\n            CODE.FLAG,\n            CODE.FLAG_MINE,\n            CODE.QUESTION_MINE,\n            CODE.QUESTION,\n          ].includes(tableData[row][cell])\n        ) {\n          return;\n        }\n        // 한 번 연칸은 무시하기\n        if (checked.includes(row + '/' + cell)) {\n          return;\n        }\n\n        // 열어본 칸 배열에 추가\n        checked.push(row + '/' + cell);\n\n        // 좌우\n        let around = [tableData[row][cell - 1], tableData[row][cell + 1]];\n        // 위\n        if (tableData[row - 1]) {\n          around = around.concat([\n            tableData[row - 1][cell - 1],\n            tableData[row - 1][cell],\n            tableData[row - 1][cell + 1],\n          ]);\n        }\n        // 아래\n        if (tableData[row + 1]) {\n          around = around.concat([\n            tableData[row + 1][cell - 1],\n            tableData[row + 1][cell],\n            tableData[row + 1][cell + 1],\n          ]);\n        }\n        // 열 수 없는 칸 필터링\n        const count = around.filter(function (v) {\n          return [CODE.MINE, CODE.FLAG_MINE, CODE.QUESTION_MINE].includes(v);\n        }).length;\n\n        // 주변에 모든 것을 열 수 있음\n        if (count === 0) {\n          // 윗 칸 오픈\n          if (row > -1) {\n            const near = [];\n            // 게임 범위 안이라면\n            if (row - 1 > -1) {\n              near.push([row - 1, cell - 1]);\n              near.push([row - 1, cell]);\n              near.push([row - 1, cell + 1]);\n            }\n            near.push([row, cell - 1]);\n            near.push([row, cell + 1]);\n            // 게임 범위 안이라면\n            if (row + 1 < tableData.length) {\n              near.push([row + 1, cell - 1]);\n              near.push([row + 1, cell]);\n              near.push([row + 1, cell + 1]);\n            }\n            near.forEach((n) => {\n              // 해당 칸이 열려 있지 않다면 해당 칸 여는 알고리즘 시작\n              if (tableData[n[0]][n[1]] !== CODE.OPENED) {\n                checkAround(n[0], n[1]);\n              }\n            });\n          }\n        }\n\n        // 내 칸이 닫힌 칸이면 카운트 증가\n        if (tableData[row][cell] === CODE.NORMAL) {\n          openedCount += 1;\n        }\n        // 지뢰 갯수 추가\n        tableData[row][cell] = count;\n      };\n      // 해당 칸 오픈\n      checkAround(action.row, action.cell);\n      let halted = false;\n      let result = '';\n      // 총 갯수 - 지뢰 갯수 === 이때까지 연 갯수 + 이번에 연 갯수\n      if (\n        state.data.row * state.data.cell - state.data.mine ===\n        state.openedCount + openedCount\n      ) {\n        // 승리\n        halted = true;\n        result = `${state.timer}초만에 승리하셨습니다`;\n      }\n      return {\n        ...state,\n        tableData,\n        openedCount: state.openedCount + openedCount,\n        halted,\n        result,\n      };\n    }\n    case CLICK_MINE: {\n      const tableData = [...state.tableData];\n      tableData[action.row] = [...state.tableData[action.row]];\n      tableData[action.row][action.cell] = CODE.CLICKED_MINE;\n      return {\n        ...state,\n        tableData,\n        halted: true,\n      };\n    }\n    case FLAG_CELL: {\n      const tableData = [...state.tableData];\n      tableData[action.row] = [...state.tableData[action.row]];\n      if (tableData[action.row][action.cell] === CODE.MINE) {\n        tableData[action.row][action.cell] = CODE.FLAG_MINE;\n      } else {\n        tableData[action.row][action.cell] = CODE.FLAG;\n      }\n      return {\n        ...state,\n        tableData,\n      };\n    }\n    case QUESTION_CELL: {\n      const tableData = [...state.tableData];\n      tableData[action.row] = [...state.tableData[action.row]];\n      if (tableData[action.row][action.cell] === CODE.FLAG_MINE) {\n        tableData[action.row][action.cell] = CODE.QUESTION_MINE;\n      } else {\n        tableData[action.row][action.cell] = CODE.QUESTION;\n      }\n      return {\n        ...state,\n        tableData,\n      };\n    }\n    case NORMALIZE_CELL: {\n      const tableData = [...state.tableData];\n      tableData[action.row] = [...state.tableData[action.row]];\n      if (tableData[action.row][action.cell] === CODE.QUESTION_MINE) {\n        tableData[action.row][action.cell] = CODE.MINE;\n      } else {\n        tableData[action.row][action.cell] = CODE.NORMAL;\n      }\n      return {\n        ...state,\n        tableData,\n      };\n    }\n    case INCREMENT_TIMER: {\n      return {\n        ...state,\n        timer: state.timer + 1,\n      };\n    }\n    default:\n      return state;\n  }\n};\n\n// 게임\nconst MineSearch = () => {\n  const [state, dispatch] = useReducer(reducer, initialState);\n  const { tableData, halted, timer, result } = state;\n\n  const value = useMemo(() => ({ tableData, halted, dispatch }), [\n    tableData,\n    halted,\n  ]);\n\n  useEffect(() => {\n    let timer;\n    if (halted === false) {\n      // 게임 시간초 증가\n      timer = setInterval(() => {\n        dispatch({ type: INCREMENT_TIMER });\n      }, 1000);\n    }\n    return () => {\n      clearInterval(timer);\n    };\n  }, [halted]);\n\n  return (\n    <TableContext.Provider value={value}>\n      <Form />\n      <div>{timer}</div>\n      <Table />\n      <div>{result}</div>\n    </TableContext.Provider>\n  );\n};\n\nexport default MineSearch;\n\nconst Form = memo(() => {\n  const [row, setRow] = useState(10);\n  const [cell, setCell] = useState(10);\n  const [mine, setMine] = useState(20);\n  const { dispatch } = useContext(TableContext);\n\n  const onChangeRow = useCallback((e) => {\n    setRow(e.target.value);\n  }, []);\n\n  const onChangeCell = useCallback((e) => {\n    setCell(e.target.value);\n  }, []);\n\n  const onChangeMine = useCallback((e) => {\n    setMine(e.target.value);\n  }, []);\n\n  const onClickBtn = useCallback(() => {\n    dispatch({ type: START_GAME, row, cell, mine });\n  }, [row, cell, mine]);\n\n  return (\n    <div>\n      <input\n        type=\"number\"\n        placeholder=\"세로\"\n        value={row}\n        onChange={onChangeRow}\n      />\n      <input\n        type=\"number\"\n        placeholder=\"가로\"\n        value={cell}\n        onChange={onChangeCell}\n      />\n      <input\n        type=\"number\"\n        placeholder=\"지뢰\"\n        value={mine}\n        onChange={onChangeMine}\n      />\n      <button onClick={onClickBtn}>시작</button>\n    </div>\n  );\n});\n\nconst Table = memo(() => {\n  const { tableData } = useContext(TableContext);\n  return (\n    <table style={{ width: 'unset' }}>\n      <tbody>\n        {Array(tableData.length)\n          .fill(0)\n          .map((_, i) => {\n            return <Tr key={`tr-${i}`} rowIndex={i} />;\n          })}\n      </tbody>\n    </table>\n  );\n});\n\nconst Tr = memo(({ rowIndex }: { rowIndex: number }) => {\n  const { tableData } = useContext(TableContext);\n\n  if (!tableData[0]?.length) {\n    return;\n  }\n\n  return (\n    <tr>\n      {Array(tableData[0].length)\n        .fill(0)\n        .map((_, i) => (\n          <Td key={`td-${i}`} rowIndex={rowIndex} cellIndex={i} />\n        ))}\n    </tr>\n  );\n});\n\nconst getTdStyle = (code) => {\n  switch (code) {\n    case CODE.NORMAL:\n    case CODE.MINE:\n      return {\n        background: '#444',\n      };\n    case CODE.CLICKED_MINE:\n      return {\n        background: 'red',\n      };\n    case CODE.OPENED:\n      return {\n        background: 'white',\n      };\n    case CODE.QUESTION_MINE:\n    case CODE.QUESTION:\n      return {\n        background: 'yellow',\n      };\n    case CODE.FLAG_MINE:\n    case CODE.FLAG:\n      return {\n        background: 'red',\n      };\n    default:\n      return {\n        background: 'white',\n      };\n  }\n};\n\nconst getTdText = (code) => {\n  switch (code) {\n    case CODE.NORMAL:\n      return '';\n    case CODE.MINE:\n      return 'X';\n    case CODE.CLICKED_MINE:\n      return '펑';\n    case CODE.FLAG_MINE:\n    case CODE.FLAG:\n      return '!';\n    case CODE.QUESTION_MINE:\n    case CODE.QUESTION:\n      return '?';\n    default:\n      return code || '';\n  }\n};\n\nconst Td = memo(\n  ({ rowIndex, cellIndex }: { rowIndex: number; cellIndex: number }) => {\n    const { tableData, dispatch, halted } = useContext(TableContext);\n\n    const onClickTd = useCallback(() => {\n      if (halted) {\n        return;\n      }\n      switch (tableData[rowIndex][cellIndex]) {\n        // 아래 케이스일 경우 모두 무시\n        case CODE.OPENED:\n        case CODE.FLAG_MINE:\n        case CODE.FLAG:\n        case CODE.QUESTION_MINE:\n        case CODE.QUESTION:\n          return;\n\n        case CODE.NORMAL:\n          dispatch({ type: OPEN_CELL, row: rowIndex, cell: cellIndex });\n          return;\n\n        case CODE.MINE:\n          dispatch({ type: CLICK_MINE, row: rowIndex, cell: cellIndex });\n          return;\n\n        default:\n          return;\n      }\n    }, [tableData[rowIndex][cellIndex], halted]);\n\n    // 우클릭 시 이벤트\n    const onRightClickTd = useCallback(\n      (e) => {\n        e.preventDefault();\n\n        // 게임이 끝났을 경우 무시\n        if (halted) {\n          return;\n        }\n\n        switch (tableData[rowIndex][cellIndex]) {\n          case CODE.NORMAL:\n          case CODE.MINE:\n            dispatch({ type: FLAG_CELL, row: rowIndex, cell: cellIndex });\n            return;\n          case CODE.FLAG_MINE:\n          case CODE.FLAG:\n            dispatch({ type: QUESTION_CELL, row: rowIndex, cell: cellIndex });\n            return;\n          case CODE.QUESTION_MINE:\n          case CODE.QUESTION:\n            dispatch({ type: NORMALIZE_CELL, row: rowIndex, cell: cellIndex });\n            return;\n          default:\n            return;\n        }\n      },\n      [tableData[rowIndex][cellIndex], halted],\n    );\n\n    return (\n      <RealTd\n        onClickTd={onClickTd}\n        onRightClickTd={onRightClickTd}\n        data={tableData[rowIndex][cellIndex]}\n      />\n    );\n  },\n);\n\nconst RealTd = memo(\n  ({\n    onClickTd,\n    onRightClickTd,\n    data,\n  }: {\n    onClickTd: () => void;\n    onRightClickTd: (e: any) => void;\n    data: string;\n  }) => {\n    return (\n      <td\n        style={{\n          ...getTdStyle(data),\n          width: 60,\n          height: 60,\n          padding: 0,\n          textAlign: 'center',\n        }}\n        onClick={onClickTd}\n        onContextMenu={onRightClickTd}\n      >\n        {getTdText(data)}\n      </td>\n    );\n  },\n);\n"],"sourceRoot":""}