(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4893,6764],{4264:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return l}});var i,s,n=r(2769),a=r(8782);(i=s||(s={})).Strawberry="strawberry",i.Banana="banana",i.Lime="lime",i.Plum="plum";class l extends n.Scene{create(){let t=this.cameras.main.width,e=this.cameras.main.height;this.add.rectangle(t/2,e/2,t,e,1723694,1),this.add.text(t/2,.05*e,"할리갈리",{fontSize:"".concat(.06*e,"px"),color:"#fff",fontStyle:"bold"}).setOrigin(.5),this.setupTouchDragDetection(),this.showPlayerSelection()}setupTouchDragDetection(){let t=!1,e=0,r=0,i=!1,s=null,n=null;this.input.on("pointerdown",a=>{t=!1,i=!1,e=a.x,r=a.y,s=null,n=null}),this.input.on("pointermove",s=>{if(!t){let n=Math.abs(s.x-e),a=Math.abs(s.y-r);(n>10||a>10)&&(t=!0,i=!0)}}),this.input.on("pointerup",()=>{!i&&s&&n&&n(),t=!1,i=!1,s=null,n=null}),this.input.on("pointercancel",()=>{t=!1,i=!1,s=null,n=null}),this.__registerClick=(t,e)=>{s=t,n=e}}showPlayerSelection(){let t=this.cameras.main.width,e=this.cameras.main.height,r=t/2,i=e/2;this.add.text(r,i-.2*e,"플레이어 수를 선택하세요",{fontSize:"".concat(.04*e,"px"),color:"#fff"}).setOrigin(.5);let s=[2,3,4],n=.2*t,a=.1*e,l=.05*t,o=r-(s.length-1)*(n+l)/2;s.forEach((t,r)=>{let s=o+r*(n+l),c=this.add.rectangle(s,i,n,a,5025616,.9);c.setStrokeStyle(3,8505220),c.setInteractive({useHandCursor:!0}),c.on("pointerdown",()=>{this.__registerClick(c,()=>{this.numberOfPlayers=t,this.startGame()})});let h=this.add.text(s,i,"".concat(t,"명"),{fontSize:"".concat(.04*e,"px"),color:"#fff",fontStyle:"bold"});h.setOrigin(.5),h.setInteractive({useHandCursor:!0}),h.on("pointerdown",()=>{this.__registerClick(h,()=>{this.numberOfPlayers=t,this.startGame()})})});let c=this.add.rectangle(r,i+.2*e,n,.7*a,6710886,.9);c.setStrokeStyle(3,10066329),c.setInteractive({useHandCursor:!0}),c.on("pointerdown",()=>{this.__registerClick(c,()=>{this.goToMainMenu()})});let h=this.add.text(r,i+.2*e,"메인 메뉴",{fontSize:"".concat(.035*e,"px"),color:"#fff",fontStyle:"bold"});h.setOrigin(.5),h.setInteractive({useHandCursor:!0}),h.on("pointerdown",()=>{this.__registerClick(h,()=>{this.goToMainMenu()})})}startGame(){let t=this.cameras.main.width,e=this.cameras.main.height;this.children.removeAll(),this.add.rectangle(t/2,e/2,t,e,1723694,1),this.initializeDeck(),this.dealCards(),this.currentPlayer=0,this.isGameActive=!0,this.centerCards=[],this.fruitCounts.clear(),this.createGameUI(),this.updateGameState()}initializeDeck(){let t=[];["strawberry","banana","lime","plum"].forEach(e=>{for(let r=1;r<=5;r++)for(let i=0;i<5;i++)t.push({fruit:e,count:r})});for(let e=t.length-1;e>0;e--){let r=Math.floor(Math.random()*(e+1));[t[e],t[r]]=[t[r],t[e]]}this.playerCards=[],this.playerDiscardPiles=[];for(let t=0;t<this.numberOfPlayers;t++)this.playerCards[t]=[],this.playerDiscardPiles[t]=[];let e=Math.floor(t.length/this.numberOfPlayers);for(let r=0;r<this.numberOfPlayers;r++)this.playerCards[r]=t.slice(r*e,(r+1)*e)}dealCards(){}createGameUI(){let t=this.cameras.main.width,e=this.cameras.main.height,r=.15*e,i=t/(this.numberOfPlayers+1);this.playerCardCountTexts=[];for(let s=0;s<this.numberOfPlayers;s++){let n=i*(s+1),a=s===this.currentPlayer;this.add.rectangle(n,r,.15*t,.08*e,a?5025616:3355443,.9).setStrokeStyle(2,a?8505220:6710886),this.add.text(n,r-.02*e,"플레이어 ".concat(s+1),{fontSize:"".concat(.025*e,"px"),color:"#fff",fontStyle:"bold"}).setOrigin(.5);let l=this.add.text(n,r+.02*e,"".concat(this.playerCards[s].length,"장"),{fontSize:"".concat(.03*e,"px"),color:a?"#4caf50":"#fff",fontStyle:"bold"});l.setOrigin(.5),this.playerCardCountTexts.push(l)}this.currentPlayerIndicator=this.add.text(t/2,.25*e,"플레이어 ".concat(this.currentPlayer+1,"의 턴"),{fontSize:"".concat(.04*e,"px"),color:"#ffd700",fontStyle:"bold"}),this.currentPlayerIndicator.setOrigin(.5),this.statusText=this.add.text(t/2,.3*e,"카드를 뒤집으세요",{fontSize:"".concat(.03*e,"px"),color:"#fff"}),this.statusText.setOrigin(.5);let s=this.add.rectangle(t/2,.75*e,.2*t,.1*e,2201331,.9);s.setStrokeStyle(3,6600182),s.setInteractive({useHandCursor:!0}),s.on("pointerdown",()=>{this.__registerClick(s,()=>{this.flipCard()})});let n=this.add.text(t/2,.75*e,"카드 뒤집기",{fontSize:"".concat(.035*e,"px"),color:"#fff",fontStyle:"bold"});n.setOrigin(.5),n.setInteractive({useHandCursor:!0}),n.on("pointerdown",()=>{this.__registerClick(n,()=>{this.flipCard()})}),this.createBellButton();let a=this.add.rectangle(.9*t,.05*e,.15*t,.08*e,6710886,.9);a.setStrokeStyle(3,10066329),a.setInteractive({useHandCursor:!0}),a.on("pointerdown",()=>{this.__registerClick(a,()=>{this.goToMainMenu()})});let l=this.add.text(.9*t,.05*e,"메인 메뉴",{fontSize:"".concat(.03*e,"px"),color:"#fff",fontStyle:"bold"});l.setOrigin(.5),l.setInteractive({useHandCursor:!0}),l.on("pointerdown",()=>{this.__registerClick(l,()=>{this.goToMainMenu()})})}createBellButton(){let t=this.cameras.main.width,e=this.cameras.main.height;this.bellButton&&this.bellButton.destroy();let r=t/2,i=.85*e,s=Math.min(.15*t,.15*e),a=this.add.circle(r,i,s/2,16007990,1);a.setStrokeStyle(5,16739179);let l=this.add.text(r,i,"\uD83D\uDD14",{fontSize:"".concat(.6*s,"px")});l.setOrigin(.5),this.bellButton=this.add.container(0,0),this.bellButton.add([a,l]),this.canRingBell?(a.setFillStyle(16007990,1),this.bellButton.setInteractive(new n.Geom.Circle(r,i,s/2),n.Geom.Circle.Contains),this.bellButton.setInteractive({useHandCursor:!0}),this.bellButton.on("pointerdown",()=>{this.__registerClick(this.bellButton,()=>{this.ringBell()})})):a.setFillStyle(6710886,.5)}flipCard(){if(!this.isGameActive)return;if(0===this.playerCards[this.currentPlayer].length){this.nextPlayer();return}let t=this.playerCards[this.currentPlayer].shift();this.centerCards.push(t);let e=this.fruitCounts.get(t.fruit)||0;this.fruitCounts.set(t.fruit,e+t.count),this.canRingBell=Array.from(this.fruitCounts.values()).includes(5),this.updateGameState(),this.updateCenterCards(),this.createBellButton(),this.time.delayedCall(500,()=>{this.isGameActive&&!this.canRingBell&&this.nextPlayer()})}updateCenterCards(){let t=this.cameras.main.width,e=this.cameras.main.height,r=.5*e,i=Math.min(.1*t,.12*e),s=.2*i,n=t/2-(this.centerCards.length-1)*(i+s)/2;this.centerCardObjects.forEach(t=>t.destroy()),this.centerCardObjects=[],this.centerCards.forEach((t,e)=>{let a=this.createCardObject(n+e*(i+s),r,i,t);this.centerCardObjects.push(a)})}createCardObject(t,e,r,i){let s=this.add.container(0,0),n=this.add.rectangle(t,e,r,1.4*r,16777215,1);n.setStrokeStyle(2,0);let a=new Map([["strawberry",16717636],["banana",16771899],["lime",7798531],["plum",10233776]]).get(i.fruit)||16777215,l=this.add.circle(t,e-.2*r,.25*r,a,1),o=this.add.text(t,e+.3*r,i.count.toString(),{fontSize:"".concat(.3*r,"px"),color:"#000",fontStyle:"bold"});return o.setOrigin(.5),s.add([n,l,o]),s}ringBell(){if(!this.canRingBell)return;let t=!1;for(let[e,r]of this.fruitCounts.entries())if(5===r){t=!0;break}if(t){if(this.playerDiscardPiles[this.currentPlayer].push(...this.centerCards),this.centerCards=[],this.fruitCounts.clear(),this.canRingBell=!1,this.statusText.setText("플레이어 ".concat(this.currentPlayer+1,"가 벨을 쳤습니다!")),this.statusText.setColor("#4caf50"),this.checkWinCondition()){this.showWinMessage();return}this.updateGameState(),this.updateCenterCards(),this.createBellButton(),this.time.delayedCall(1e3,()=>{this.nextPlayer()})}else this.centerCards.length>0&&(this.playerDiscardPiles[this.currentPlayer].push(...this.centerCards),this.centerCards=[],this.fruitCounts.clear()),this.statusText.setText("플레이어 ".concat(this.currentPlayer+1,"가 잘못된 벨을 쳤습니다!")),this.statusText.setColor("#f44336"),this.updateGameState(),this.updateCenterCards(),this.createBellButton(),this.time.delayedCall(1e3,()=>{this.nextPlayer()})}nextPlayer(){if(!this.isGameActive)return;this.currentPlayer=(this.currentPlayer+1)%this.numberOfPlayers;let t=0;for(;0===this.playerCards[this.currentPlayer].length&&t<this.numberOfPlayers;)this.currentPlayer=(this.currentPlayer+1)%this.numberOfPlayers,t++;if(t>=this.numberOfPlayers){this.endGame();return}this.updateGameState(),this.statusText.setText("플레이어 ".concat(this.currentPlayer+1,"의 턴")),this.statusText.setColor("#fff")}updateGameState(){for(let t=0;t<this.numberOfPlayers;t++){let e=this.playerCards[t].length+this.playerDiscardPiles[t].length;this.playerCardCountTexts[t].setText("".concat(e,"장"));let r=t===this.currentPlayer;this.playerCardCountTexts[t].setColor(r?"#4caf50":"#fff")}this.currentPlayerIndicator&&this.currentPlayerIndicator.setText("플레이어 ".concat(this.currentPlayer+1,"의 턴"))}checkWinCondition(){for(let t=0;t<this.numberOfPlayers;t++)if(0===this.playerCards[t].length&&0===this.playerDiscardPiles[t].length)return!0;return!1}endGame(){this.isGameActive=!1;let t=0,e=0;for(let r=0;r<this.numberOfPlayers;r++){let i=this.playerCards[r].length+this.playerDiscardPiles[r].length;i>e&&(e=i,t=r)}this.showWinMessage(t)}showWinMessage(t){let e=this.cameras.main.width,r=this.cameras.main.height,i=e/2,s=r/2;this.add.rectangle(i,s,e,r,0,.7),this.add.rectangle(i,s,.6*e,.4*r,2763306,1).setStrokeStyle(4,5025616),this.add.text(i,s-.1*r,void 0!==t?"\uD83C\uDF89 플레이어 ".concat(t+1," 승리!"):"\uD83C\uDF89 게임 종료!",{fontSize:"".concat(.06*r,"px"),color:"#4caf50",fontStyle:"bold"}).setOrigin(.5);let n=this.add.rectangle(i,s+.1*r,.3*e,.08*r,5025616,.9);n.setStrokeStyle(3,8505220),n.setInteractive({useHandCursor:!0}),n.on("pointerdown",()=>{this.__registerClick(n,()=>{this.goToMainMenu()})});let a=this.add.text(i,s+.1*r,"메인 메뉴",{fontSize:"".concat(.035*r,"px"),color:"#fff",fontStyle:"bold"});a.setOrigin(.5),a.setInteractive({useHandCursor:!0}),a.on("pointerdown",()=>{this.__registerClick(a,()=>{this.goToMainMenu()})})}goToMainMenu(){this.gameTimer&&(clearInterval(this.gameTimer),this.gameTimer=null),a.rX.startScene(this,"DeviceSelectionScene")}shutdown(){this.gameTimer&&(clearInterval(this.gameTimer),this.gameTimer=null)}constructor(){super("HalliGalliScene"),this.numberOfPlayers=2,this.playerCards=[],this.playerDiscardPiles=[],this.centerCards=[],this.currentPlayer=0,this.isGameActive=!1,this.centerCardObjects=[],this.playerCardCountTexts=[],this.fruitCounts=new Map,this.canRingBell=!1,this.gameTimer=null}}},8782:function(t,e,r){"use strict";r.d(e,{Wc:function(){return s},rX:function(){return i},vz:function(){return n}});class i{static startScene(t,e,r){if(t.scene.start(e,r),!t.game){let r=t.scene.key;if(r&&r!==e){let i=t.scene.get(r);i&&i.scene.isActive()&&(console.log("[SceneTransitionUtils] Stopping current scene: ".concat(r," -> ").concat(e)),i.scene.stop())}return}let i=t.game.scene.scenes||[],s=[];for(let t of i){let r=t.scene.key;r!==e&&t.scene.isActive()&&(console.log("[SceneTransitionUtils] Stopping active scene: ".concat(r," (transitioning to ").concat(e,")")),t.scene.stop(),s.push(r))}s.length>0&&console.log("[SceneTransitionUtils] Stopped ".concat(s.length," scene(s): [").concat(s.join(", "),"] -> ").concat(e))}}class s{static setup(t,e){let r=0,i=0,s=!1;t.on("pointerdown",t=>{r=t.x,i=t.y,s=!1}),t.on("pointermove",t=>{if(t.isDown){let e=Math.abs(t.x-r),n=Math.abs(t.y-i);(e>this.DRAG_THRESHOLD||n>this.DRAG_THRESHOLD)&&(s=!0)}}),t.on("pointerup",()=>{s||e(),s=!1}),t.on("pointercancel",()=>{s=!1})}}s.DRAG_THRESHOLD=10;class n{static create(t,e){let{x:r,y:i,width:n,height:a,text:l,backgroundColor:o=2201331,backgroundAlpha:c=.9,strokeColor:h=6600182,strokeWidth:u=3,textColor:d="#fff",fontSize:f,onClick:p}=e,y=t.add.container(0,0),m=t.add.rectangle(r,i,n,a,o,c);m.setStrokeStyle(u,h),m.setInteractive({useHandCursor:!0}),s.setup(m,p);let g=t.add.text(r,i,l,{fontSize:f?"".concat(f,"px"):void 0,color:d,fontStyle:"bold"});return g.setOrigin(.5),g.setInteractive({useHandCursor:!0}),s.setup(g,p),y.add([m,g]),{container:y,background:m,text:g}}}},6764:function(t,e,r){"use strict";var i,s;t.exports=(null==(i=r.g.process)?void 0:i.env)&&"object"==typeof(null==(s=r.g.process)?void 0:s.env)?r.g.process:r(6515)},6515:function(t){!function(){var e={229:function(t){var e,r,i,s=t.exports={};function n(){throw Error("setTimeout has not been defined")}function a(){throw Error("clearTimeout has not been defined")}function l(t){if(e===setTimeout)return setTimeout(t,0);if((e===n||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(r){try{return e.call(null,t,0)}catch(r){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:n}catch(t){e=n}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var o=[],c=!1,h=-1;function u(){c&&i&&(c=!1,i.length?o=i.concat(o):h=-1,o.length&&d())}function d(){if(!c){var t=l(u);c=!0;for(var e=o.length;e;){for(i=o,o=[];++h<e;)i&&i[h].run();h=-1,e=o.length}i=null,c=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function p(){}s.nextTick=function(t){var e=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];o.push(new f(t,e)),1!==o.length||c||l(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=p,s.addListener=p,s.once=p,s.off=p,s.removeListener=p,s.removeAllListeners=p,s.emit=p,s.prependListener=p,s.prependOnceListener=p,s.listeners=function(t){return[]},s.binding=function(t){throw Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(t){throw Error("process.chdir is not supported")},s.umask=function(){return 0}}},r={};function i(t){var s=r[t];if(void 0!==s)return s.exports;var n=r[t]={exports:{}},a=!0;try{e[t](n,n.exports,i),a=!1}finally{a&&delete r[t]}return n.exports}i.ab="//";var s=i(229);t.exports=s}()}}]);