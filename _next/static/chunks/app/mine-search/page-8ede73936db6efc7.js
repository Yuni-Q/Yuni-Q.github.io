(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[627],{8342:function(e,t,r){Promise.resolve().then(r.bind(r,3049))},3049:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return p}});var l=r(2577),a=r(727);let n={MINE:-7,NORMAL:-1,QUESTION:-2,FLAG:-3,QUESTION_MINE:-4,FLAG_MINE:-5,CLICKED_MINE:-6,OPEN_MINE:-8,OPENED:0},c="START_GAME",u="OPEN_CELL",o="CLICK_MINE",s="FLAG_CELL",E="QUESTION_CELL",N="NORMALIZE_CELL",d="INCREMENT_TIMER",i=a.createContext({tableData:[],halted:!0,dispatch:null,openedCount:0}),I={tableData:[],data:{row:0,cell:0,mine:0},timer:0,result:"",halted:!0,openedCount:0},h=(e,t,r)=>{let l=Array(e*t).fill(0).map((e,t)=>t),a=[];for(;l.length>e*t-r;){let e=l.splice(Math.floor(Math.random()*l.length),1)[0];a.push(e)}let c=[];for(let r=0;r<e;r++){let e=[];c.push(e);for(let r=0;r<t;r++)e.push(n.NORMAL)}for(let e=0;e<a.length;e++){let r=Math.floor(a[e]/t),l=a[e]%t;c[r][l]=n.MINE}return c},M=(e,t)=>{switch(t.type){case c:return{...e,data:{row:t.row,cell:t.cell,mine:t.mine},openedCount:0,tableData:h(t.row,t.cell,t.mine),halted:!1,timer:0};case u:{let r=[...e.tableData];if(r.forEach((e,t)=>{r[t]=[...e]}),!e.openedCount&&n.MINE===r[t.row][t.cell]){let l=[];for(let t=0;t<e.data.row;t++){let t=[];l.push(t);for(let r=0;r<e.data.cell;r++)t.push(!1)}let a=!1,c=(t,u)=>{var o;if(!a&&!(t<0)&&!(t>=e.data.row)&&!(u<0)&&!(u>=e.data.cell)&&!l[t][u]){if(l[t][u]=!0,n.NORMAL===(null===(o=r[t])||void 0===o?void 0:o[u])){r[t][u]=n.MINE,a=!0;return}c(t-1,u-1),c(t-1,u),c(t-1,u+1),c(t,u-1),c(t,u+1),c(t+1,u-1),c(t+1,u),c(t+1,u+1)}};c(t.row,t.cell),r[t.row][t.cell]=n.NORMAL}let l=[],a=0,c=(e,t)=>{if(e<0||e>=r.length||t<0||t>=r[0].length||[n.OPENED,n.FLAG,n.FLAG_MINE,n.QUESTION_MINE,n.QUESTION].includes(r[e][t])||l.includes(e+"/"+t))return;l.push(e+"/"+t);let u=[r[e][t-1],r[e][t+1]];r[e-1]&&(u=u.concat([r[e-1][t-1],r[e-1][t],r[e-1][t+1]])),r[e+1]&&(u=u.concat([r[e+1][t-1],r[e+1][t],r[e+1][t+1]]));let o=u.filter(function(e){return[n.MINE,n.FLAG_MINE,n.QUESTION_MINE].includes(e)}).length;if(0===o&&e>-1){let l=[];e-1>-1&&(l.push([e-1,t-1]),l.push([e-1,t]),l.push([e-1,t+1])),l.push([e,t-1]),l.push([e,t+1]),e+1<r.length&&(l.push([e+1,t-1]),l.push([e+1,t]),l.push([e+1,t+1])),l.forEach(e=>{r[e[0]][e[1]]!==n.OPENED&&c(e[0],e[1])})}r[e][t]===n.NORMAL&&(a+=1),r[e][t]=o};c(t.row,t.cell);let u=!1,o="";return e.data.row*e.data.cell-e.data.mine===e.openedCount+a&&(u=!0,o="".concat(e.timer,"초만에 승리하셨습니다")),{...e,tableData:r,openedCount:e.openedCount+a,halted:u,result:o}}case o:{let r=[...e.tableData];return r.forEach((e,t)=>{r[t]=[...e]}),r.forEach((e,t)=>{e.forEach((e,l)=>{(r[t][l]===n.MINE||r[t][l]===n.FLAG_MINE||r[t][l]===n.QUESTION_MINE)&&(r[t][l]=n.OPEN_MINE)})}),r[t.row][t.cell]=n.CLICKED_MINE,{...e,tableData:r,halted:!0}}case s:{let r=[...e.tableData];return r[t.row]=[...e.tableData[t.row]],r[t.row][t.cell]===n.MINE?r[t.row][t.cell]=n.FLAG_MINE:r[t.row][t.cell]=n.FLAG,{...e,tableData:r}}case E:{let r=[...e.tableData];return r[t.row]=[...e.tableData[t.row]],r[t.row][t.cell]===n.FLAG_MINE?r[t.row][t.cell]=n.QUESTION_MINE:r[t.row][t.cell]=n.QUESTION,{...e,tableData:r}}case N:{let r=[...e.tableData];return r[t.row]=[...e.tableData[t.row]],r[t.row][t.cell]===n.QUESTION_MINE?r[t.row][t.cell]=n.MINE:r[t.row][t.cell]=n.NORMAL,{...e,tableData:r}}case d:return{...e,timer:e.timer+1};default:return e}};var p=()=>{let[e,t]=(0,a.useReducer)(M,I),{tableData:r,halted:n,timer:c,result:u,openedCount:o}=e,s=(0,a.useMemo)(()=>({tableData:r,halted:n,dispatch:t,openedCount:o}),[r,n,o]);return(0,a.useEffect)(()=>{let e;return!1===n&&t&&(e=setInterval(()=>{t({type:d})},1e3)),()=>{e&&clearInterval(e)}},[n,t]),(0,l.jsxs)(i.Provider,{value:s,children:[(0,l.jsx)(w,{}),(0,l.jsx)("div",{children:c}),(0,l.jsx)(f,{}),(0,l.jsx)("div",{children:u})]})};let w=(0,a.memo)(()=>{let[e,t]=(0,a.useState)(10),[r,n]=(0,a.useState)(10),[u,o]=(0,a.useState)(20),{dispatch:s}=(0,a.useContext)(i),E=(0,a.useCallback)(e=>{t(Number(e.target.value))},[]),N=(0,a.useCallback)(e=>{n(Number(e.target.value))},[]),d=(0,a.useCallback)(e=>{o(Number(e.target.value))},[]),I=(0,a.useCallback)(()=>{s&&s({type:c,row:e,cell:r,mine:u})},[s,e,r,u]);return(0,l.jsxs)("div",{children:[(0,l.jsx)("input",{type:"number",placeholder:"세로",value:e,onChange:E}),(0,l.jsx)("input",{type:"number",placeholder:"가로",value:r,onChange:N}),(0,l.jsx)("input",{type:"number",placeholder:"지뢰",value:u,onChange:d}),(0,l.jsx)("button",{onClick:I,children:"시작"})]})}),f=(0,a.memo)(()=>{let{tableData:e}=(0,a.useContext)(i);return(0,l.jsx)("table",{style:{width:"unset"},children:(0,l.jsx)("tbody",{children:Array(e.length).fill(0).map((e,t)=>(0,l.jsx)(C,{rowIndex:t},"tr-".concat(t)))})})}),C=(0,a.memo)(e=>{var t;let{rowIndex:r}=e,{tableData:n}=(0,a.useContext)(i);if(null===(t=n[0])||void 0===t?void 0:t.length)return(0,l.jsx)("tr",{children:Array(n[0].length).fill(0).map((e,t)=>(0,l.jsx)(_,{rowIndex:r,cellIndex:t},"td-".concat(t)))})}),L=e=>{switch(e){case n.NORMAL:case n.MINE:return{background:"#444"};case n.CLICKED_MINE:return{background:"red"};case n.OPEN_MINE:case n.OPENED:return{background:"white"};case n.QUESTION_MINE:case n.QUESTION:return{background:"yellow"};case n.FLAG_MINE:case n.FLAG:return{background:"red"};default:return{background:"white"}}},O=e=>{switch(e){case n.NORMAL:return"";case n.MINE:return"X";case n.CLICKED_MINE:case n.OPEN_MINE:return"펑";case n.FLAG_MINE:case n.FLAG:return"!";case n.QUESTION_MINE:case n.QUESTION:return"?";default:return e||""}},_=(0,a.memo)(e=>{let{rowIndex:t,cellIndex:r}=e,{tableData:c,dispatch:d,halted:I,openedCount:h}=(0,a.useContext)(i),M=(0,a.useCallback)(()=>{if(!I&&d){if(!h){d({type:u,row:t,cell:r});return}switch(c[t][r]){case n.OPENED:case n.FLAG_MINE:case n.FLAG:case n.QUESTION_MINE:case n.QUESTION:return;case n.NORMAL:d({type:u,row:t,cell:r});return;case n.MINE:d({type:o,row:t,cell:r});return;default:return}}},[c[t][r],I,h,d,t,r]),p=(0,a.useCallback)(e=>{if(e.preventDefault(),!I&&d)switch(c[t][r]){case n.NORMAL:case n.MINE:d({type:s,row:t,cell:r});return;case n.FLAG_MINE:case n.FLAG:d({type:E,row:t,cell:r});return;case n.QUESTION_MINE:case n.QUESTION:d({type:N,row:t,cell:r});return;default:return}},[c[t][r],I,d,t,r]);return(0,l.jsx)(b,{onClickTd:M,onRightClickTd:p,data:c[t][r]})}),b=(0,a.memo)(e=>{let{onClickTd:t,onRightClickTd:r,data:a}=e;return(0,l.jsx)("td",{style:{...L(a),width:60,height:60,padding:0,textAlign:"center"},onClick:t,onContextMenu:r,children:O(a)})})}},function(e){e.O(0,[1434,5647,1744],function(){return e(e.s=8342)}),_N_E=e.O()}]);