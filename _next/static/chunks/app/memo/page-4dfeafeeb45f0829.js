(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5849],{235:function(e,t,r){Promise.resolve().then(r.bind(r,3451))},3451:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return c}});var n=r(2577),s=r(727),a=r(5277),i=e=>{let{id:t,top:r,left:a,width:i,height:l,text:u,onClickDelete:o,onClickMove:c,onClickResize:d,onChangeText:f}=e,m=(0,s.useRef)(null),h=(0,s.useRef)(null),p=(0,s.useRef)(null),v=(0,s.useRef)(null),g=(0,s.useRef)(null),y=(0,s.useRef)(null),w=(0,s.useRef)(null),x=(0,s.useRef)(null),b=(0,s.useCallback)(e=>{if(e.target.dataset.delete){o(e);return}if(e.target.dataset.header){m.current=e.clientX-a,h.current=e.clientY-r,g.current=!0;return}},[o,a,r]),E=e=>{e.target.dataset.blind&&(y.current=!0)},N=(0,s.useCallback)(e=>{if(!w.current)return;let t=w.current.style;if(g.current&&null!==m.current&&null!==h.current){let t=w.current.style;t.top="".concat(e.clientY-h.current,"px"),t.left="".concat(e.clientX-m.current,"px"),t.zIndex="1"}if(y.current&&x.current){let n=x.current.style;n.height="".concat(e.clientY-r-30,"px"),n.width="".concat(e.clientX-a-15,"px"),t.zIndex="1"}},[r,a]),C=(0,s.useCallback)(()=>{w.current&&(c(t,w.current.style.top,w.current.style.left),g.current=!1)},[t,c]),j=(0,s.useCallback)(()=>{y.current=!1,x.current&&d(t,x.current.style.width,x.current.style.height)},[t,d]);return(0,s.useEffect)(()=>{let e=p.current,t=v.current;if(e&&t)return e.addEventListener("mousedown",b,!0),window.addEventListener("mousemove",N,!0),e.addEventListener("mouseup",C,!0),t.addEventListener("mousedown",E,!0),t.addEventListener("mouseup",j,!0),()=>{e.removeEventListener("mousedown",b,!0),window.removeEventListener("mousemove",N,!0),e.removeEventListener("mouseup",C,!0),t.removeEventListener("mousedown",E,!0),t.removeEventListener("mouseup",j,!0)}},[b,t,N,f,j,C,u,E]),(0,n.jsxs)("div",{className:"memo",ref:w,style:{top:"".concat(r,"px"),left:"".concat(a,"px")},children:[(0,n.jsxs)("div",{className:"header","data-header":!0,"data-id":t,ref:p,onClick:b,children:[(0,n.jsx)("h1",{className:"blind",children:"메모장"}),(0,n.jsx)("button",{className:"btn_close","data-delete":!0,"data-id":t,onClick:o,children:(0,n.jsx)("span",{className:"blind",children:"닫기"})})]}),(0,n.jsxs)("div",{className:"content",children:[(0,n.jsx)("textarea",{className:"textarea",ref:x,style:{width:"".concat(i,"px"),height:"".concat(l,"px")},placeholder:"메모 하십시오!",value:u,onChange:e=>{f(t,e.target.value,e.target)}}),(0,n.jsx)("button",{className:"btn_size","data-blind":!0,ref:v,children:(0,n.jsx)("span",{className:"blind",children:"메모장 크기 조절"})})]})]})},l=e=>{let{className:t,status:r,size:s=28}=e;return(0,n.jsxs)("div",{className:"spinner la-ball-pulse "+(t||""),style:{height:s},children:[(0,n.jsx)("div",{}),(0,n.jsx)("div",{}),(0,n.jsx)("div",{})]})},u=r(9301),o=r(248);r(7130);var c=()=>{let[e,t]=(0,s.useState)(!0),[r,c]=(0,s.useState)([]),d=(0,s.useRef)(null),f=(0,s.useRef)(!1),m=(0,s.useRef)(!1),h=e=>{let t=e.currentTarget;c(r.filter(e=>e.id!==t.dataset.id))},p=(e,t,n)=>{let s=r.find(t=>t.id===e);s&&c([...r.filter(t=>t.id!==e),{id:(0,a.Z)(),top:parseInt(t,10),left:parseInt(n,10),width:s.width,height:s.height,text:s.text}])},v=(e,t,n)=>{let s=r.find(t=>t.id===e);s&&c([...r.filter(t=>t.id!==e),{id:(0,a.Z)(),top:s.top,left:s.left,width:parseInt(t,10),height:parseInt(n,10),text:s.text}])},g=(e,t,n)=>{let s=r.find(t=>t.id===e);s&&c([...r.filter(t=>t.id!==e),{id:s.id,top:s.top,left:s.left,width:s.width,height:s.height,text:t}])},y=async()=>{},w=async e=>{if(m.current){m.current=!1;return}if(!f.current)return;let t=(0,u.N)(),{error:r}=await t.from("memos").upsert({id:"default",data:e,updated_at:new Date().toISOString()},{onConflict:"id"});r?console.error("Error saving memos:",r):console.log("Memos saved successfully")};return(0,s.useEffect)(()=>{f.current&&!m.current&&w(JSON.stringify(r))},[r]),(0,s.useEffect)(()=>{let e=d.current;if(!e)return;let t=e=>{e.preventDefault(),e.target.dataset.wrap&&c([...r,{id:(0,a.Z)(),top:e.clientY,left:e.clientX,width:200,height:100,text:""}])};return e.addEventListener("contextmenu",t,!0),()=>e.removeEventListener("contextmenu",t,!0)},[r]),(0,s.useEffect)(()=>{(0,o.ZP)("memo",o.fz.EXPOSE,"memo"),y();let e=(0,u.N)();(async()=>{try{let{data:n,error:s}=await e.from("memos").select("data").eq("id","default").single();if(s){var r;if("PGRST116"===s.code||(null===(r=s.message)||void 0===r?void 0:r.includes("No rows"))){console.log("No memos found, starting with empty array"),c([]),t(!1);return}console.error("Error loading memos:",s),c([]),t(!1);return}if(m.current=!0,null==n?void 0:n.data){let e="string"==typeof n.data?JSON.parse(n.data):n.data;c(Array.isArray(e)?e:[])}else c([]);m.current=!1,f.current=!0,t(!1)}catch(e){console.error("Error parsing memos:",e),c([]),t(!1)}})();let r=e.channel("memos_changes").on("postgres_changes",{event:"*",schema:"public",table:"memos",filter:"id=eq.default"},e=>{try{m.current=!0;let t=e.new;if(null==t?void 0:t.data){let e="string"==typeof t.data?JSON.parse(t.data):t.data;c(Array.isArray(e)?e:[])}else c([]);m.current=!1}catch(e){console.error("Error parsing memos from realtime:",e),m.current=!1}}).subscribe();return()=>{e.removeChannel(r)}},[]),(0,n.jsxs)("div",{className:"wrap","data-wrap":!0,ref:d,style:{width:"100vw",height:"100vh"},children:[!!e&&(0,n.jsx)("div",{className:"w-screen h-screen bg-gray-500 flex text-white items-center",children:(0,n.jsx)(l,{})}),!e&&r&&r.map(e=>{let{id:t,top:r,left:s,width:a,height:l,text:u}=e;return(0,n.jsx)(i,{id:t,top:r,left:s,width:a,height:l,text:u,onClickDelete:h,onClickMove:p,onClickResize:v,onChangeText:g},t)})]})}},248:function(e,t,r){"use strict";r.d(t,{fz:function(){return n}}),t.ZP=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";window.gtag&&window.gtag("event",t||"click",{event_category:e,event_label:r})};let n={EXPOSE:"화면진입",CLICK:"클릭"}},9301:function(e,t,r){"use strict";r.d(t,{N:function(){return a}});var n=r(6883);let s=null,a=()=>(s||(s=(0,n.eI)("https://halsswnewmblmcqrnwra.supabase.co","sb_publishable_9nXIMFfIH4DJOyyJVncjPg_3KKUMfv4",{realtime:{params:{eventsPerSecond:10}}})),s)},5277:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});for(var n,s=new Uint8Array(16),a=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,i=[],l=0;l<256;++l)i.push((l+256).toString(16).substr(1));var u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(i[e[t+0]]+i[e[t+1]]+i[e[t+2]]+i[e[t+3]]+"-"+i[e[t+4]]+i[e[t+5]]+"-"+i[e[t+6]]+i[e[t+7]]+"-"+i[e[t+8]]+i[e[t+9]]+"-"+i[e[t+10]]+i[e[t+11]]+i[e[t+12]]+i[e[t+13]]+i[e[t+14]]+i[e[t+15]]).toLowerCase();if(!("string"==typeof r&&a.test(r)))throw TypeError("Stringified UUID is invalid");return r},o=function(e,t,r){var a=(e=e||{}).random||(e.rng||function(){if(!n&&!(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(s)})();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){r=r||0;for(var i=0;i<16;++i)t[r+i]=a[i];return t}return u(a)}},7130:function(){}},function(e){e.O(0,[5783,3380,6883,1434,5647,1744],function(){return e(e.s=235)}),_N_E=e.O()}]);