(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9423],{3286:function(e,t,n){Promise.resolve().then(n.bind(n,7059))},7059:function(e,t,n){"use strict";n.d(t,{GamesPageClient:function(){return l}});var i=n(2577),r=n(727),a=n(6201);class s{static getGameSize(){let e=Math.min(window.devicePixelRatio||1,s.isHighEndDevice()?4:3);return{width:window.innerWidth,height:window.innerHeight,pixelRatio:e}}static async toggleFullscreen(e){if("undefined"==typeof document)return!1;try{if(!document.fullscreenElement)return await e.requestFullscreen(),!0;return await document.exitFullscreen(),!1}catch(e){throw console.error("Fullscreen error:",e),e}}static isFullscreen(){return"undefined"!=typeof document&&!!document.fullscreenElement}static isMobile(){return"undefined"!=typeof navigator&&/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)}static isHighEndDevice(){return"undefined"!=typeof navigator&&(navigator.hardwareConcurrency>=8||navigator.deviceMemory>=8||/iPhone|iPad/.test(navigator.userAgent))}static optimizeWebGLContext(e){e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR);let t=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic");if(t){let n=e.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT);e.texParameterf(e.TEXTURE_2D,t.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(n,16))}e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),"hint"in e&&"function"==typeof e.hint&&e.hint(e.GENERATE_MIPMAP_HINT,e.NICEST)}static optimizeCanvasStyle(e){var t,n;e.style.imageRendering="auto",e.style.imageRendering="-webkit-optimize-contrast",e.style.imageRendering="crisp-edges",e.style.willChange="transform",e.style.transform="translateZ(0)",e.style.backfaceVisibility="hidden",e.style.perspective="1000px",e.style.touchAction="none",e.style.userSelect="none";let i=(null===(t=e.getContext)||void 0===t?void 0:t.call(e,"webgl2"))||(null===(n=e.getContext)||void 0===n?void 0:n.call(e,"webgl"));i&&(i.enable(i.DEPTH_TEST),i.depthFunc(i.LEQUAL),i.enable(i.SAMPLE_ALPHA_TO_COVERAGE))}}class o{async initialize(e){if(this.isInitialized&&this.gameInstance){console.warn("Game instance is already initialized");return}let{container:t,onError:i,onLoadStart:r,onLoadComplete:a}=e;try{null==r||r(),this.phaserModule||(this.phaserModule=await Promise.all([n.e(4514),n.e(6764)]).then(n.t.bind(n,2769,23)));let e=this.phaserModule,i=t.getBoundingClientRect();if(0===i.width||0===i.height)throw Error("Container has zero dimensions");let o=await this.loadGameModules(),{width:l,height:c,pixelRatio:u}=s.getGameSize(),d=Math.max(l,100),h=Math.max(c,100),m=d*u,g=h*u,p=this.createPhaserConfig(e,t,o,m,g,d,h,u);this.gameInstance=new e.Game(p),window.game=this.gameInstance,this.applyWebGLOptimizations(e,u),this.applyCanvasOptimizations(t),this.gameInstance&&this.gameInstance.scene.start("DeviceSelectionScene",{}),this.isInitialized=!0,null==a||a()}catch(t){let e=t instanceof Error?t.message:String(t);throw console.error("Failed to initialize game:",t),null==i||i(t instanceof Error?t:Error(e)),t}}async loadGameModules(){let e=this.registry.getAllGames(),t=[];for(let i of e)switch(i.sceneKey){case"SudokuScene":t.push(Promise.all([n.e(4514),n.e(8439),n.e(6874)]).then(n.bind(n,8170)));break;case"YachtDiceScene":t.push(Promise.all([n.e(4514),n.e(3380),n.e(6883),n.e(9964),n.e(3382),n.e(294),n.e(3834),n.e(8439),n.e(573)]).then(n.bind(n,573)));break;case"LasVegasScene":t.push(Promise.all([n.e(4514),n.e(3380),n.e(6883),n.e(9964),n.e(3382),n.e(294),n.e(3834),n.e(8439),n.e(4752)]).then(n.bind(n,4752)));break;case"HalliGalliScene":t.push(Promise.all([n.e(4514),n.e(4893)]).then(n.bind(n,4264)));break;case"UnoScene":t.push(Promise.all([n.e(4514),n.e(3380),n.e(6883),n.e(9964),n.e(3382),n.e(294),n.e(3834),n.e(1327)]).then(n.bind(n,1327)));break;case"DalmutiScene":t.push(Promise.all([n.e(4514),n.e(2796)]).then(n.bind(n,7879)));break;case"IndianHoldemScene":t.push(Promise.all([n.e(4514),n.e(3612)]).then(n.bind(n,2972)));break;default:console.warn("Unknown scene key: ".concat(i.sceneKey))}let i=[Promise.all([n.e(4514),n.e(9964),n.e(7350)]).then(n.bind(n,5523)),Promise.all([n.e(4514),n.e(9964),n.e(294),n.e(7878)]).then(n.bind(n,5502)),Promise.all([n.e(4514),n.e(9964),n.e(7937)]).then(n.bind(n,8819)),Promise.all([n.e(4514),n.e(9964),n.e(231)]).then(n.bind(n,257)),Promise.all([n.e(4514),n.e(3380),n.e(6883),n.e(3382),n.e(1468)]).then(n.bind(n,1468)),Promise.all([n.e(4514),n.e(3380),n.e(6883),n.e(3382),n.e(6455)]).then(n.bind(n,6455))];return await Promise.all([...i,...t])}createPhaserConfig(e,t,n,i,r,a,s,o){if(!e)throw Error("Phaser module is not loaded");let l=n.map(e=>e.default||e);return{type:e.AUTO,width:i,height:r,parent:t,scene:l,backgroundColor:"#1a1a1a",scale:{mode:e.Scale.RESIZE,autoCenter:e.Scale.CENTER_BOTH,width:a,height:s,min:{width:320,height:240},max:{width:7680,height:4320},autoRound:!1},render:{antialias:!0,pixelArt:!1,roundPixels:!1,powerPreference:"high-performance",mipmapFilter:"LINEAR_MIPMAP_LINEAR",batchSize:8192,preserveDrawingBuffer:!1,failIfMajorPerformanceCaveat:!1,premultipliedAlpha:!0},input:{activePointers:10}}}applyWebGLOptimizations(e,t){var n;if(!(null===(n=this.gameInstance)||void 0===n?void 0:n.renderer)||!e)return;let i=this.gameInstance.renderer;"gl"in i&&i.gl&&s.optimizeWebGLContext(i.gl),this.enhanceTextRendering(e,t)}enhanceTextRendering(e,t){if(!e)return;let n=e.GameObjects.GameObjectFactory.prototype.text;e.GameObjects.GameObjectFactory.prototype.text=function(e,i,r,a){let s={...a,resolution:t,fontFamily:(null==a?void 0:a.fontFamily)||'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif'},o=n.call(this,e,i,r,s);return o.style&&(o.style.strokeThickness=0),o}}applyCanvasOptimizations(e){var t;let n=e.querySelector("canvas");n&&s.optimizeCanvasStyle(n),(null===(t=this.gameInstance)||void 0===t?void 0:t.loop)&&(this.gameInstance.loop.targetFps=60)}resize(){if(!this.gameInstance)return;let{width:e,height:t}=s.getGameSize();this.gameInstance.scale.resize(Math.max(e,100),Math.max(t,100))}restartScene(e,t){if(!this.gameInstance)return;let n=this.gameInstance.scene.getScene(e);n&&n.scene.restart(t)}getInstance(){return this.gameInstance}destroy(){this.gameInstance&&(this.gameInstance.destroy(!0),this.gameInstance=null,this.isInitialized=!1)}getIsInitialized(){return this.isInitialized}constructor(){this.gameInstance=null,this.isInitialized=!1,this.phaserModule=null,this.registry=a.P.getInstance()}}function l(){let e=(0,r.useRef)(null),t=(0,r.useRef)(null),[n,a]=(0,r.useState)(null),[s,l]=(0,r.useState)(!1),c=(0,r.useCallback)(t=>{console.error("Game initialization error:",t);let n=t.message||String(t);a("게임을 로드하는 중 오류가 발생했습니다: ".concat(n)),l(!1),e.current&&(e.current.innerHTML='\n        <div style="color: white; padding: 20px; text-align: center;">\n          <p>게임을 로드하는 중 오류가 발생했습니다.</p>\n          <p>페이지를 새로고침해주세요.</p>\n          <p style="font-size: 12px; color: #999;">Error: '.concat(n,"</p>\n        </div>\n      "))},[]),u=(0,r.useCallback)(()=>{l(!0),a(null)},[]),d=(0,r.useCallback)(()=>{l(!1),a(null)},[]);(0,r.useEffect)(()=>(t.current||(t.current=new o),()=>{t.current&&(t.current.destroy(),t.current=null)}),[]),(0,r.useEffect)(()=>{if("undefined"==typeof document)return;let e=()=>{};return document.addEventListener("fullscreenchange",e),()=>{document.removeEventListener("fullscreenchange",e)}},[]),(0,r.useEffect)(()=>{if(!e.current||!t.current)return;let n=null,i=!0,r=async()=>{if(i&&e.current&&t.current)try{let a=e.current.getBoundingClientRect();if(0===a.width||0===a.height){n=setTimeout(()=>{if(i&&e.current){let t=e.current.getBoundingClientRect();t.width>0&&t.height>0&&r()}},100);return}await t.current.initialize({container:e.current,onError:c,onLoadStart:u,onLoadComplete:d})}catch(t){console.error("Failed to initialize game:",t);let e=t instanceof Error?t.message:String(t);c(Error("게임을 로드하는 중 오류가 발생했습니다: ".concat(e)))}},a=setTimeout(()=>{r()},100),s=()=>{if(t.current&&e.current&&i){let n=e.current.getBoundingClientRect();n.width>0&&n.height>0&&t.current.resize()}};return window.addEventListener("resize",s),window.addEventListener("orientationchange",s),()=>{i=!1,a&&clearTimeout(a),n&&clearTimeout(n),window.removeEventListener("resize",s),window.removeEventListener("orientationchange",s)}},[c,u,d]);let h=(0,r.useCallback)(()=>{a(null),l(!0),e.current&&t.current&&(e.current.innerHTML="",t.current.destroy(),t.current=new o,t.current.initialize({container:e.current,onError:c,onLoadStart:u,onLoadComplete:d}).catch(e=>{console.error("Failed to initialize game on retry:",e);let t=e instanceof Error?e.message:String(e);c(Error("게임을 로드하는 중 오류가 발생했습니다: ".concat(t)))}))},[c,u,d]);return(0,i.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,margin:0,padding:0,overflow:"hidden",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:(0,i.jsxs)("div",{id:"games-container",ref:e,style:{width:"100%",height:"100%",margin:0,padding:0,position:"relative",backgroundColor:"#1a1a1a",imageRendering:"auto",textRendering:"optimizeLegibility",WebkitBackfaceVisibility:"hidden",backfaceVisibility:"hidden",transform:"translateZ(0)",willChange:"transform",WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",WebkitPerspective:"1000px",perspective:"1000px",isolation:"isolate",contain:"layout style paint"},children:[s&&(0,i.jsx)("div",{style:{color:"white",padding:"20px",textAlign:"center"},children:"게임을 로드하는 중..."}),n&&(0,i.jsxs)("div",{style:{color:"white",padding:"20px",textAlign:"center"},children:[(0,i.jsx)("p",{style:{color:"#ff4444"},children:n}),(0,i.jsx)("button",{onClick:h,style:{marginTop:"10px",padding:"8px 16px",fontSize:"14px",cursor:"pointer",backgroundColor:"#4CAF50",color:"white",border:"none",borderRadius:"4px"},children:"다시 시도"})]})]})})}},6201:function(e,t,n){"use strict";n.d(t,{P:function(){return i}});class i{static getInstance(){return i.instance||(i.instance=new i),i.instance}registerDefaultGames(){[{name:"스도쿠",sceneKey:"SudokuScene",icon:"\uD83D\uDD22",description:"클래식한 숫자 퍼즐 게임",maxPlayers:1},{name:"Yacht Dice",sceneKey:"YachtDiceScene",icon:"\uD83C\uDFB2",description:"주사위 게임",maxPlayers:4},{name:"Las Vegas",sceneKey:"LasVegasScene",icon:"\uD83C\uDFB0",description:"카지노 게임",maxPlayers:5},{name:"할리갈리",sceneKey:"HalliGalliScene",icon:"\uD83D\uDD14",description:"과일 카드 게임",maxPlayers:4},{name:"우노",sceneKey:"UnoScene",icon:"\uD83C\uDCCF",description:"카드 게임",maxPlayers:4},{name:"달무티",sceneKey:"DalmutiScene",icon:"\uD83D\uDC51",description:"카드 게임",maxPlayers:4},{name:"인디언홀덤",sceneKey:"IndianHoldemScene",icon:"\uD83C\uDCCF",description:"포커 게임",maxPlayers:4}].forEach(e=>{this.register(e)})}register(e){this.games.has(e.sceneKey)&&console.warn("Game ".concat(e.sceneKey," is already registered. Overwriting...")),this.games.set(e.sceneKey,e)}unregister(e){this.games.delete(e)}getGame(e){return this.games.get(e)}getAllGames(){return Array.from(this.games.values())}hasGame(e){return this.games.has(e)}getGameCount(){return this.games.size}constructor(){this.games=new Map,this.registerDefaultGames()}}}},function(e){e.O(0,[1434,5647,1744],function(){return e(e.s=3286)}),_N_E=e.O()}]);