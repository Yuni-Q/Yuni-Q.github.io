(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1896],{8339:function(e,t,r){Promise.resolve().then(r.bind(r,8063))},8063:function(e,t,r){"use strict";r.r(t);var l=r(2577),a=r(727);t.default=()=>{let[e,t]=(0,a.useState)([]),[r,n]=(0,a.useState)(0),o=(0,a.useRef)(!1),c=(0,a.useRef)(!1),s=(0,a.useRef)([0,0]),i=(0,a.useRef)({data:[[]],score:[0,0]}),f=(0,a.useCallback)(()=>{let r=[];if(e.forEach((e,t)=>{e.forEach((e,l)=>{e||r.push([t,l])})}),!r.length)return;let l=r[Math.floor(Math.random()*r.length)];t(e=>{let t=[...e];return t[l[0]][l[1]]=2,t})},[e]),h=(0,a.useCallback)(e=>{let t=[[],[],[],[]],r=[[],[],[],[]],l=0;return e.forEach((e,t)=>{e.forEach(e=>{if(e){let a=r[t];a[a.length-1]===e?(a[a.length-1]*=-2,l+=Math.abs(a[a.length-1])):r[t].push(e)}})}),[,,,,].fill(0).forEach((e,l)=>{[,,,,].fill(0).forEach((e,a)=>{t[l][a]=Math.abs(r[l][a])||0})}),{newData:t,score:l}},[]),u=(0,a.useCallback)(e=>{let t=[[],[],[],[]],r=[[],[],[],[]],l=0;return e.forEach((e,t)=>{e.forEach((a,n)=>{if(e[3-n]){let a=r[t];a[a.length-1]===e[3-n]?(a[a.length-1]*=-2,l+=Math.abs(a[a.length-1])):r[t].push(e[3-n])}})}),[,,,,].fill(0).forEach((e,l)=>{[,,,,].fill(0).forEach((e,a)=>{t[l][3-a]=Math.abs(r[l][a])||0})}),{newData:t,score:l}},[]),d=(0,a.useCallback)(e=>{let t=[[],[],[],[]],r=[[],[],[],[]],l=0;return e.forEach(e=>{e.forEach((e,t)=>{if(e){let a=r[t];a[a.length-1]===e?(a[a.length-1]*=-2,l+=Math.abs(a[a.length-1])):r[t].push(e)}})}),[,,,,].fill(0).forEach((e,l)=>{[,,,,].fill(0).forEach((e,a)=>{t[a][l]=Math.abs(r[l][a])||0})}),{newData:t,score:l}},[]),b=(0,a.useCallback)(e=>{let t=[[],[],[],[]],r=[[],[],[],[]],l=0;return e.forEach((t,a)=>{t.forEach((t,n)=>{if(e[3-a][n]){let t=r[n];t[t.length-1]===e[3-a][n]?(t[t.length-1]*=-2,l+=Math.abs(t[t.length-1])):r[n].push(e[3-a][n])}})}),[,,,,].fill(0).forEach((e,l)=>{[,,,,].fill(0).forEach((e,a)=>{t[3-a][l]=Math.abs(r[l][a])||0})}),{newData:t,score:l}},[]),g=(0,a.useCallback)(r=>{if(console.log(2222),!(null==e?void 0:e[0]))return;let l={newData:e,score:0};switch(r){case"left":l=h(e);break;case"right":l=u(e);break;case"up":l=d(e);break;case"down":l=b(e);break;default:l={newData:e,score:0}}JSON.stringify(e)!==JSON.stringify(l.newData)&&(i.current.data=e,o.current=!0,n(e=>e+l.score)),t(l.newData)},[e]),w=(0,a.useCallback)(()=>{if(!(null==e?void 0:e[0]))return!1;let t=0;return JSON.stringify(e)===JSON.stringify(h(e).newData)&&(t+=1),JSON.stringify(e)===JSON.stringify(u(e).newData)&&(t+=1),JSON.stringify(e)===JSON.stringify(d(e).newData)&&(t+=1),JSON.stringify(e)===JSON.stringify(b(e).newData)&&(t+=1),t>=4},[e]),_=(0,a.useCallback)(()=>{t([[,,,,].fill(0),[,,,,].fill(0),[,,,,].fill(0),[,,,,].fill(0)]),o.current=!0},[]);return(0,a.useEffect)(()=>{_()},[]),(0,a.useEffect)(()=>{let e=e=>{"ArrowUp"===e.key&&g("up"),"ArrowDown"===e.key&&g("down"),"ArrowLeft"===e.key&&g("left"),"ArrowRight"===e.key&&g("right")},t=e=>{s.current=[e.clientX,e.clientY]},r=e=>{let t=[e.clientX,e.clientY],r=t[0]-s.current[0],l=t[1]-s.current[1];r<0&&Math.abs(r)>Math.abs(l)&&g("left"),r>0&&Math.abs(r)>Math.abs(l)&&g("right"),l>0&&Math.abs(r)<=Math.abs(l)&&g("down"),l<0&&Math.abs(r)<=Math.abs(l)&&g("up")};return window.addEventListener("keydown",e),window.addEventListener("mousedown",t),window.addEventListener("mouseup",r),()=>{window.removeEventListener("keydown",e),window.removeEventListener("mousedown",t),window.removeEventListener("mouseup",r)}},[e]),(0,a.useEffect)(()=>{(null==e?void 0:e.length)>3&&!e.flat().every(e=>0===e)&&w()&&setTimeout(()=>{alert("패배했습니다...")},500),!c.current&&e.flat().includes(2048)&&(c.current=!0,setTimeout(()=>{alert("축하합니다. 2048을 만들었습니다.")},500)),e.length>0&&o.current&&(f(),o.current=!1)},[e]),(0,a.useEffect)(()=>{r===i.current.score[1]&&(i.current.score=[r,r]),i.current.score.unshift(r),i.current.score.length=2},[r]),(0,l.jsxs)("div",{className:"select-none [&_.color-2]:bg-[#eee4da] [&_.color-2]:text-[#776e65] [&_.color-4]:bg-[#eee1c9] [&_.color-4]:text-[#776e65] [&_.color-8]:bg-[#f3b27a] [&_.color-8]:text-white [&_.color-16]:bg-[#f69664] [&_.color-16]:text-white [&_.color-32]:bg-[#f77c5f] [&_.color-32]:text-white [&_.color-64]:bg-[#f75f3b] [&_.color-64]:text-white [&_.color-128]:bg-[#edd073] [&_.color-128]:text-[#776e65] [&_.color-256]:bg-[#edcc62] [&_.color-256]:text-[#776e65] [&_.color-512]:bg-[#edc950] [&_.color-512]:text-[#776e65] [&_.color-1024]:bg-[#edc53f] [&_.color-1024]:text-[#776e65] [&_.color-2048]:bg-[#edc22e] [&_.color-2048]:text-[#776e65]",children:[(0,l.jsx)("table",{className:"[&_td]:border-[10px] [&_td]:border-[#bbada0] [&_td]:w-[116px] [&_td]:h-[128px] [&_td]:text-[50px] [&_td]:font-bold [&_td]:text-center",children:(0,l.jsx)("tbody",{children:e.map((e,t)=>(0,l.jsx)("tr",{children:e.map((e,t)=>(0,l.jsx)("td",{className:"color-".concat(e),children:!!e&&e},"".concat(e,"-").concat(t)))},"".concat(e,"-").concat(t)))})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{children:r}),(0,l.jsx)("button",{onClick:e=>{e.stopPropagation(),t(i.current.data),n(i.current.score[1])},children:"되돌리기"})]})]})}}},function(e){e.O(0,[1434,5647,1744],function(){return e(e.s=8339)}),_N_E=e.O()}]);