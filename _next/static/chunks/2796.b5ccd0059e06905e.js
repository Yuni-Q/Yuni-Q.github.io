(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2796,6764],{7879:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return o}});var a=s(2769);class r{initializeDeck(){this.deck=[];for(let t=1;t<=12;t++)for(let e=0;e<t;e++)this.deck.push({rank:t,isJoker:!1});this.deck.push({rank:0,isJoker:!0}),this.deck.push({rank:0,isJoker:!0}),this.deck=function(t){let e=[...t];for(let t=e.length-1;t>0;t--){let s=Math.floor(Math.random()*(t+1));[e[t],e[s]]=[e[s],e[t]]}return e}(this.deck)}dealCards(){this.playerHands=function(t,e){let s=[];for(let t=0;t<e;t++)s[t]=[];let a=Math.floor(t.length/e);for(let r=0;r<e;r++)s[r]=t.slice(r*a,(r+1)*a);return s}(this.deck,this.numberOfPlayers),this.playerHands.forEach(t=>{t.sort((t,e)=>t.isJoker&&!e.isJoker?-1:!t.isJoker&&e.isJoker?1:t.rank-e.rank)})}determineFirstPlayer(){this.currentPlayer=Math.floor(Math.random()*this.numberOfPlayers)}isValidPlay(t){var e,s;if(0===this.lastPlayedCards.length){if(0===t.length)return!1;let e=t[0].isJoker?-1:t[0].rank;return t.every(t=>t.isJoker||t.rank===e)}if(t.length!==this.lastPlayedCount)return!1;let a=t[0].isJoker?null===(e=t.find(t=>!t.isJoker))||void 0===e?void 0:e.rank:t[0].rank;if(!a)return!1;let r=this.lastPlayedCards[0].isJoker?null===(s=this.lastPlayedCards.find(t=>!t.isJoker))||void 0===s?void 0:s.rank:this.lastPlayedCards[0].rank;return!!r&&!(a>=r)&&t.every(t=>t.isJoker||t.rank===a)}playCards(t,e){let s=e.map(e=>this.playerHands[t][e]).sort((t,e)=>t.isJoker&&!e.isJoker?-1:!t.isJoker&&e.isJoker?1:t.rank-e.rank);return!!this.isValidPlay(s)&&([...e].sort((t,e)=>e-t).forEach(e=>{this.playerHands[t].splice(e,1)}),this.lastPlayedCards=s,this.lastPlayedCount=s.length,!0)}playCardsForAI(t,e){e.forEach(e=>{let s=this.playerHands[t].findIndex(t=>t.rank===e.rank&&t.isJoker===e.isJoker);s>=0&&this.playerHands[t].splice(s,1)}),this.lastPlayedCards=e,this.lastPlayedCount=e.length}nextPlayer(){this.currentPlayer=(this.currentPlayer+1)%this.numberOfPlayers}resetRound(){this.lastPlayedCards=[],this.lastPlayedCount=0}getPlayerHand(t){return this.playerHands[t]}getCurrentPlayer(){return this.currentPlayer}getLastPlayedCards(){return this.lastPlayedCards}getLastPlayedCount(){return this.lastPlayedCount}getNumberOfPlayers(){return this.numberOfPlayers}isPlayerHandEmpty(t){return 0===this.playerHands[t].length}constructor(t){this.deck=[],this.playerHands=[],this.currentPlayer=0,this.lastPlayedCards=[],this.lastPlayedCount=0,this.numberOfPlayers=t}}class i{static selectCards(t,e){let s=t.getPlayerHand(e),a=t.getLastPlayedCards(),r=t.getLastPlayedCount();return 0===a.length?this.selectFirstPlayCards(s):this.selectHigherRankCards(s,a,r)}static selectFirstPlayCards(t){let e=new Map;t.forEach(t=>{let s=t.isJoker?-1:t.rank;e.has(s)||e.set(s,[]),e.get(s).push(t)});let s=[],a=13;return(e.forEach((t,e)=>{(t.length>s.length||t.length===s.length&&e<a)&&(s=t,a=e)}),s.length>0)?s.slice(0,Math.min(s.length,3)):null}static selectHigherRankCards(t,e,s){var a;let r=e[0].isJoker?(null===(a=e.find(t=>!t.isJoker))||void 0===a?void 0:a.rank)||13:e[0].rank,i=new Map;for(let[e,a]of(t.forEach(t=>{let e=t.isJoker?-1:t.rank;i.has(e)||i.set(e,[]),i.get(e).push(t)}),i.entries()))if(a.length>=s&&e<r)return a.slice(0,s);return null}}var n=s(8782);class l{createGameUI(){let t=this.scene.cameras.main.width,e=this.scene.cameras.main.height;this.createPlayerInfo(t,e),this.createStatusText(t,e),this.createButtons(t,e),this.updateLastPlayedDisplay(),this.updateHandDisplay()}createPlayerInfo(t,e){let s=.15*e,a=t/(this.game.getNumberOfPlayers()+1);this.playerCardCountTexts=[];for(let r=0;r<this.game.getNumberOfPlayers();r++){let i=a*(r+1),n=r===this.game.getCurrentPlayer();this.scene.add.rectangle(i,s,.12*t,.1*e,n?9127187:3355443,.9).setStrokeStyle(2,n?16766720:6710886),this.scene.add.text(i,s-.03*e,"플레이어 ".concat(r+1),{fontSize:"".concat(.02*e,"px"),color:"#fff",fontStyle:"bold"}).setOrigin(.5);let l=this.scene.add.text(i,s+.02*e,"".concat(this.game.getPlayerHand(r).length,"장"),{fontSize:"".concat(.025*e,"px"),color:n?"#ffd700":"#fff",fontStyle:"bold"});l.setOrigin(.5),this.playerCardCountTexts.push(l)}this.currentPlayerIndicator=this.scene.add.text(t/2,.28*e,"플레이어 ".concat(this.game.getCurrentPlayer()+1,"의 턴"),{fontSize:"".concat(.04*e,"px"),color:"#ffd700",fontStyle:"bold"}),this.currentPlayerIndicator.setOrigin(.5)}createStatusText(t,e){this.statusText=this.scene.add.text(t/2,.33*e,"카드를 선택하세요",{fontSize:"".concat(.03*e,"px"),color:"#fff"}),this.statusText.setOrigin(.5)}createButtons(t,e){n.vz.create(this.scene,{x:t/2-.15*t,y:.9*e,width:.2*t,height:.08*e,text:"내기",backgroundColor:5025616,strokeColor:8505220,fontSize:.035*e,onClick:()=>{var t;return null===(t=this.playButtonHandler)||void 0===t?void 0:t.call(this)}}),n.vz.create(this.scene,{x:t/2+.15*t,y:.9*e,width:.2*t,height:.08*e,text:"패스",backgroundColor:16007990,strokeColor:15037299,fontSize:.035*e,onClick:()=>{var t;return null===(t=this.passButtonHandler)||void 0===t?void 0:t.call(this)}}),n.vz.create(this.scene,{x:.9*t,y:.05*e,width:.15*t,height:.08*e,text:"메인 메뉴",backgroundColor:6710886,strokeColor:10066329,fontSize:.03*e,onClick:()=>{var t;return null===(t=this.menuButtonHandler)||void 0===t?void 0:t.call(this)}})}createCardObject(t,e,s,a){let r=this.scene.add.container(0,0),i=1.4*s,n=this.scene.add.rectangle(t,e,s,i,16777215,1);if(n.setStrokeStyle(2,0),a.isJoker){let a=this.scene.add.rectangle(t,e,.9*s,.6*i,0,1),l=this.scene.add.text(t,e,"JOKER",{fontSize:"".concat(.2*s,"px"),color:"#fff",fontStyle:"bold"});l.setOrigin(.5),r.add([n,a,l])}else{let i=this.scene.add.text(t,e,a.rank.toString(),{fontSize:"".concat(.4*s,"px"),color:"#000",fontStyle:"bold"});i.setOrigin(.5),r.add([n,i])}return r}updateHandDisplay(){let t=this.scene.cameras.main.width,e=this.scene.cameras.main.height;if(this.handCardObjects.forEach(t=>t.destroy()),this.handCardObjects=[],0!==this.game.getCurrentPlayer())return;let s=this.game.getPlayerHand(0),a=Math.min(.06*t,.08*e),r=.1*a,i=.75*e,l=t/2-(s.length-1)*(a+r)/2;s.forEach((t,e)=>{let s=this.createCardObject(l+e*(a+r),i,a,t);if(s.setInteractive({useHandCursor:!0}),s.on("pointerdown",()=>{n.Wc.setup(s,()=>{this.toggleCardSelection(e)})}),s.on("pointerover",()=>{s.setScale(1.1)}),s.on("pointerout",()=>{s.setScale(1)}),this.selectedCards.includes(e)){s.setScale(1.15);let t=s.list[0];t&&"setFillStyle"in t&&t.setFillStyle(16776960,.5)}this.handCardObjects.push(s)})}toggleCardSelection(t){if(0!==this.game.getCurrentPlayer())return;let e=this.selectedCards.indexOf(t);e>=0?this.selectedCards.splice(e,1):this.selectedCards.push(t),this.updateHandDisplay()}updateLastPlayedDisplay(){let t=this.scene.cameras.main.width,e=this.scene.cameras.main.height;this.lastPlayedDisplay&&this.lastPlayedDisplay.destroy();let s=this.game.getLastPlayedCards();if(0===s.length){let s=this.scene.add.text(t/2,.45*e,"아직 낸 카드가 없습니다",{fontSize:"".concat(.025*e,"px"),color:"#999"});s.setOrigin(.5),this.lastPlayedDisplay=this.scene.add.container(0,0),this.lastPlayedDisplay.add([s]);return}let a=Math.min(.08*t,.1*e),r=.1*a,i=.45*e,n=t/2-(s.length-1)*(a+r)/2,l=this.scene.add.container(0,0);s.forEach((t,e)=>{let s=this.createCardObject(n+e*(a+r),i,a,t);l.add(s)}),this.lastPlayedDisplay=l}updateGameState(){for(let t=0;t<this.game.getNumberOfPlayers();t++){this.playerCardCountTexts[t].setText("".concat(this.game.getPlayerHand(t).length,"장"));let e=t===this.game.getCurrentPlayer();this.playerCardCountTexts[t].setColor(e?"#ffd700":"#fff")}this.currentPlayerIndicator&&this.currentPlayerIndicator.setText("플레이어 ".concat(this.game.getCurrentPlayer()+1,"의 턴")),this.updateLastPlayedDisplay(),this.updateHandDisplay()}getSelectedCards(){return this.selectedCards}clearSelectedCards(){this.selectedCards=[]}setStatusMessage(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#fff";this.statusText.setText(t),this.statusText.setColor(e)}setPlayHandler(t){this.playButtonHandler=t}setPassHandler(t){this.passButtonHandler=t}setMenuHandler(t){this.menuButtonHandler=t}constructor(t,e){this.handCardObjects=[],this.playerCardCountTexts=[],this.selectedCards=[],this.playButtonHandler=null,this.passButtonHandler=null,this.menuButtonHandler=null,this.scene=t,this.game=e}}class o extends a.Scene{create(){let t=this.cameras.main.width,e=this.cameras.main.height;this.add.rectangle(t/2,e/2,t,e,2758672,1),this.add.text(t/2,.05*e,"달무티",{fontSize:"".concat(.06*e,"px"),color:"#ffd700",fontStyle:"bold"}).setOrigin(.5),this.showPlayerSelection()}showPlayerSelection(){let t=this.cameras.main.width,e=this.cameras.main.height,s=t/2,a=e/2;this.add.text(s,a-.2*e,"플레이어 수를 선택하세요",{fontSize:"".concat(.04*e,"px"),color:"#fff"}).setOrigin(.5);let r=[3,4,5,6],i=.15*t,l=.1*e,o=.03*t,c=s-(r.length-1)*(i+o)/2;r.forEach((t,s)=>{let r=c+s*(i+o),h=this.add.rectangle(r,a,i,l,9127187,.9);h.setStrokeStyle(3,16766720),h.setInteractive({useHandCursor:!0}),n.Wc.setup(h,()=>{this.numberOfPlayers=t,this.startGame()});let d=this.add.text(r,a,"".concat(t,"명"),{fontSize:"".concat(.04*e,"px"),color:"#fff",fontStyle:"bold"});d.setOrigin(.5),d.setInteractive({useHandCursor:!0}),n.Wc.setup(d,()=>{this.numberOfPlayers=t,this.startGame()})});let h=this.add.rectangle(s,a+.2*e,i,.7*l,6710886,.9);h.setStrokeStyle(3,10066329),h.setInteractive({useHandCursor:!0}),n.Wc.setup(h,()=>{this.goToMainMenu()});let d=this.add.text(s,a+.2*e,"메인 메뉴",{fontSize:"".concat(.035*e,"px"),color:"#fff",fontStyle:"bold"});d.setOrigin(.5),d.setInteractive({useHandCursor:!0}),n.Wc.setup(d,()=>{this.goToMainMenu()})}startGame(){let t=this.cameras.main.width,e=this.cameras.main.height;this.children.removeAll(),this.add.rectangle(t/2,e/2,t,e,2758672,1),this.dalmutiGame=new r(this.numberOfPlayers),this.dalmutiGame.initializeDeck(),this.dalmutiGame.dealCards(),this.dalmutiGame.determineFirstPlayer(),this.isGameActive=!0,this.ui=new l(this,this.dalmutiGame),this.ui.createGameUI(),this.setupUIHandlers(),this.updateGameState()}setupUIHandlers(){this.ui.setPlayHandler(()=>this.playCards()),this.ui.setPassHandler(()=>this.pass()),this.ui.setMenuHandler(()=>this.goToMainMenu())}playCards(){if(0!==this.dalmutiGame.getCurrentPlayer())return;let t=this.ui.getSelectedCards();if(0===t.length){this.ui.setStatusMessage("카드를 선택하세요","#f44336");return}if(!this.dalmutiGame.playCards(0,t)){this.ui.setStatusMessage("낼 수 없는 카드 조합입니다","#f44336");return}if(this.ui.clearSelectedCards(),this.dalmutiGame.isPlayerHandEmpty(0)){this.showWinMessage(0);return}this.updateGameState(),this.nextPlayer()}pass(){if(0!==this.dalmutiGame.getCurrentPlayer())return;let t=0;for(let e=0;e<this.dalmutiGame.getNumberOfPlayers();e++)this.dalmutiGame.isPlayerHandEmpty(e)&&t++;t===this.dalmutiGame.getNumberOfPlayers()-1&&this.dalmutiGame.resetRound(),this.nextPlayer()}nextPlayer(){this.dalmutiGame.nextPlayer(),0!==this.dalmutiGame.getCurrentPlayer()&&this.isGameActive&&this.time.delayedCall(1e3,()=>{this.aiPlay()}),this.updateGameState()}aiPlay(){if(!this.isGameActive)return;let t=this.dalmutiGame.getCurrentPlayer();if(0===t)return;let e=i.selectCards(this.dalmutiGame,t);if(e){if(this.dalmutiGame.playCardsForAI(t,e),this.dalmutiGame.isPlayerHandEmpty(t)){this.showWinMessage(t);return}this.updateGameState(),this.nextPlayer()}else this.pass()}updateGameState(){this.ui.updateGameState()}showWinMessage(t){this.isGameActive=!1;let e=this.cameras.main.width,s=this.cameras.main.height,a=e/2,r=s/2;this.add.rectangle(a,r,e,s,0,.7),this.add.rectangle(a,r,.6*e,.4*s,2763306,1).setStrokeStyle(4,16766720),this.add.text(a,r-.1*s,"\uD83C\uDF89 플레이어 ".concat(t+1," 승리!"),{fontSize:"".concat(.06*s,"px"),color:"#ffd700",fontStyle:"bold"}).setOrigin(.5);let i=this.add.rectangle(a,r+.1*s,.3*e,.08*s,9127187,.9);i.setStrokeStyle(3,16766720),i.setInteractive({useHandCursor:!0}),n.Wc.setup(i,()=>{this.goToMainMenu()});let l=this.add.text(a,r+.1*s,"메인 메뉴",{fontSize:"".concat(.035*s,"px"),color:"#fff",fontStyle:"bold"});l.setOrigin(.5),l.setInteractive({useHandCursor:!0}),n.Wc.setup(l,()=>{this.goToMainMenu()})}goToMainMenu(){n.rX.startScene(this,"DeviceSelectionScene")}constructor(){super("DalmutiScene"),this.numberOfPlayers=3,this.isGameActive=!1}}},8782:function(t,e,s){"use strict";s.d(e,{Wc:function(){return r},rX:function(){return a},vz:function(){return i}});class a{static startScene(t,e,s){if(t.scene.start(e,s),!t.game){let s=t.scene.key;if(s&&s!==e){let a=t.scene.get(s);a&&a.scene.isActive()&&(console.log("[SceneTransitionUtils] Stopping current scene: ".concat(s," -> ").concat(e)),a.scene.stop())}return}let a=t.game.scene.scenes||[],r=[];for(let t of a){let s=t.scene.key;s!==e&&t.scene.isActive()&&(console.log("[SceneTransitionUtils] Stopping active scene: ".concat(s," (transitioning to ").concat(e,")")),t.scene.stop(),r.push(s))}r.length>0&&console.log("[SceneTransitionUtils] Stopped ".concat(r.length," scene(s): [").concat(r.join(", "),"] -> ").concat(e))}}class r{static setup(t,e){let s=0,a=0,r=!1;t.on("pointerdown",t=>{s=t.x,a=t.y,r=!1}),t.on("pointermove",t=>{if(t.isDown){let e=Math.abs(t.x-s),i=Math.abs(t.y-a);(e>this.DRAG_THRESHOLD||i>this.DRAG_THRESHOLD)&&(r=!0)}}),t.on("pointerup",()=>{r||e(),r=!1}),t.on("pointercancel",()=>{r=!1})}}r.DRAG_THRESHOLD=10;class i{static create(t,e){let{x:s,y:a,width:i,height:n,text:l,backgroundColor:o=2201331,backgroundAlpha:c=.9,strokeColor:h=6600182,strokeWidth:d=3,textColor:u="#fff",fontSize:f,onClick:y}=e,m=t.add.container(0,0),g=t.add.rectangle(s,a,i,n,o,c);g.setStrokeStyle(d,h),g.setInteractive({useHandCursor:!0}),r.setup(g,y);let p=t.add.text(s,a,l,{fontSize:f?"".concat(f,"px"):void 0,color:u,fontStyle:"bold"});return p.setOrigin(.5),p.setInteractive({useHandCursor:!0}),r.setup(p,y),m.add([g,p]),{container:m,background:g,text:p}}}},6764:function(t,e,s){"use strict";var a,r;t.exports=(null==(a=s.g.process)?void 0:a.env)&&"object"==typeof(null==(r=s.g.process)?void 0:r.env)?s.g.process:s(6515)},6515:function(t){!function(){var e={229:function(t){var e,s,a,r=t.exports={};function i(){throw Error("setTimeout has not been defined")}function n(){throw Error("clearTimeout has not been defined")}function l(t){if(e===setTimeout)return setTimeout(t,0);if((e===i||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(s){try{return e.call(null,t,0)}catch(s){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:i}catch(t){e=i}try{s="function"==typeof clearTimeout?clearTimeout:n}catch(t){s=n}}();var o=[],c=!1,h=-1;function d(){c&&a&&(c=!1,a.length?o=a.concat(o):h=-1,o.length&&u())}function u(){if(!c){var t=l(d);c=!0;for(var e=o.length;e;){for(a=o,o=[];++h<e;)a&&a[h].run();h=-1,e=o.length}a=null,c=!1,function(t){if(s===clearTimeout)return clearTimeout(t);if((s===n||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(t);try{s(t)}catch(e){try{return s.call(null,t)}catch(e){return s.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function y(){}r.nextTick=function(t){var e=Array(arguments.length-1);if(arguments.length>1)for(var s=1;s<arguments.length;s++)e[s-1]=arguments[s];o.push(new f(t,e)),1!==o.length||c||l(u)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=y,r.addListener=y,r.once=y,r.off=y,r.removeListener=y,r.removeAllListeners=y,r.emit=y,r.prependListener=y,r.prependOnceListener=y,r.listeners=function(t){return[]},r.binding=function(t){throw Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw Error("process.chdir is not supported")},r.umask=function(){return 0}}},s={};function a(t){var r=s[t];if(void 0!==r)return r.exports;var i=s[t]={exports:{}},n=!0;try{e[t](i,i.exports,a),n=!1}finally{n&&delete s[t]}return i.exports}a.ab="//";var r=a(229);t.exports=r}()}}]);