{"version":3,"sources":["webpack:///./src/pages/candy-crush-walk-through.tsx"],"names":["Grid","styled","div","candyColor","CandyCrushWalkThrough","useState","colorBeingDragged","setColorBeingDragged","colorBeingReplaced","setColorBeingReplaced","squareIdBeingDragged","setSquareIdBeingDragged","squareIdBeingReplaced","setSquareIdBeingReplaced","endMove","setEndMove","Array","WITH","fill","map","Math","floor","random","length","colors","setColors","score","setScore","checkGrid","useCallback","newColor","checkBox","check","i","array","notValid","decidedColor","includes","every","index","forEach","JSON","stringify","newScore","reduce","prev","curr","useEffect","moveDown","color","idx","onDragStart","e","target","style","background","parseInt","id","onDragOver","preventDefault","onDragEnter","onDrop","newColors","onDragEnd","validMove","draggable","toString","key"],"mappings":"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","file":"component---src-pages-candy-crush-walk-through-tsx-f6997add4c1b5157a9b9.js","sourcesContent":["import React, { useCallback, useEffect, useState } from 'react';\nimport styled from 'styled-components';\n\nconst Grid = styled.div`\n  height: 560px;\n  width: 560px;\n  display: flex;\n  flex-wrap: wrap;\n  > div {\n    width: 70px;\n    height: 70px;\n  }\n`;\n\nconst candyColor = [\n  'url(\"/images/candy/red-candy.png\")',\n  'url(\"/images/candy/yellow-candy.png\")',\n  'url(\"/images/candy/orange-candy.png\")',\n  'url(\"/images/candy/purple-candy.png\")',\n  'url(\"/images/candy/green-candy.png\")',\n  'url(\"/images/candy/blue-candy.png\")',\n];\n\nconst WITH = 8;\n\nconst CandyCrushWalkThrough: React.VFC = () => {\n  const [colorBeingDragged, setColorBeingDragged] = useState('');\n  const [colorBeingReplaced, setColorBeingReplaced] = useState('');\n  const [squareIdBeingDragged, setSquareIdBeingDragged] = useState(0);\n  const [squareIdBeingReplaced, setSquareIdBeingReplaced] = useState(0);\n  const [endMove, setEndMove] = useState(true);\n  const [colors, setColors] = useState<string[]>(\n    Array(WITH * WITH)\n      .fill(0)\n      .map(() => candyColor[Math.floor(Math.random() * candyColor.length)]),\n  );\n  const [score, setScore] = useState(0);\n  const checkGrid = useCallback(() => {\n    const newColor = [...colors];\n    const checkBox = (check) => {\n      for (let i = 0; i < 62; i++) {\n        const { array, notValid } = check(i);\n        const decidedColor = newColor[i];\n        if (notValid.includes(i)) {\n          continue;\n        }\n        if (array.every((index) => colors[index] === decidedColor)) {\n          array.forEach((index) => {\n            newColor[index] = '';\n          });\n        }\n      }\n    };\n    const checkFourRowIndexArray = (i: number) => {\n      return {\n        array: [i, i + 1, i + 2, i + 3],\n        notValid: [\n          5,\n          6,\n          7,\n          13,\n          14,\n          15,\n          21,\n          22,\n          23,\n          29,\n          30,\n          31,\n          37,\n          38,\n          39,\n          45,\n          46,\n          47,\n          53,\n          54,\n          55,\n        ],\n      };\n    };\n    const checkThreeRowIndexArray = (i: number) => {\n      return {\n        array: [i, i + 1, i + 2],\n        notValid: [6, 7, 14, 15, 22, 23, 30, 31, 38, 39, 46, 47, 54, 55],\n      };\n    };\n    const checkFourColumnIndexArray = (i: number) => {\n      return {\n        array: [i, i + WITH, i + WITH * 2, i + WITH * 3],\n        notValid: [],\n      };\n    };\n    const checkThreeColumnIndexArray = (i: number) => {\n      return {\n        array: [i, i + WITH, i + WITH * 2],\n        notValid: [],\n      };\n    };\n    checkBox(checkFourRowIndexArray);\n    checkBox(checkFourColumnIndexArray);\n    checkBox(checkThreeRowIndexArray);\n    checkBox(checkThreeColumnIndexArray);\n\n    if (JSON.stringify(colors) !== JSON.stringify(newColor)) {\n      const newScore = newColor.reduce((prev, curr) => {\n        if (curr === '') {\n          return prev + 1;\n        }\n        return prev;\n      }, 0);\n      setScore((score) => {\n        return score + newScore;\n      });\n      setColors(newColor);\n    }\n  }, [colors]);\n  useEffect(() => {\n    checkGrid();\n  }, [endMove]);\n  useEffect(() => {\n    const newColor = [...colors];\n    const moveDown = () => {\n      for (let i = 0; i < 56; i++) {\n        if (newColor[i + WITH] === '') {\n          newColor[i + WITH] = newColor[i];\n          newColor[i] = '';\n        }\n        const firstRow = [0, 1, 2, 3, 4, 5, 6, 7];\n        const isFirstRow = firstRow.includes(i);\n        if (isFirstRow && newColor[i] === '') {\n          newColor[i] =\n            candyColor[Math.floor(Math.random() * candyColor.length)];\n        }\n      }\n\n      if (JSON.stringify(colors) !== JSON.stringify(newColor)) {\n        setColors(newColor);\n      } else {\n        setEndMove((endMove) => !endMove);\n      }\n    };\n    moveDown();\n  }, [colors]);\n  return (\n    <Grid>\n      {colors.map((color, idx) => {\n        return (\n          <div\n            onDragStart={(e) => {\n              const target = e.target as HTMLDivElement;\n              setColorBeingDragged(target.style.background);\n              setSquareIdBeingDragged(parseInt(target.id, 10));\n            }}\n            onDragOver={(e) => {\n              e.preventDefault();\n            }}\n            onDragEnter={(e) => {\n              e.preventDefault();\n            }}\n            // onDragLeave={(e) => {\n            //   console.log(e);\n            // }}\n            onDrop={(e) => {\n              const target = e.target as HTMLDivElement;\n              setColorBeingReplaced(target.style.background);\n              const id = parseInt(target.id, 10);\n              setSquareIdBeingReplaced(id);\n              setColors((colors) => {\n                const newColors = [...colors];\n                newColors[id] = colorBeingDragged;\n                newColors[squareIdBeingDragged] = target.style.background;\n                return newColors;\n              });\n            }}\n            onDragEnd={(e) => {\n              const validMoves = [\n                squareIdBeingDragged - 1,\n                squareIdBeingDragged - WITH,\n                squareIdBeingDragged + 1,\n                squareIdBeingDragged + WITH,\n              ];\n              const validMove = validMoves.includes(squareIdBeingReplaced);\n\n              if (squareIdBeingReplaced && validMove) {\n                setSquareIdBeingReplaced(null);\n                checkGrid();\n              } else if (squareIdBeingReplaced && !validMove) {\n                setColors((colors) => {\n                  const newColors = [...colors];\n                  newColors[squareIdBeingReplaced] = colorBeingReplaced;\n                  newColors[squareIdBeingDragged] = colorBeingDragged;\n                  return newColors;\n                });\n              } else {\n                setColors((colors) => {\n                  const newColors = [...colors];\n                  newColors[squareIdBeingDragged] = colorBeingDragged;\n                  return newColors;\n                });\n              }\n            }}\n            draggable\n            id={idx.toString()}\n            style={{ background: color }}\n            key={idx}\n          />\n        );\n      })}\n      {score}점\n    </Grid>\n  );\n};\n\nexport default CandyCrushWalkThrough;\n\n// 4각형 없애기\n// 아이템 만들기\n"],"sourceRoot":""}