"use strict";(self.webpackChunkyuni_q_blog=self.webpackChunkyuni_q_blog||[]).push([[1448],{6919:function(e,r,t){t.r(r);var n=t(4506),c=t(6540);const u=t(2568).default.table.withConfig({displayName:"tetris__Table",componentId:"sc-fnvdcy-0"})(["width:auto !important;border-collapse:collapse !important;td{border:1px solid black;width:30px;height:30px;padding:0;}"]),l=[{name:"s",center:!1,numCode:1,color:"red",currentShapeIndex:0,shape:[[[0,0,0],[0,1,1],[0,1,1]]]},{name:"t",center:!0,numCode:2,color:"orange",currentShapeIndex:0,shape:[[[0,0,0],[1,1,1],[0,1,0]],[[0,1,0],[1,1,0],[0,1,0]],[[0,1,0],[1,1,1],[0,0,0]],[[0,1,0],[0,1,1],[0,1,0]]]},{name:"z",center:!0,numCode:3,color:"yellow",currentShapeIndex:0,shape:[[[0,0,0],[1,1,0],[0,1,1]],[[0,1,0],[1,1,0],[1,0,0]],[[1,1,0],[0,1,1],[0,0,0]],[[0,0,1],[0,1,1],[0,1,0]]]},{name:"zr",center:!0,numCode:4,color:"green",startRow:1,currentShapeIndex:0,shape:[[[0,0,0],[0,1,1],[1,1,0]],[[1,0,0],[1,1,0],[0,1,0]],[[0,1,1],[1,1,0],[0,0,0]],[[0,1,0],[0,1,1],[0,0,1]]]},{name:"l",center:!0,numCode:5,color:"blue",currentShapeIndex:0,shape:[[[0,0,0],[1,1,1],[1,0,0]],[[1,1,0],[0,1,0],[0,1,0]],[[0,0,1],[1,1,1],[0,0,0]],[[0,1,0],[0,1,0],[0,1,1]]]},{name:"lr",center:!0,numCode:6,color:"navy",currentShapeIndex:0,shape:[[[0,0,0],[1,1,1],[0,0,1]],[[0,1,0],[0,1,0],[1,1,0]],[[1,0,0],[1,1,1],[0,0,0]],[[0,1,1],[0,1,0],[0,1,0]]]},{name:"b",center:!0,numCode:7,color:"violet",currentShapeIndex:0,shape:[[[0,0,0,0],[0,0,0,0],[1,1,1,1],[0,0,0,0]],[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]],[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],[[0,0,1,0],[0,0,1,0],[0,0,1,0],[0,0,1,0]]]}],o=["red","orange","yellow","green","blue","navy","violet"],a=e=>e>0&&e<10,s=e=>void 0===e||e>=10;r.default=()=>{const{0:e,1:r}=(0,c.useState)(Array(20).fill([]).map((e=>Array(10).fill(0)))),{0:t,1:h}=(0,c.useState)(Array(4).fill([]).map((e=>Array(4).fill(0)))),{0:d,1:p}=(0,c.useState)(0),f=(0,c.useRef)(null),i=(0,c.useRef)(null),m=(0,c.useRef)(!0),g=(0,c.useRef)(null),v=(0,c.useRef)([0,3]);const y=()=>{r((e=>{const r=[v.current[0]+1,v.current[1]];let t=!0;const c=f.current.shape[f.current.currentShapeIndex];for(let n=v.current[0];n<v.current[0]+c.length;n++)if(!(n<0||n>=20))for(let r=v.current[1];r<v.current[1]+c.length;r++)a(e[n][r])&&s(e[n+1]&&e[n+1][r])&&(t=!1);t?v.current=r:m.current=!0;const u=(0,n.A)(e.map((e=>(0,n.A)(e))));for(let n=u.length-1;n>=0;n--){e[n].forEach(((e,r)=>{var c;e>0&&e<10&&(null===(c=u[n+1])||void 0===c?void 0:c[r])<10&&t?(u[n+1][r]=e,u[n][r]=0):0!==e&&e<10&&(u[n][r]=10*e)}))}const l=(e=>{const r=[];e.forEach(((e,t)=>{let n=0;e.forEach(((e,r)=>{e>0&&n++})),10===n&&r.push(t)}));const t=r.length;e=e.filter(((e,t)=>!r.includes(t)));for(let n=0;n<t;n++)e.unshift([0,0,0,0,0,0,0,0,0,0]);return p((e=>e+t**2)),e})(u);return JSON.stringify(u)!==JSON.stringify(e)?l:e}))};return(0,c.useEffect)((()=>{h((e=>e.map(((e,r)=>e.map(((e,t)=>{var n,c,u,l;return null!=i&&null!==(n=i.current)&&void 0!==n&&null!==(c=n.shape)&&void 0!==c&&null!==(u=c[0])&&void 0!==u&&null!==(l=u[r])&&void 0!==l&&l[t]&&i.current.shape[0][r][t]?i.current.numCode:0}))))))}),[i.current]),(0,c.useEffect)((()=>{const e=e=>{r((r=>{switch(e.code){case"ArrowLeft":{const e=[v.current[0],v.current[1]-1];let t=!0;const n=f.current.shape[f.current.currentShapeIndex];for(let c=v.current[0];c<v.current[0]+n.length&&t;c++)for(let e=v.current[1];e<v.current[1]+n.length;e++)r[c]&&r[c][e]&&a(r[c][e])&&s(r[c]&&r[c][e-1])&&(t=!1);t&&(v.current=e,r.forEach(((e,t)=>{for(let n=0;n<e.length;n++){const c=e[n];0===r[t][n-1]&&c<10&&(r[t][n-1]=c,r[t][n]=0)}})));break}case"ArrowRight":{const e=[v.current[0],v.current[1]+1];let t=!0;const n=f.current.shape[f.current.currentShapeIndex];for(let c=v.current[0];c<v.current[0]+n.length&&t;c++)for(let e=v.current[1];e<v.current[1]+n.length;e++)r[c]&&r[c][e]&&a(r[c][e])&&s(r[c]&&r[c][e+1])&&(t=!1);t&&(v.current=e,r.forEach(((e,t)=>{for(let n=e.length-1;n>=0;n--){const c=e[n];0===r[t][n+1]&&c<10&&(r[t][n+1]=c,r[t][n]=0)}})));break}case"ArrowDown":y()}return r}))},t=e=>{switch(e.code){case"Space":for(;!m.current;)y();break;case"ArrowUp":r((e=>{const r=f.current.shape[f.current.currentShapeIndex];let t=!0;const n=f.current.currentShapeIndex+1===f.current.shape.length?0:f.current.currentShapeIndex+1,c=f.current.shape[n];for(let u=v.current[0];u<v.current[0]+r.length&&t;u++)for(let n=v.current[1];n<v.current[1]+r.length;n++)e[u]&&c[u-v.current[0]][n-v.current[1]]>0&&s(e[u]&&e[u][n])&&(t=!1);if(t){for(;v.current[0]<0;)y();for(let t=v.current[0];t<v.current[0]+r.length;t++)for(let n=v.current[1];n<v.current[1]+r.length;n++){if(!e[t])continue;const r=c[t-v.current[0]][n-v.current[1]];r>0&&0===e[t][n]?e[t][n]=f.current.numCode:0===r&&e[t][n]&&e[t][n]<10&&(e[t][n]=0)}f.current.currentShapeIndex=n}return e}))}};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),g.current=setInterval((()=>y()),300),()=>{clearInterval(g.current),window.removeEventListener("keydown",e),window.removeEventListener("keyup",t)}}),[]),(0,c.useEffect)((()=>{m.current&&(m.current=!1,i.current||(i.current=l[Math.floor(Math.random()*l.length)]),f.current?(f.current=i.current,i.current=l[Math.floor(Math.random()*l.length)]):f.current=l[Math.floor(Math.random()*l.length)],v.current=[-1,3],f.current.shape[0].slice(1).forEach(((r,t)=>{r.forEach(((r,n)=>{r&&e[t][n+3]&&(clearInterval(g.current),alert("게임오버"))}))})),r((e=>{var r;const t=(0,n.A)(e.map((e=>(0,n.A)(e))));return null!=f&&null!==(r=f.current)&&void 0!==r&&r.shape&&f.current.shape[0].slice(1).forEach(((e,r)=>{e.forEach(((e,n)=>{t[r][n+3]=e?f.current.numCode:0}))})),t})))}),[m.current]),c.createElement(c.Fragment,null,c.createElement(u,null,c.createElement("tbody",null,e.map(((r,t)=>c.createElement("tr",{key:`${r}-${t}`},r.map(((r,n)=>c.createElement("td",{style:{backgroundColor:e[t][n]>=10?o[e[t][n]/10-1]:o[e[t][n]-1]},key:`${r}-${n}`},r)))))))),c.createElement(u,null,c.createElement("tbody",null,t.map(((e,r)=>c.createElement("tr",{key:`${e}-${r}`},e.map(((e,n)=>c.createElement("td",{style:{backgroundColor:o[t[r][n]-1]},key:`${e}-${n}`},e)))))))),c.createElement("div",null,d))}}}]);
//# sourceMappingURL=component---src-pages-tetris-tsx-23ffaf25845a453e3fde.js.map