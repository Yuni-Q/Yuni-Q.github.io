(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{O3T9:function(e,t,a){"use strict";a.r(t),a.d(t,"CODE",(function(){return l})),a.d(t,"TableContext",(function(){return u})),a.d(t,"START_GAME",(function(){return E})),a.d(t,"OPEN_CELL",(function(){return s})),a.d(t,"CLICK_MINE",(function(){return d})),a.d(t,"FLAG_CELL",(function(){return b})),a.d(t,"QUESTION_CELL",(function(){return O})),a.d(t,"NORMALIZE_CELL",(function(){return I})),a.d(t,"INCREMENT_TIMER",(function(){return N}));var n=a("KQm4"),r=a("q1tI"),c=a.n(r),l={MINE:-7,NORMAL:-1,QUESTION:-2,FLAG:-3,QUESTION_MINE:-4,FLAG_MINE:-5,CLICKED_MINE:-6,OPENED:0},u=Object(r.createContext)({tableData:[],halted:!0,dispatch:null}),o={tableData:[],data:{row:0,cell:0,mine:0},timer:0,result:"",halted:!0,openedCount:0},i=function(e,t,a){for(var n=Array(e*t).fill(0).map((function(e,t){return t})),r=[];n.length>e*t-a;){var c=n.splice(Math.floor(Math.random()*n.length),1)[0];r.push(c)}for(var u=[],o=0;o<e;o++){var i=[];u.push(i);for(var E=0;E<t;E++)i.push(l.NORMAL)}for(var s=0;s<r.length;s++){var d=Math.floor(r[s]/t),b=r[s]%t;u[d][b]=l.MINE}return u},E="START_GAME",s="OPEN_CELL",d="CLICK_MINE",b="FLAG_CELL",O="QUESTION_CELL",I="NORMALIZE_CELL",N="INCREMENT_TIMER",f=function(e,t){switch(t.type){case E:return Object.assign({},e,{data:{row:t.row,cell:t.cell,mine:t.mine},openedCount:0,tableData:i(t.row,t.cell,t.mine),halted:!1,timer:0});case s:var a=Object(n.a)(e.tableData);a.forEach((function(e,t){a[t]=Object(n.a)(e)}));var r=[],c=0;!function e(t,n){if(!(t<0||t>=a.length||n<0||n>=a[0].length||[l.OPENED,l.FLAG,l.FLAG_MINE,l.QUESTION_MINE,l.QUESTION].includes(a[t][n])||r.includes(t+"/"+n))){r.push(t+"/"+n);var u=[a[t][n-1],a[t][n+1]];a[t-1]&&(u=u.concat([a[t-1][n-1],a[t-1][n],a[t-1][n+1]])),a[t+1]&&(u=u.concat([a[t+1][n-1],a[t+1][n],a[t+1][n+1]]));var o=u.filter((function(e){return[l.MINE,l.FLAG_MINE,l.QUESTION_MINE].includes(e)})).length;if(0===o&&t>-1){var i=[];t-1>-1&&(i.push([t-1,n-1]),i.push([t-1,n]),i.push([t-1,n+1])),i.push([t,n-1]),i.push([t,n+1]),t+1<a.length&&(i.push([t+1,n-1]),i.push([t+1,n]),i.push([t+1,n+1])),i.forEach((function(t){a[t[0]][t[1]]!==l.OPENED&&e(t[0],t[1])}))}a[t][n]===l.NORMAL&&(c+=1),a[t][n]=o}}(t.row,t.cell);var u=!1,o="";return e.data.row*e.data.cell-e.data.mine===e.openedCount+c&&(u=!0,o=e.timer+"초만에 승리하셨습니다"),Object.assign({},e,{tableData:a,openedCount:e.openedCount+c,halted:u,result:o});case d:var f=Object(n.a)(e.tableData);return f[t.row]=Object(n.a)(e.tableData[t.row]),f[t.row][t.cell]=l.CLICKED_MINE,Object.assign({},e,{tableData:f,halted:!0});case b:var h=Object(n.a)(e.tableData);return h[t.row]=Object(n.a)(e.tableData[t.row]),h[t.row][t.cell]===l.MINE?h[t.row][t.cell]=l.FLAG_MINE:h[t.row][t.cell]=l.FLAG,Object.assign({},e,{tableData:h});case O:var M=Object(n.a)(e.tableData);return M[t.row]=Object(n.a)(e.tableData[t.row]),M[t.row][t.cell]===l.FLAG_MINE?M[t.row][t.cell]=l.QUESTION_MINE:M[t.row][t.cell]=l.QUESTION,Object.assign({},e,{tableData:M});case I:var w=Object(n.a)(e.tableData);return w[t.row]=Object(n.a)(e.tableData[t.row]),w[t.row][t.cell]===l.QUESTION_MINE?w[t.row][t.cell]=l.MINE:w[t.row][t.cell]=l.NORMAL,Object.assign({},e,{tableData:w});case N:return Object.assign({},e,{timer:e.timer+1});default:return e}};t.default=function(){var e=Object(r.useReducer)(f,o),t=e[0],a=e[1],n=t.tableData,l=t.halted,i=t.timer,E=t.result,s=Object(r.useMemo)((function(){return{tableData:n,halted:l,dispatch:a}}),[n,l]);return Object(r.useEffect)((function(){var e;return!1===l&&(e=setInterval((function(){a({type:N})}),1e3)),function(){clearInterval(e)}}),[l]),c.a.createElement(u.Provider,{value:s},c.a.createElement(h,null),c.a.createElement("div",null,i),c.a.createElement(M,null),c.a.createElement("div",null,E))};var h=Object(r.memo)((function(){var e=Object(r.useState)(10),t=e[0],a=e[1],n=Object(r.useState)(10),l=n[0],o=n[1],i=Object(r.useState)(20),s=i[0],d=i[1],b=Object(r.useContext)(u).dispatch,O=Object(r.useCallback)((function(e){a(e.target.value)}),[]),I=Object(r.useCallback)((function(e){o(e.target.value)}),[]),N=Object(r.useCallback)((function(e){d(e.target.value)}),[]),f=Object(r.useCallback)((function(){b({type:E,row:t,cell:l,mine:s})}),[t,l,s]);return c.a.createElement("div",null,c.a.createElement("input",{type:"number",placeholder:"세로",value:t,onChange:O}),c.a.createElement("input",{type:"number",placeholder:"가로",value:l,onChange:I}),c.a.createElement("input",{type:"number",placeholder:"지뢰",value:s,onChange:N}),c.a.createElement("button",{onClick:f},"시작"))})),M=Object(r.memo)((function(){var e=Object(r.useContext)(u).tableData;return c.a.createElement("table",{style:{width:"unset"}},c.a.createElement("tbody",null,Array(e.length).fill(0).map((function(e,t){return c.a.createElement(w,{key:"tr-"+t,rowIndex:t})}))))})),w=Object(r.memo)((function(e){var t,a=e.rowIndex,n=Object(r.useContext)(u).tableData;if(null!==(t=n[0])&&void 0!==t&&t.length)return c.a.createElement("tr",null,Array(n[0].length).fill(0).map((function(e,t){return c.a.createElement(L,{key:"td-"+t,rowIndex:a,cellIndex:t})})))})),C=function(e){switch(e){case l.NORMAL:case l.MINE:return{background:"#444"};case l.CLICKED_MINE:return{background:"red"};case l.OPENED:return{background:"white"};case l.QUESTION_MINE:case l.QUESTION:return{background:"yellow"};case l.FLAG_MINE:case l.FLAG:return{background:"red"};default:return{background:"white"}}},L=Object(r.memo)((function(e){var t=e.rowIndex,a=e.cellIndex,n=Object(r.useContext)(u),o=n.tableData,i=n.dispatch,E=n.halted,N=Object(r.useCallback)((function(){if(!E)switch(o[t][a]){case l.OPENED:case l.FLAG_MINE:case l.FLAG:case l.QUESTION_MINE:case l.QUESTION:return;case l.NORMAL:return void i({type:s,row:t,cell:a});case l.MINE:return void i({type:d,row:t,cell:a});default:return}}),[o[t][a],E]),f=Object(r.useCallback)((function(e){if(e.preventDefault(),!E)switch(o[t][a]){case l.NORMAL:case l.MINE:return void i({type:b,row:t,cell:a});case l.FLAG_MINE:case l.FLAG:return void i({type:O,row:t,cell:a});case l.QUESTION_MINE:case l.QUESTION:return void i({type:I,row:t,cell:a});default:return}}),[o[t][a],E]);return c.a.createElement(p,{onClickTd:N,onRightClickTd:f,data:o[t][a]})})),p=Object(r.memo)((function(e){var t=e.onClickTd,a=e.onRightClickTd,n=e.data;return c.a.createElement("td",{style:Object.assign({},C(n),{width:60,height:60,padding:0,textAlign:"center"}),onClick:t,onContextMenu:a},function(e){switch(e){case l.NORMAL:return"";case l.MINE:return"X";case l.CLICKED_MINE:return"펑";case l.FLAG_MINE:case l.FLAG:return"!";case l.QUESTION_MINE:case l.QUESTION:return"?";default:return e||""}}(n))}))}}]);
//# sourceMappingURL=component---src-pages-mine-search-tsx-786c3da664f95f251340.js.map